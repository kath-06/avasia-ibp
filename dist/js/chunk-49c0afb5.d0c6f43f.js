(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49c0afb5"],{"007b":function(e,t,a){"use strict";a("07a3")},"04c8":function(e,t,a){"use strict";a("e016")},"07a3":function(e,t,a){},"0dbd":function(e,t,a){"use strict";a("de02")},"0f39":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pt-4",attrs:{id:"textStyle"}},[a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-4"}),a("span",{staticClass:"col-sm-2 pb-3 pl-4 text-right"},[a("b",[e._v("Filter by:")])]),a("span",{staticClass:"col-sm-2 pb-2 text-right"},[a("v-select",{staticStyle:{width:"150px"},attrs:{id:"inputStyle",options:e.filters,reduce:function(e){return e.filterId},label:"filter",clearable:!1,readonly:""},on:{input:function(t){return e.getItems(e.listType,e.stat)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),"month"==e.filter?a("span",{staticClass:"col-sm-2 pl-0"},[a("base-input",{staticClass:"pb-2",staticStyle:{width:"200px"},attrs:{type:"month",max:e.maxDate,min:"1997-01",id:"inputStyle"},on:{input:function(t){return e.getItems(e.listType,e.stat)}},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}})],1):e._e(),"dateRange"==e.filter?a("span",{staticClass:"col-sm-2 pl-0"},[a("base-input",{staticClass:"pb-2",staticStyle:{width:"150px"},attrs:{type:"date",max:e.maxDateRange,min:"1997-01-01",id:"inputStyle"},on:{input:function(t){return e.getItems(e.listType,e.stat)}},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1):e._e(),"dateRange"==e.filter?a("span",{staticClass:"col-sm-2 pl-0"},[a("base-input",{staticClass:"pb-2",staticStyle:{width:"150px"},attrs:{type:"date",max:e.maxDateRange,min:"1997-01-01",id:"inputStyle"},on:{input:function(t){return e.getItems(e.listType,e.stat)}},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1):e._e()]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{attrs:{columns:e.columns,rows:e.purchases,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["purchaseDate"==t.column.field?a("span",[a("span",[e._v(e._s(e._f("moment")(t.row.purchaseDate,"MMM DD, YYYY")))])]):e._e(),"siNumber"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.siNumber))])]):e._e(),"tinNumber"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.tinNumber))])]):e._e(),"company"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.company))])]):e._e(),"enterprise"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.enterprise))])]):e._e(),"salesAmount"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v("â‚± "+e._s(t.row.salesAmount))])]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.purchases.length?a("div",{staticClass:"row pl-4 mt-2 mb-2"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getItems()}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[0!=e.purchases.length?a("base-button",{staticClass:"col-md-3 ml-2 mr-2",attrs:{id:"darkBtn"},on:{click:e.exportItem}},[e._v("Export")]):e._e(),0!=e.purchases.length?a("base-button",{staticClass:"col-md-3 ml-2 mr-2",attrs:{id:"darkBtn"},on:{click:e.printItem}},[e._v("Print")]):e._e()],1)])],1)],1)},r=[],n=(a("4de4"),a("4160"),a("b680"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("add5"),l=a.n(o),c=a("68a2"),d=a("c1df"),u=a("e966"),m=u.bindWith(",","."),p={components:{},data:function(){return{columns:[{label:"Purchase Date",field:"purchaseDate"},{label:"SI Number",field:"siNumber"},{label:"Tin Number",field:"tinNumber"},{label:"Company",field:"company"},{label:"Enterprise",field:"enterprise"}],loading:!1,purchases:[],requestProcessing:!1,views:[{limitId:"20",limit:"20 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"20",filters:[{filterId:"month",filter:"Month"},{filterId:"dateRange",filter:"Date Range"}],filter:"month",dateCreated:d().format("YYYY-MM"),startDate:d().subtract(6,"days").format("YYYY-MM-DD"),endDate:d().format("YYYY-MM-DD"),maxDate:d().format("YYYY-MM"),maxDateRange:d().format("YYYY-MM-DD")}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=i["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=i["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Manager"!=s[0].userRole&&"Administrator"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getItems();case 1:case"end":return t.stop()}}),t)})))()},methods:{getItems:function(){var e=this,t=null,a=[],s=null,r=[],n="",o="";e.loading=!0,e.purchases=[],"month"==e.filter?(n=d(e.dateCreated).startOf("month").format("YYYY-MM-DD"),o=d(e.dateCreated).endOf("month").format("YYYY-MM-DD")):"dateRange"==e.filter&&(n=d(e.startDate).format("YYYY-MM-DD"),o=d(e.endDate).format("YYYY-MM-DD")),"all"!=e.limit?t=i["dbExpense"].collection("purchases").where("purchaseDate",">=",n).where("purchaseDate","<=",o).limit(e.limit).orderBy("purchaseDate","asc"):"all"==e.limit&&(t=i["dbExpense"].collection("purchases").where("purchaseDate",">=",n).where("purchaseDate","<=",o).orderBy("purchaseDate","asc")),t.get().then((function(t){t.empty||(t.forEach((function(e){a.push(e.data())})),s=i["dbExpense"].collection("enterprises").orderBy("enterprise","asc"),s.get().then((function(t){t.forEach((function(e){r.push(e.data())}));for(var s=0;s<a.length;s++){a[s]["enterprise"]="";for(var n=0;n<r.length;n++)r[n].enterpriseId==a[s].enterpriseReference&&(a[s].enterprise=r[n].enterprise);a[s].salesAmount=m(parseFloat(a[s].salesAmount).toFixed(2)),e.purchases.push(a[s])}}))),setTimeout((function(){e.loading=!1}),1e3)}))},printItem:function(){var e=this,t=null,a=[],s=null,r=[],n="",o="",c=[],u=[],p="",b="";"month"==e.filter?(n=d(e.dateCreated).startOf("month").format("YYYY-MM-DD"),o=d(e.dateCreated).endOf("month").format("YYYY-MM-DD"),b=d(n).format("MMMM YYYY")):"dateRange"==e.filter&&(n=d(e.startDate).format("YYYY-MM-DD"),o=d(e.endDate).format("YYYY-MM-DD"),b=d(n).format("MMMM DD, YYYY")+" to "+d(o).format("MMMM DD, YYYY")),s=i["dbExpense"].collection("enterprises").orderBy("enterprise","asc"),t=i["dbExpense"].collection("purchases").where("purchaseDate",">=",n).where("purchaseDate","<=",o).orderBy("purchaseDate","asc"),t.get().then((function(e){e.empty||(e.forEach((function(e){a.push(e.data())})),s.get().then((function(e){e.forEach((function(e){r.push(e.data())}));for(var t=0;t<a.length;t++){a[t]["enterprise"]="";for(var s=0;s<r.length;s++)a[t].enterpriseReference==r[s].enterpriseId&&(a[t].enterprise=r[s].enterprise);a[t].purchaseDate=d(a[t].purchaseDate).format("MMM DD, YYYY"),a[t].salesAmount=m(parseFloat(a[t].salesAmount).toFixed(2)),c.push(a[t])}u=[{field:"purchaseDate",displayName:"Purchase Date"},{field:"siNumber",displayName:"SI Number"},{field:"tinNumber",displayName:"Tin No."},{field:"company",displayName:"Company"},{field:"enterprise",displayName:"Enterprise"},{field:"salesAmount",displayName:"Sales Amount"}],p="Purchases",l()({printable:c,properties:u,type:"json",header:"<h2>"+p+"</h2><br><h4>DATE: "+b+"<h4>",style:'td { text-align: center; } body { font-family: "Calibri"; }',documentTitle:p+" "+d().format("MMMM YYYY")})})))}))},exportItem:function(){var e=new c["b"],t=this,a=null,s=[],r=null,n=[],o=[],l="",u="",m=[],p=[],b="",f=[],v=[];"month"==t.filter?(l=d(t.dateCreated).startOf("month").format("YYYY-MM-DD"),u=d(t.dateCreated).endOf("month").format("YYYY-MM-DD"),b=d(l).format("MMMM YYYY")):"dateRange"==t.filter&&(l=d(t.startDate).format("YYYY-MM-DD"),u=d(t.endDate).format("YYYY-MM-DD"),b=d(l).format("MMMM DD, YYYY")+" to "+d(u).format("MMMM DD, YYYY")),r=i["dbExpense"].collection("enterprises").orderBy("enterprise","asc"),a=i["dbExpense"].collection("purchases").where("purchaseDate",">=",l).where("purchaseDate","<=",u).orderBy("purchaseDate","asc"),a.get().then((function(t){t.empty||(t.forEach((function(e){s.push(e.data())})),r.get().then((function(t){t.forEach((function(e){n.push(e.data())}));for(var a=function(t){var a=t+1;s[t]["enterprise"]="";for(var r=0;r<n.length;r++)s[t].enterpriseReference==n[r].enterpriseId&&(s[t].enterprise=n[r].enterprise);m.push(s[t]);var l=i["dbExpense"].collection("purchaseItems").where("purchaseReference","==",s[t].purchaseId);l.get().then((function(r){r.forEach((function(e){o.push(e.data())}));for(var n=0;n<o.length;n++)o[n].purchaseReference==s[t].purchaseId&&(o[n]["siNumber"]=s[t].siNumber,f.push(o[n]));if(a==s.length){p=[{name:"Number",key:"num",width:10},{key:"purchaseDate",name:"Purchase Date",width:28,style:{alignment:c["a"].middleCenter}},{key:"siNumber",name:"SI Number",width:18,style:{alignment:c["a"].middleCenter}},{key:"tinNumber",name:"Tin Number",width:28,style:{alignment:c["a"].middleCenter}},{key:"company",name:"Company",width:38,style:{alignment:c["a"].middleCenter}},{key:"address",name:"Address",width:48,style:{alignment:c["a"].middleCenter}},{key:"enterprise",name:"Enterprise",width:38,style:{alignment:c["a"].middleCenter}},{key:"salesAmount",name:"Total Amount",width:28,style:{alignment:c["a"].middleCenter}}],v=[{name:"Number",key:"num",width:10},{key:"siNumber",name:"SI Number",width:18,style:{alignment:c["a"].middleCenter}},{key:"item",name:"Item",width:48,style:{alignment:c["a"].middleCenter}},{key:"quantity",name:"Quantity",width:18,style:{alignment:c["a"].middleCenter}},{key:"price",name:"Price",width:38,style:{alignment:c["a"].middleCenter}},{key:"amount",name:"Amount",width:28,style:{alignment:c["a"].middleCenter}}];for(var i={fileName:"Purchases ("+d().format("MMM DD, YYYY")+")",workSheets:[{sheetName:"Purchases",startingRowNumber:2,gapBetweenTwoTables:2,tableSettings:{dataA:{importable:!0,tableTitle:"Purchases: ("+b+")",headerDefinition:p}}},{sheetName:"Purchase Items",startingRowNumber:2,gapBetweenTwoTables:2,tableSettings:{dataB:{importable:!0,tableTitle:"Purchase Items: ("+b+")",headerDefinition:v}}}]},l=[],u=0;u<m.length;u++)m[u]["num"]=u+1;for(var h=0;h<f.length;h++)f[h]["num"]=h+1;l.push({dataA:m},{dataB:f}),e.downloadExcel(i,l)}}))},r=0;r<s.length;r++)a(r)})))}))}}},b=p,f=(a("32c3"),a("2877")),v=Object(f["a"])(b,s,r,!1,null,null,null);t["default"]=v.exports},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"14c3":function(e,t,a){var s=a("c6b6"),r=a("9263");e.exports=function(e,t){var a=e.exec;if("function"===typeof a){var n=a.call(e,t);if("object"!==typeof n)throw TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==s(e))throw TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},"158b":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pt-4",attrs:{id:"textStyle"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left ml-1 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-2 pointer"},[1==e.productStat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getProducts(1)}}},[e._v("Enabled")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},[0==e.productStat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getProducts(0)}}},[e._v("Disabled")])])],1)]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{ref:"product-table",attrs:{columns:e.columns,rows:e.products,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["productName"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.productName))])]):e._e(),"price"==t.column.field?a("span",[a("span",[e._v("â‚± "+e._s(t.row.price))])]):e._e(),"category"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.category))])]):e._e(),"distributor"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.distributor))])]):e._e(),"unit"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.unit))])]):e._e(),"action"==t.column.field?a("span",[1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Edit"},on:{click:function(a){return e.openEditProductModal(t.row)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-times-circle",attrs:{id:"sideBarTxt",title:"Disable"},on:{click:function(a){return e.changeStatus(t.row.id,0,"Disable")}}}):e._e(),0==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-check-circle",attrs:{id:"sideBarTxt",title:"Enable"},on:{click:function(a){return e.changeStatus(t.row.id,1,"Enable")}}}):e._e()]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.products.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getProducts(e.productStat)}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-product-modal",modifiers:{"new-product-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Product")])],1)]),a("b-modal",{attrs:{size:"lg",id:"new-product-modal",title:"New Product",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addProduct(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-product-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Product:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Price:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Product"},model:{value:e.newProduct,callback:function(t){e.newProduct=t},expression:"newProduct"}}),e.$v.newProduct.$anyDirty&&!e.$v.newProduct.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newProduct.$anyDirty&&!e.$v.newProduct.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Price"},model:{value:e.newPrice,callback:function(t){e.newPrice=t},expression:"newPrice"}}),e.$v.newPrice.$anyDirty&&!e.$v.newPrice.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newPrice.$anyDirty&&!e.$v.newPrice.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Category:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Distributor:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-4 pl-5 "},[a("v-select",{attrs:{id:"inputStyle",options:e.categories,reduce:function(e){return e.productCategoryId},label:"category",clearable:!1},model:{value:e.newCategory,callback:function(t){e.newCategory=t},expression:"newCategory"}}),e.$v.newCategory.$anyDirty&&!e.$v.newCategory.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-2 pr-5"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.show("new-product-category-modal")}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")])],1),a("div",{staticClass:"col-sm-4 pl-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.distributors,reduce:function(e){return e.distributorId},label:"distributorName",clearable:!1},model:{value:e.newDistributor,callback:function(t){e.newDistributor=t},expression:"newDistributor"}}),e.$v.newDistributor.$anyDirty&&!e.$v.newDistributor.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-2 pr-5"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.show("new-distributor-modal")}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")])],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Unit:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Unit"},model:{value:e.newUnit,callback:function(t){e.newUnit=t},expression:"newUnit"}})],1)])]),a("b-modal",{attrs:{size:"md",id:"new-product-category-modal",title:"New Product Category",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addProductCategory(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-product-category-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Category:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Product Category"},model:{value:e.newProductCategory,callback:function(t){e.newProductCategory=t},expression:"newProductCategory"}}),e.$v.newProductCategory.$anyDirty&&!e.$v.newProductCategory.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newProductCategory.$anyDirty&&!e.$v.newProductCategory.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"new-distributor-modal",title:"New Distributor",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addDistributor(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-distributor-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Distributor:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Address:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Distributor"},model:{value:e.newDistributorName,callback:function(t){e.newDistributorName=t},expression:"newDistributorName"}}),e.$v.newDistributorName.$anyDirty&&!e.$v.newDistributorName.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newDistributorName.$anyDirty&&!e.$v.newDistributorName.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newAddress,expression:"newAddress"}],staticClass:"pl-2",attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"Address"},domProps:{value:e.newAddress},on:{input:function(t){t.target.composing||(e.newAddress=t.target.value)}}}),e.$v.newAddress.$anyDirty&&!e.$v.newAddress.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Tin Number:")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Contact Number:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Tin Number"},model:{value:e.newTinNumber,callback:function(t){e.newTinNumber=t},expression:"newTinNumber"}}),e.$v.newTinNumber.$anyDirty&&!e.$v.newTinNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Contact Number"},model:{value:e.newContactNumber,callback:function(t){e.newContactNumber=t},expression:"newContactNumber"}}),e.$v.newContactNumber.$anyDirty&&!e.$v.newContactNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Contact Person:")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Email Address:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Contact Person"},model:{value:e.newContactPerson,callback:function(t){e.newContactPerson=t},expression:"newContactPerson"}}),e.$v.newContactPerson.$anyDirty&&!e.$v.newContactPerson.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Email Address"},model:{value:e.newEmailAddress,callback:function(t){e.newEmailAddress=t},expression:"newEmailAddress"}}),e.$v.newEmailAddress.$anyDirty&&!e.$v.newEmailAddress.email?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"edit-product-modal",title:"Edit Product",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateProduct(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-product-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Product:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Price:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Product"},model:{value:e.edit.product,callback:function(t){e.$set(e.edit,"product",t)},expression:"edit.product"}}),e.$v.edit.product.$anyDirty&&!e.$v.edit.product.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.product.$anyDirty&&!e.$v.edit.product.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Price"},model:{value:e.edit.price,callback:function(t){e.$set(e.edit,"price",t)},expression:"edit.price"}}),e.$v.edit.price.$anyDirty&&!e.$v.edit.price.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.price.$anyDirty&&!e.$v.edit.price.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Category:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Distributor:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.categories,reduce:function(e){return e.productCategoryId},label:"category",clearable:!1},model:{value:e.edit.categoryReference,callback:function(t){e.$set(e.edit,"categoryReference",t)},expression:"edit.categoryReference"}}),e.$v.edit.categoryReference.$anyDirty&&!e.$v.edit.categoryReference.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.distributors,reduce:function(e){return e.distributorId},label:"distributorName",clearable:!1},model:{value:e.edit.distributorReference,callback:function(t){e.$set(e.edit,"distributorReference",t)},expression:"edit.distributorReference"}}),e.$v.edit.distributorReference.$anyDirty&&!e.$v.edit.distributorReference.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Unit:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Unit"},model:{value:e.edit.unit,callback:function(t){e.$set(e.edit,"unit",t)},expression:"edit.unit"}})],1)])])],1)],1)},r=[],n=(a("4160"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),o=a("56d7"),l=a("b5ae"),c=a("2f62"),d=a("c6f8"),u=l["helpers"].regex("alphaNumAndDot",/^[ A-Za-z0-9 -./&, ]*$/),m=l["helpers"].regex("alphaNumAndDot",/^[ 0-9., ]*$/),p=l["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),b=l["helpers"].regex("alphaNumAndDot",/^[ A-Za-z -. ]*$/),f=new Date,v={components:{},data:function(){return{columns:[{label:"Product",field:"productName"},{label:"Price",field:"price"},{label:"Category",field:"category"},{label:"Distributor",field:"distributor"},{label:"Unit",field:"unit"},{label:"",field:"action",sortable:!1,width:"100px"}],loading:!0,views:[{limitId:"20",limit:"20 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"20",requestProcessing:!1,newProduct:"",newPrice:"",newCategory:"",newDistributor:"",newUnit:"",newProductCategory:"",newDistributorName:"",newAddress:"",newTinNumber:"",newContactNumber:"",newContactPerson:"",newEmailAddress:"",edit:{id:"",productId:"",product:"",price:"",categoryReference:"",distributorReference:"",unit:""},productStat:1}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=o["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=o["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Manager"!=s[0].userRole&&"Administrator"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getCategories(),e.getDistributors(),e.getProducts(e.productStat);case 3:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(c["b"])({valid:"Products/valid",error:"Products/error",categories:"Products/category",distriValid:"Sales/valid",distriError:"Sales/error",distributors:"Sales/distributor",products:"Products/products"})),validations:{newProduct:{required:l["required"],alphaNumCustomValidator:u},newPrice:{required:l["required"],amountCustomValidator:m},newCategory:{required:l["required"]},newDistributor:{required:l["required"]},newProductCategory:{required:l["required"],alphaNumCustomValidator:u},newDistributorName:{required:l["required"],alphaNumCustomValidator:u},newAddress:{required:l["required"]},newTinNumber:{numCustomValidator:p},newContactNumber:{numCustomValidator:p},newContactPerson:{alphaCustomValidator:b},newEmailAddress:{email:l["email"]},edit:{product:{required:l["required"],alphaNumCustomValidator:u},price:{required:l["required"],amountCustomValidator:m},categoryReference:{required:l["required"]},distributorReference:{required:l["required"]}}},methods:{getCategories:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,a.$store.dispatch("Products/getCategory");case 2:case"end":return t.stop()}}),t)})))()},getDistributors:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,a.$store.dispatch("Sales/getDistributor");case 2:case"end":return t.stop()}}),t)})))()},addProductCategory:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,a.$v.newProductCategory.$touch(),a.$v.newProductCategory.$error||(a.requestProcessing=!0,s={productCategoryId:"",category:Object(d["a"])(a.newProductCategory),userReference:"",status:1,dateCreated:f,dateModified:f},a.$store.dispatch("Products/checkCategory",{newCategory:a.newProductCategory}).then((function(){setTimeout((function(){1==a.valid?a.validationMessage("Product category"):0==a.valid&&a.$store.dispatch("Products/newCategory",s).then((function(){setTimeout((function(){0==a.error?(a.newProductCategory="",a.requestProcessing=!1,a.$v.newProductCategory.$reset(),a.getCategories(),a.$bvModal.hide("new-product-category-modal"),a.$swal({title:"Success",text:"New product category added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})):1==a.error&&a.errorMessage()}),500)}))}),500)})));case 3:case"end":return t.stop()}}),t)})))()},addDistributor:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,a.$v.newDistributorName.$touch(),a.$v.newAddress.$touch(),a.$v.newTinNumber.$touch(),a.$v.newContactNumber.$touch(),a.$v.newContactPerson.$touch(),a.$v.newEmailAddress.$touch(),a.$v.newDistributorName.$error||a.$v.newAddress.$error||a.$v.newTinNumber.$error||a.$v.newContactNumber.$error||a.$v.newContactPerson.$error||a.$v.newEmailAddress.$error||(a.requestProcessing=!0,s={distributorId:"",distributorName:Object(d["a"])(a.newDistributorName),address:a.newAddress,tin:a.newTinNumber,contactNumber:a.newContactNumber,contactPerson:a.newContactPerson,email:a.newEmailAddress,userReference:"",status:1,dateCreated:f,dateModified:f},a.$store.dispatch("Sales/checkDistributor",{validate:1,newDistributor:a.newDistributorName}).then((function(){setTimeout((function(){1==a.distriValid?a.validationMessage("Distributor"):0==a.distriValid&&a.$store.dispatch("Sales/checkDistributor",{validate:2,newTinNumber:a.newTinNumber}).then((function(){setTimeout((function(){1==a.distriValid?a.validationMessage("Tin"):0==a.distriValid&&a.$store.dispatch("Sales/checkDistributor",{validate:3,newContactNumber:a.newContactNumber}).then((function(){setTimeout((function(){1==a.distriValid?a.validationMessage("Contact number"):0==a.distriValid&&a.$store.dispatch("Sales/checkDistributor",{validate:4,newEmailAddress:a.newEmailAddress}).then((function(){setTimeout((function(){1==a.distriValid?a.validationMessage("Email address"):0==a.distriValid&&a.$store.dispatch("Sales/newDistributor",s).then((function(){setTimeout((function(){0==a.distriError?(a.newDistributorName="",a.newAddress="",a.newTinNumber="",a.newContactNumber="",a.newContactPerson="",a.newEmailAddress="",a.requestProcessing=!1,a.$v.newDistributorName.$reset(),a.$v.newAddress.$reset(),a.$v.newTinNumber.$reset(),a.$v.newContactNumber.$reset(),a.$v.newContactPerson.$reset(),a.$v.newEmailAddress.$reset(),a.getDistributors(),a.$bvModal.hide("new-distributor-modal"),a.$swal({title:"Success",text:"New distributor added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})):1==a.distriError&&a.errorMessage()}),500)}))}),500)}))}),500)}))}),500)}))}),500)})));case 8:case"end":return t.stop()}}),t)})))()},addProduct:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,a.$v.newProduct.$touch(),a.$v.newPrice.$touch(),a.$v.newCategory.$touch(),a.$v.newDistributor.$touch(),a.$v.newProduct.$error||a.$v.newPrice.$error||a.$v.newCategory.$error||a.$v.newDistributor.$error||(a.requestProcessing=!0,s={productId:"",productName:Object(d["a"])(a.newProduct),price:a.newPrice.replaceAll(",",""),categoryReference:a.newCategory,distributorReference:a.newDistributor,unit:a.newUnit,userReference:"",status:1,dateCreated:f,dateModified:f},a.$store.dispatch("Products/checkProduct",{newProduct:a.newProduct}).then((function(){setTimeout((function(){1==a.valid?a.validationMessage("Product"):0==a.valid&&a.$store.dispatch("Products/newProduct",s).then((function(){setTimeout((function(){0==a.error?(a.newProduct="",a.newPrice="",a.newCategory="",a.newDistributor="",a.newUnit="",a.requestProcessing=!1,a.$v.newProduct.$reset(),a.$v.newPrice.$reset(),a.$v.newCategory.$reset(),a.$v.newDistributor.$reset(),a.$refs["product-table"].reset(),a.getProducts(a.productStat),a.$bvModal.hide("new-product-modal"),a.$swal({title:"Success",text:"New product added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})):1==a.error&&a.errorMessage()}),500)}))}),500)})));case 6:case"end":return t.stop()}}),t)})))()},validationMessage:function(e){var t=this;t.$swal({title:"Invalid",text:e+" already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),t.requestProcessing=!1},errorMessage:function(){var e=this;e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})},getProducts:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:s=t,s.loading=!0,s.productStat=e,s.$store.dispatch("Products/getProducts",{limit:s.limit,stat:e}),setTimeout((function(){s.loading=!1}),1e3);case 5:case"end":return a.stop()}}),a)})))()},openEditProductModal:function(e){this.edit={id:e.id,productId:e.productId,product:e.productName,price:e.price,categoryReference:e.categoryReference,distributorReference:e.distributorReference,unit:e.unit},this.$bvModal.show("edit-product-modal")},updateProduct:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,a.$v.edit.$touch(),a.$v.edit.$error||(a.requestProcessing=!0,a.$store.dispatch("Products/checkEditProduct",{product:a.edit.product,productId:a.edit.productId}).then((function(){setTimeout((function(){1==a.valid?a.validationMessage("Product"):0==a.valid&&(a.requestProcessing=!1,a.edit.product=Object(d["a"])(a.edit.product),a.edit.price=a.edit.price.replaceAll(",",""),a.$store.dispatch("Products/editProduct",a.edit).then((function(){0==a.error?(a.$v.edit.$reset(),a.$refs["product-table"].reset(),a.getProducts(a.productStat),a.$bvModal.hide("edit-product-modal"),a.$swal({title:"Success",text:"Product updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})):1==a.error&&a.errorMessage()})))}),1e3)})));case 3:case"end":return t.stop()}}),t)})))()},changeStatus:function(e,t,a){var s=this;s.$swal({title:"Are you sure?",text:"You want to change the status to "+a,icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(r){r.value&&s.$store.dispatch("Products/productStatus",{id:e,stat:t}).then((function(){setTimeout((function(){0==s.error?s.$swal({title:"Success",text:"Product change status to "+a+".",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){s.$refs["product-table"].reset(),s.getProducts(t)})):1==s.error&&s.errorMessage()}),1e3)}))}))}}},h=v,C=(a("a28f"),a("2877")),w=Object(C["a"])(h,s,r,!1,null,null,null);t["default"]=w.exports},"2ca1":function(e,t,a){},"2dff":function(e,t,a){},"32c3":function(e,t,a){"use strict";a("a584")},3345:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"textStyle"}},[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[a("div",{staticClass:"form-group row pt-2 mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Firstname:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Middlename:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Firstname"},model:{value:e.firstname,callback:function(t){e.firstname=t},expression:"firstname"}}),e.$v.firstname.$anyDirty&&!e.$v.firstname.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.firstname.$anyDirty&&!e.$v.firstname.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Middlename"},model:{value:e.middlename,callback:function(t){e.middlename=t},expression:"middlename"}}),e.$v.middlename.$anyDirty&&!e.$v.middlename.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.middlename.$anyDirty&&!e.$v.middlename.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Lastname:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Email Address:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Lastname"},model:{value:e.lastname,callback:function(t){e.lastname=t},expression:"lastname"}}),e.$v.lastname.$anyDirty&&!e.$v.lastname.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.lastname.$anyDirty&&!e.$v.lastname.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Email Address"},model:{value:e.emailAddress,callback:function(t){e.emailAddress=t},expression:"emailAddress"}}),e.$v.emailAddress.$anyDirty&&!e.$v.emailAddress.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.emailAddress.$anyDirty&&!e.$v.emailAddress.email?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Contact Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Username:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Contact Number"},model:{value:e.contactNumber,callback:function(t){e.contactNumber=t},expression:"contactNumber"}}),e.$v.contactNumber.$anyDirty&&!e.$v.contactNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.contactNumber.$anyDirty&&!e.$v.contactNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e.$v.username.$anyDirty&&!e.$v.username.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Password:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("User Role:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"password",id:"inputStyle",placeholder:"Password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.userRoles,reduce:function(e){return e.userRoleId},label:"userRole"},model:{value:e.userRole,callback:function(t){e.userRole=t},expression:"userRole"}}),e.$v.userRole.$anyDirty&&!e.$v.userRole.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Department:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.departments,reduce:function(e){return e.departmentUid},label:"departmentName"},model:{value:e.department,callback:function(t){e.department=t},expression:"department"}}),e.$v.department.$anyDirty&&!e.$v.department.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("hr"),a("div",{staticClass:"text-center"},[a("base-button",{staticClass:"col-md-2 ml-2",attrs:{id:"darkBtn"},nativeOn:{click:function(t){return e.updateUser(t)}}},[e._v("Update")]),a("base-button",{staticClass:"col-md-2 ml-2",attrs:{id:"darkInlineBtn"},nativeOn:{click:function(t){return e.cancelUpdateUser(t)}}},[e._v("Close")])],1)])],1)],1)},r=[],n=(a("4160"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=o["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),c=o["helpers"].regex("alphaNumAndDot",/^[ A-Za-z ]*$/),d=new Date,u=a("323d"),m={components:{},data:function(){return{userRoles:[],departments:[],accountId:"",firstname:"",middlename:"",lastname:"",emailAddress:"",contactNumber:"",username:"",password:"",userRole:"",oldPassword:"",department:"",requestProcessing:!1}},validations:{firstname:{required:o["required"],alphaCustomValidator:c},middlename:{required:o["required"],alphaCustomValidator:c},lastname:{required:o["required"],alphaCustomValidator:c},emailAddress:{required:o["required"],email:o["email"]},contactNumber:{required:o["required"],numCustomValidator:l},username:{required:o["required"]},userRole:{required:o["required"]},department:{required:o["required"]}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=i["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=i["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"Administrator"!=s[0].userRole?a("/main/home"):a()}))}}))},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUser(e.$router.currentRoute.params.id),e.getUserRoles(),e.getDepartments();case 3:case"end":return t.stop()}}),t)})))()},methods:{getUserRoles:function(){var e=this,t=i["dbUsers"].collection("userRoles").orderBy("userRole","asc");e.userRoles=[],t.get().then((function(t){t.forEach((function(t){e.userRoles.push(t.data())}))}))},getUser:function(e){if(""==e)self.$swal({title:"Warning",text:"The user ID is missing.",icon:"warning",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){self.cancelUpdateUser()}));else if(""!=e){var t=this,a=i["dbUsers"].collection("users").where("userId","==",e),s=[];a.get().then((function(e){e.forEach((function(e){s.push(e.data()),t.accountId=e.id})),t.firstname=s[0].firstname,t.middlename=s[0].middlename,t.lastname=s[0].lastname,t.emailAddress=s[0].emailAddress,t.contactNumber=s[0].contactNumber,t.username=s[0].username,t.oldPassword=s[0].password,t.userRole=s[0].userRoleReference,t.department=s[0].departmentReference}))}},cancelUpdateUser:function(){this.$router.push("/users")},getDepartments:function(){var e=this,t=i["dbUsers"].collection("departments").orderBy("departmentName","asc");e.departments=[],t.get().then((function(t){t.forEach((function(t){e.departments.push(t.data())}))}))},updateUser:function(){var e=this,t=!0;if(e.requestProcessing=!1,e.$v.firstname.$touch(),e.$v.middlename.$touch(),e.$v.lastname.$touch(),e.$v.emailAddress.$touch(),e.$v.contactNumber.$touch(),e.$v.username.$touch(),e.$v.userRole.$touch(),e.$v.department.$touch(),e.$v.firstname.$error||e.$v.middlename.$error||e.$v.lastname.$error||e.$v.emailAddress.$error||e.$v.contactNumber.$error||e.$v.username.$error||e.$v.userRole.$error||e.$v.department.$error||(t=!1),!t){var a=[];e.requestProcessing=!0,a=""==!e.password?{userUid:e.$router.currentRoute.params.id,firstname:e.firstname,middlename:e.middlename,lastname:e.lastname,emailAddress:e.emailAddress,contactNumber:e.contactNumber,username:e.username,password:u.generate(e.password),userRole:e.userRole,department:e.department}:{userUid:e.$router.currentRoute.params.id,firstname:e.firstname,middlename:e.middlename,lastname:e.lastname,emailAddress:e.emailAddress,contactNumber:e.contactNumber,username:e.username,password:e.oldPassword,userRole:e.userRole,department:e.department};var s=i["dbUsers"].collection("users").where("username","==",a.username).where("userId","!=",e.$router.currentRoute.params.id),r=i["dbUsers"].collection("users").where("firstname","==",a.firstname).where("middlename","==",a.middlename).where("lastname","==",a.lastname).where("userId","!=",e.$router.currentRoute.params.id),n=i["dbUsers"].collection("users").where("emailAddress","==",a.emailAddress).where("userId","!=",e.$router.currentRoute.params.id),o=i["dbUsers"].collection("users").where("contactNumber","==",a.contactNumber).where("userId","!=",e.$router.currentRoute.params.id);s.get().then((function(t){t.empty?r.get().then((function(t){t.empty?n.get().then((function(t){t.empty?o.get().then((function(t){if(t.empty)try{i["dbUsers"].collection("users").doc(e.accountId).update({firstname:a.firstname,middlename:a.middlename,lastname:a.lastname,emailAddress:a.emailAddress,contactNumber:a.contactNumber,username:a.username,password:a.password,userRoleReference:a.userRole,departmentReference:a.department,dateModified:d}).then((function(){e.$swal({title:"Success",text:"User updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.$router.push("/users")}))}))}catch(s){console.log(s),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Contact number already used",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))})):t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Email address already used",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))})):t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Name already exists",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))})):t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Username already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}}}},p=m,b=(a("04c8"),a("2877")),f=Object(b["a"])(p,s,r,!1,null,null,null);t["default"]=f.exports},"38e7":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pt-4",attrs:{id:"textStyle"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left ml-1 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-2 pointer"},["Paid"==e.stat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getBillings("Paid")}}},[e._v("Paid")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},["Unpaid"==e.stat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getBillings("Unpaid")}}},[e._v("Unpaid")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},["All"==e.stat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getBillings("All")}}},[e._v("All")])])],1)]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-4 pb-3 pl-4 text-right"}),a("span",{staticClass:"col-sm-2 pb-3 pl-4 text-right"},[a("b",[e._v("Filter by:")])]),a("span",{staticClass:"col-sm-2 pb-2 text-right"},[a("v-select",{staticStyle:{width:"150px"},attrs:{id:"inputStyle",options:e.filters,reduce:function(e){return e.filterId},label:"filter",clearable:!1,readonly:""},on:{input:function(t){return e.getBillings(e.stat)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),"month"==e.filter?a("span",{staticClass:"col-sm-2 pl-0"},[a("base-input",{staticClass:"pb-2",staticStyle:{width:"200px"},attrs:{type:"month",max:e.maxDate,min:"1997-01",id:"inputStyle"},on:{input:function(t){return e.getBillings(e.stat)}},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}})],1):e._e(),"dateRange"==e.filter?a("span",{staticClass:"col-sm-2 pl-0"},[a("base-input",{staticClass:"pb-2",staticStyle:{width:"150px"},attrs:{type:"date",max:e.maxDateRange,min:"1997-01-01",id:"inputStyle"},on:{input:function(t){return e.getBillings(e.stat)}},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1):e._e(),"dateRange"==e.filter?a("span",{staticClass:"col-sm-2 pl-0"},[a("base-input",{staticClass:"pb-2",staticStyle:{width:"150px"},attrs:{type:"date",max:e.maxDateRange,min:"1997-01-01",id:"inputStyle"},on:{input:function(t){return e.getBillings(e.stat)}},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1):e._e()]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{attrs:{columns:e.columns,rows:e.billings,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["billing"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.billing))])]):e._e(),"amount"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v("â‚± "+e._s(t.row.amount))])]):e._e(),"dueDate"==t.column.field?a("span",[a("span",[e._v(e._s(e._f("moment")(t.row.dueDate,"MMM DD, YYYY")))])]):e._e(),"billingType"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.billingType))])]):e._e(),"status"==t.column.field?a("span",[1==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("UNPAID")]):e._e(),2==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("PAID")]):e._e()]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.billings.length?a("div",{staticClass:"row pl-4 mt-2 mb-2"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getBillings(e.stat)}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[0!=e.billings.length?a("base-button",{staticClass:"col-md-3 ml-2 mr-2",attrs:{id:"darkBtn"},on:{click:e.exportBillings}},[e._v("Export")]):e._e(),0!=e.billings.length?a("base-button",{staticClass:"col-md-3 ml-2 mr-2",attrs:{id:"darkBtn"},on:{click:e.printBillings}},[e._v("Print")]):e._e()],1)])],1)],1)},r=[],n=(a("4de4"),a("4160"),a("b680"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("add5"),l=a.n(o),c=a("68a2"),d=a("c1df"),u=a("e966"),m=u.bindWith(",","."),p={components:{},data:function(){return{columns:[{label:"Billing",field:"billing"},{label:"Amount",field:"amount"},{label:"Due Date",field:"dueDate"},{label:"Type",field:"billingType"},{label:"Status",field:"status"}],loading:!1,billings:[],requestProcessing:!1,views:[{limitId:"20",limit:"20 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"20",filters:[{filterId:"month",filter:"Month"},{filterId:"dateRange",filter:"Date Range"}],filter:"month",dateCreated:d().format("YYYY-MM"),startDate:d().subtract(6,"days").format("YYYY-MM-DD"),endDate:d().format("YYYY-MM-DD"),maxDate:d().format("YYYY-MM"),maxDateRange:d().format("YYYY-MM-DD"),stat:"Paid"}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=i["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=i["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Manager"!=s[0].userRole&&"Administrator"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getBillings(e.stat);case 1:case"end":return t.stop()}}),t)})))()},methods:{getBillings:function(e){var t=this,a=null,s=[],r=[],n=[],o=[],l="",c="";t.loading=!0,t.billings=[],t.stat=e,"month"==t.filter?(l=d(t.dateCreated).startOf("month").format("YYYY-MM-DD"),c=d(t.dateCreated).endOf("month").format("YYYY-MM-DD")):"dateRange"==t.filter&&(l=d(t.startDate).format("YYYY-MM-DD"),c=d(t.endDate).format("YYYY-MM-DD")),n=i["dbExpense"].collection("billingTypes"),"all"!=t.limit?"Paid"==e?a=i["dbExpense"].collection("billings").where("dueDate",">=",l).where("dueDate","<=",c).where("status","==",2).limit(t.limit):"Unpaid"==e?a=i["dbExpense"].collection("billings").where("dueDate",">=",l).where("dueDate","<=",c).where("status","==",1).limit(t.limit):"All"==e&&(a=i["dbExpense"].collection("billings").where("dueDate",">=",l).where("dueDate","<=",c).where("status","in",[1,2]).limit(t.limit)):"all"==t.limit&&("Paid"==e?a=i["dbExpense"].collection("billings").where("dueDate",">=",l).where("dueDate","<=",c).where("status","==",2):"Unpaid"==e?a=i["dbExpense"].collection("billings").where("dueDate",">=",l).where("dueDate","<=",c).where("status","==",1):"All"==e&&(a=i["dbExpense"].collection("billings").where("dueDate",">=",l).where("dueDate","<=",c).where("status","in",[1,2]))),a.get().then((function(e){e.empty||(e.forEach((function(e){r.push(e.data()),s.push(e.id)})),n.get().then((function(e){e.forEach((function(e){o.push(e.data())}));for(var a=0;a<r.length;a++){r[a]["id"]=s[a],r[a]["billingType"]="",r[a].amount=m(parseFloat(r[a].amount.replaceAll(",","")).toFixed(2));for(var n=0;n<o.length;n++)o[n].billingTypeId==r[a].billingTypeReference&&(r[a].billingType=o[n].type);t.billings.push(r[a])}}))),setTimeout((function(){t.loading=!1}),1e3)}))},printBillings:function(){var e=this,t=null,a=[],s=null,r=[],n="",o="",c=[],u=[],p="",b="";"month"==e.filter?(n=d(e.dateCreated).startOf("month").format("YYYY-MM-DD"),o=d(e.dateCreated).endOf("month").format("YYYY-MM-DD"),b=d(n).format("MMMM YYYY")):"dateRange"==e.filter&&(n=d(e.startDate).format("YYYY-MM-DD"),o=d(e.endDate).format("YYYY-MM-DD"),b=d(n).format("MMMM DD, YYYY")+" to "+d(o).format("MMMM DD, YYYY")),s=i["dbExpense"].collection("billingTypes"),"Paid"==e.stat?t=i["dbExpense"].collection("billings").where("dueDate",">=",n).where("dueDate","<=",o).where("status","==",2):"Unpaid"==e.stat?t=i["dbExpense"].collection("billings").where("dueDate",">=",n).where("dueDate","<=",o).where("status","==",1):"All"==e.stat&&(t=i["dbExpense"].collection("billings").where("dueDate",">=",n).where("dueDate","<=",o).where("status","in",[1,2])),t.get().then((function(t){t.empty||(t.forEach((function(e){a.push(e.data())})),s.get().then((function(t){t.forEach((function(e){r.push(e.data())}));for(var s=0;s<a.length;s++){a[s]["billingType"]="",a[s].amount=m(parseFloat(a[s].amount.replaceAll(",","")).toFixed(2)),1==a[s].status?a[s]["stat"]="Unpaid":2==a[s].status&&(a[s]["stat"]="Paid");for(var n=0;n<r.length;n++)r[n].billingTypeId==a[s].billingTypeReference&&(a[s].billingType=r[n].type);c.push(a[s])}u=[{field:"billing",displayName:"Billing"},{field:"billingType",displayName:"Type"},{field:"dueDate",displayName:"Due Date"},{field:"amount",displayName:"Amount"},{field:"remarks",displayName:"Remarks"},{field:"stat",displayName:"Status"}],p=e.stat+" Billings",l()({printable:c,properties:u,type:"json",header:"<h2>"+p+"</h2><br><h4>DATE: "+b+"<h4>",style:'td { text-align: center; } body { font-family: "Calibri"; }',documentTitle:p+" "+d().format("MMMM YYYY")})})))}))},exportBillings:function(){var e=new c["b"],t=this,a=null,s=[],r=null,n=[],o="",l="",u=[],p=[],b="";"month"==t.filter?(o=d(t.dateCreated).startOf("month").format("YYYY-MM-DD"),l=d(t.dateCreated).endOf("month").format("YYYY-MM-DD"),b=d(o).format("MMMM YYYY")):"dateRange"==t.filter&&(o=d(t.startDate).format("YYYY-MM-DD"),l=d(t.endDate).format("YYYY-MM-DD"),b=d(o).format("MMMM DD, YYYY")+" to "+d(l).format("MMMM DD, YYYY")),r=i["dbExpense"].collection("billingTypes"),"Paid"==t.stat?a=i["dbExpense"].collection("billings").where("dueDate",">=",o).where("dueDate","<=",l).where("status","==",2):"Unpaid"==t.stat?a=i["dbExpense"].collection("billings").where("dueDate",">=",o).where("dueDate","<=",l).where("status","==",1):"All"==t.stat&&(a=i["dbExpense"].collection("billings").where("dueDate",">=",o).where("dueDate","<=",l).where("status","in",[1,2])),a.get().then((function(a){a.empty||(a.forEach((function(e){s.push(e.data())})),r.get().then((function(a){a.forEach((function(e){n.push(e.data())}));for(var r=0;r<s.length;r++){s[r]["billingType"]="",1==s[r].status?s[r]["stat"]="Unpaid":2==s[r].status&&(s[r]["stat"]="Paid"),s[r].amount=m(parseFloat(s[r].amount.replaceAll(",","")).toFixed(2));for(var i=0;i<n.length;i++)n[i].billingTypeId==s[r].billingTypeReference&&(s[r].billingType=n[i].type);u.push(s[r])}p=[{name:"Number",key:"num",width:10},{key:"billing",name:"Billing",width:38,style:{alignment:c["a"].middleCenter}},{key:"billingType",name:"Type",width:18,style:{alignment:c["a"].middleCenter}},{key:"dueDate",name:"Due Date",width:28,style:{alignment:c["a"].middleCenter}},{key:"amount",name:"Amount",width:18,style:{alignment:c["a"].middleCenter}},{key:"remarks",name:"Remarks",width:48,style:{alignment:c["a"].middleCenter}},{key:"stat",name:"Status",width:18,style:{alignment:c["a"].middleCenter}}];for(var o={fileName:t.stat+" Billings ("+d().format("MMM DD, YYYY")+")",workSheets:[{sheetName:t.stat+" Billings",startingRowNumber:2,gapBetweenTwoTables:2,tableSettings:{data:{importable:!0,tableTitle:t.stat+" Billings: ("+b+")",headerDefinition:p}}}]},l=[],f=0;f<u.length;f++)u[f]["num"]=f+1;l.push({data:u}),e.downloadExcel(o,l)})))}))}}},b=p,f=(a("6b6d"),a("2877")),v=Object(f["a"])(b,s,r,!1,null,null,null);t["default"]=v.exports},"3f33":function(e,t,a){"use strict";a("b23c")},4057:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pt-4",attrs:{id:"textStyle"}},[a("div",{staticClass:"table-full-width"},[a("vue-good-table",{attrs:{columns:e.columns,rows:e.businessSections,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["sectionName"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.sectionName))])]):e._e(),"sectionAddress"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.sectionAddress))])]):e._e(),"action"==t.column.field?a("span",[a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdateBusinessSectionModal(t.row)}}})]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.businessSections.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getPaginatedBusinessSections(1,"")}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-business-section-modal",modifiers:{"new-business-section-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Business Section")])],1)]),a("b-modal",{attrs:{size:"lg",id:"new-business-section-modal",title:"New Business Section",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addBusinessSection(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v("Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-business-section-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Section Name:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Address:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Section Name"},model:{value:e.newSectionName,callback:function(t){e.newSectionName=t},expression:"newSectionName"}}),e.$v.newSectionName.$anyDirty&&!e.$v.newSectionName.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newSectionName.$anyDirty&&!e.$v.newSectionName.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newAddress,expression:"newAddress"}],staticClass:"pl-2",attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"Address"},domProps:{value:e.newAddress},on:{input:function(t){t.target.composing||(e.newAddress=t.target.value)}}}),e.$v.newAddress.$anyDirty&&!e.$v.newAddress.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newAddress.$anyDirty&&!e.$v.newAddress.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()])])]),a("b-modal",{attrs:{size:"lg",id:"update-business-section-modal",title:"Edit Business Section",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateBusinessSection(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("update-business-section-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Section Name:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Address:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Section Name"},model:{value:e.edit.sectionName,callback:function(t){e.$set(e.edit,"sectionName",t)},expression:"edit.sectionName"}}),e.$v.edit.sectionName.$anyDirty&&!e.$v.edit.sectionName.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.sectionName.$anyDirty&&!e.$v.edit.sectionName.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.address,expression:"edit.address"}],staticClass:"pl-2",attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"Address"},domProps:{value:e.edit.address},on:{input:function(t){t.target.composing||e.$set(e.edit,"address",t.target.value)}}}),e.$v.edit.address.$anyDirty&&!e.$v.edit.address.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.address.$anyDirty&&!e.$v.edit.address.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()])])])],1)],1)},r=[],n=(a("99af"),a("4160"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=a("c6f8"),c=o["helpers"].regex("alphaNumAndDot",/^[ A-Za-z0-9 -./, ]*$/),d=["#","Business Section","Address","Actions"],u=a("c1df"),m=new Date,p=a("9f25"),b={components:{},data:function(){return{columns:[{label:"Business Section",field:"sectionName"},{label:"Address",field:"sectionAddress"},{label:"",field:"action",sortable:!1,width:"50px"}],loading:!0,loadError:!1,businessSectionTable:{title:"Business Section Table",subTitle:"",columns:[].concat(d)},businessSectionsCount:0,businessSections:[],currentPage:1,searchTerm:"",searching:!1,requestProcessing:!1,views:[{limitId:"20",limit:"20 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"20",newSectionName:"",newAddress:"",edit:{id:"",businessSectionId:"",sectionName:"",address:""}}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=i["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=i["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"Administrator"!=s[0].userRole?a("/main/home"):a()}))}}))},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getPaginatedBusinessSections(1,"");case 1:case"end":return t.stop()}}),t)})))()},validations:{newSectionName:{required:o["required"],alphaNumCustomValidator:c},newAddress:{required:o["required"],alphaNumCustomValidator:c},edit:{sectionName:{required:o["required"],alphaNumCustomValidator:c},address:{required:o["required"],alphaNumCustomValidator:c}}},methods:{getPaginatedBusinessSections:function(e,t){var a=this,s=null,r=[],n=[];a.loading=!0,a.loadError=!1,a.businessSections=[],t&&(a.searching=!0),t?"all"!=a.limit?s=i["dbMains"].collection("businessSections").where("sectionName","==",Object(l["a"])(t)).orderBy("dateCreated","asc").limit(a.limit):"all"==a.limit&&(s=i["dbMains"].collection("businessSections").where("sectionName","==",Object(l["a"])(t)).orderBy("dateCreated","asc")):"all"!=a.limit?s=i["dbMains"].collection("businessSections").orderBy("dateCreated","asc").limit(a.limit):"all"==a.limit&&(s=i["dbMains"].collection("businessSections").orderBy("dateCreated","asc")),s.get().then((function(t){if(!t.empty){t.forEach((function(e){r.push(e.data()),n.push(e.id)})),r.sort((function(e,t){return e.sectionName-t.sectionName}));for(var s=0;s<r.length;s++)r[s]["rowNum"]=1+s,r[s]["id"]=n[s],r[s].dateCreated=u.unix(r[s].dateCreated.seconds),a.businessSections.push(r[s]);a.businessSectionsCount=r.length,a.currentPage=e}setTimeout((function(){a.loading=!1}),1e3)}))},onPageChange:function(e){var t=this.searchTerm;this.getPaginatedBusinessSections(e,t)},resetData:function(){this.searching=!1,""==this.searchTerm&&this.getPaginatedBusinessSections(1,"")},reloadData:function(){this.searchTerm="",this.searching=!1,this.getPaginatedBusinessSections(1,"")},search:function(){var e=this.searchTerm;e&&this.getPaginatedBusinessSections(1,e)},addBusinessSection:function(){var e=this;if(e.requestProcessing=!1,e.$v.newSectionName.$touch(),e.$v.newAddress.$touch(),!e.$v.newSectionName.$error&&!e.$v.newAddress.$error){var t=null;e.requestProcessing=!0,t=i["dbMains"].collection("businessSections").where("sectionName","==",Object(l["a"])(e.newSectionName)),t.get().then((function(t){if(t.empty){if(t){var a=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),s=[],r="BCI-"+m.getFullYear()+p(m.getMonth()+1,2)+m.getDate()+"-"+Math.floor(1e6*Math.random());a.get().then((function(t){t.forEach((function(e){e.exists&&s.push(e.data())}));try{i["dbMains"].collection("businessSections").doc().set({businessSectionId:r,sectionName:Object(l["a"])(e.newSectionName),sectionAddress:e.newAddress,userReference:s[0].userId,status:1,dateCreated:m,dateModified:m}).then((function(){e.newSectionName="",e.newAddress="",e.requestProcessing=!1,e.$v.newSectionName.$reset(),e.$v.newAddress.$reset(),e.$bvModal.hide("new-business-section-modal"),e.getPaginatedBusinessSections(1,""),e.$swal({title:"Success",text:"New business section added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}))}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Business section already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},openUpdateBusinessSectionModal:function(e){this.edit={id:e.id,businessSectionId:e.businessSectionId,sectionName:e.sectionName,address:e.sectionAddress},this.$bvModal.show("update-business-section-modal")},updateBusinessSection:function(){var e=this;if(e.requestProcessing=!0,e.$v.edit.$touch(),!e.$v.edit.$error){var t=null;t=i["dbMains"].collection("businessSections").where("sectionName","==",Object(l["a"])(e.edit.sectionName)).where("businessSectionId","!=",e.edit.businessSectionId),t.get().then((function(t){if(t.empty){if(t)try{i["dbMains"].collection("businessSections").doc(e.edit.id).update({sectionName:Object(l["a"])(e.edit.sectionName),sectionAddress:e.edit.address,dateModified:m}).then((function(){e.edit={},e.$v.edit.$reset(),e.$bvModal.hide("update-business-section-modal"),e.requestProcessing=!1,e.getPaginatedBusinessSections(1,""),e.$swal({title:"Success",text:"Business section updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Business section already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}}}},f=b,v=(a("4937"),a("2877")),h=Object(v["a"])(f,s,r,!1,null,null,null);t["default"]=h.exports},"41bb":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row justify-content-center mt-5"},[a("div",{staticClass:"col-lg-5 col-md-7 pt-6 pb-0"},[a("transition",{attrs:{name:"slideDown"}},[e.show?a("div",{staticClass:"card"},[a("div",{staticClass:"card-header pt-0 mt-0 pb-0",attrs:{id:"grayBg"}},[a("div",{staticClass:"btn-wrapper text-center pt-1 mt-0"},[a("a",{attrs:{href:"http://localhost"}},[a("img",{staticClass:"pr-1 mb-3 pb-0 ml-0 pl-0 mt-2",attrs:{src:"img/icons/AVASIA-NEW-LOGO_B.png",alt:"Avasia",width:"190px",height:"60px"}})])])]),a("div",{staticClass:"card-body px-lg-5 py-lg-5 pt-0"},[a("form",{attrs:{role:"form"}},[a("base-input",{staticClass:"pt-0 pb-0 mb-1",attrs:{id:"inputStyle",placeholder:"Username","addon-left-icon":"ni ni-circle-08"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.userLogin(t)}},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}}),e.$v.user.username.$anyDirty&&!e.$v.user.username.required?a("i",{staticClass:"text-danger pt-0 pb-0"},[e._v("Field Required")]):e._e(),a("base-input",{staticClass:"pt-0 pb-0",attrs:{id:"inputStyle",placeholder:"Password",type:"password","addon-left-icon":"ni ni-lock-circle-open"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.userLogin(t)}},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),e.$v.user.password.$anyDirty&&!e.$v.user.password.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e(),a("div",{staticClass:"text-center pt-0"},[a("base-button",{staticClass:"my-4",attrs:{block:"",id:"grayBtn"},nativeOn:{click:function(t){return e.userLogin(t)}}},[e._v("Log in")])],1)],1)])]):e._e()])],1)])},r=[],n=(a("4160"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=a("323d"),c=a("c1df"),d={name:"login",components:{},data:function(){return{user:{username:"",password:""},site:"check",show:!1}},validations:{user:{username:{required:o["required"]},password:{required:o["required"]}},site:{required:o["required"]}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.checkToken(),e.$bvToast.hide(),e.show=!0;case 3:case"end":return t.stop()}}),t)})))()},methods:{checkToken:function(){localStorage.getItem("aistoken")&&this.$router.push("/main/home")},userLogin:function(e){var t=this;if(e.preventDefault(),t.$v.user.$touch(),t.$v.site.$touch(),!t.$v.user.$error&&!t.$v.site.$error){var a=i["dbUsers"].collection("users").where("username","==",t.user.username),s=[];a.get().then((function(e){if(e.empty)t.$v.user.$reset(),t.$swal({title:"Invalid",text:"Username not found",icon:"error",confirmButtonColor:"#ef8157",confirmButtonText:"OK"});else if(e.forEach((function(e){s.push(e.data())})),0==s[0].status)t.$swal({title:"Invalid",text:"User account is inactive.",icon:"error",confirmButtonColor:"#096b85",confirmButtonText:"OK"});else if(l.verify(t.user.password,s[0].password)){t.$swal({position:"top-center",icon:"success",title:"Login Successful",showConfirmButton:!1,timer:1500});var a=i["dbUsers"].collection("accountKeys").where("userReference","==",s[0].userId),r="";a.get().then((function(e){e.forEach((function(e){r=e.id})),i["dbUsers"].collection("accountKeys").doc(r).update({secretKey:Math.floor(1e10*Math.random()+1)}).then((function(){var e=i["dbUsers"].collection("accountKeys").where("userReference","==",s[0].userId),a=[];e.get().then((function(e){e.empty||e.forEach((function(e){a.push(e.data())})),localStorage.setItem("aistoken",s[0].username+a[0].secretKey),localStorage.setItem("aisname",s[0].username),t.$v.user.$reset(),t.$router.push("/main/home"),t.showNotification()}))}))}))}else t.$v.user.$reset(),t.$swal({title:"Invalid",text:"Incorrect password",icon:"error",confirmButtonColor:"#ef8157",confirmButtonText:"OK"})}))}},showNotification:function(){var e=this,t=null,a=[],s="",r=c().subtract(7,"days").format("YYYY-MM-DD");e.$bvToast.hide(),e.username=localStorage.getItem("aisname"),e.accountName=e.username.toUpperCase();var n=i["dbUsers"].collection("users").where("username","==",e.username),o="";n.get().then((function(n){n.empty||n.forEach((function(e){o=e.data().userRoleReference}));var l=i["dbUsers"].collection("userRoles").where("userRoleId","==",o),d="";l.get().then((function(n){n.empty||(n.forEach((function(e){d=e.data().userRole})),"User"!=d&&(t=i["dbExpense"].collection("billings").where("dueDate",">=",r).where("status","==",1).orderBy("dueDate","desc"),t.get().then((function(t){if(!t.empty){t.forEach((function(e){a.push(e.data())}));for(var r=0;r<a.length;r++){s=c(a[r].dueDate).format("MMM DD, YYYY")==c().format("MMM DD, YYYY")?"DUE TODAY : "+c(a[r].dueDate).format("MMM DD, YYYY"):c(a[r].dueDate).format("MMM DD, YYYY")==c().add(1,"day").format("MMM DD, YYYY")?"DUE TOMORROW : "+c(a[r].dueDate).format("MMM DD, YYYY"):c(a[r].dueDate).format("MMM DD, YYYY")<c().format("MMM DD, YYYY")?"ALREADY DUE : "+c(a[r].dueDate).format("MMM DD, YYYY"):"DUE ON "+c(a[r].dueDate).format("dddd")+" : "+c(a[r].dueDate).format("MMM DD, YYYY");var n=e.$createElement,i=n("b",{class:["text-left","mb-0"]},[n("i",{class:"fa fa-exclamation-circle",id:"sideBarTxt"})," "+s]);e.$bvToast.toast(a[r].billing,{title:[i],toaster:"b-toaster-bottom-right",solid:!1,variant:"danger",noAutoHide:!0})}}}))))}))}))}}},u=d,m=(a("b04b"),a("2877")),p=Object(m["a"])(u,s,r,!1,null,null,null);t["default"]=p.exports},4642:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5 pt-md-5"}),a("div",{attrs:{id:"textStyle"}},[a("div",{staticClass:"col-12 container-fluid mt--7"},[a("tabs",{staticClass:"flex-column flex-md-row",attrs:{fill:""}},[a("tab-pane",{attrs:{title:"Check List"}},[a("check-list")],1),a("tab-pane",{attrs:{title:"New Check"}},[a("new-check")],1),"User"!=e.userRole?a("tab-pane",{attrs:{title:"Voucher Particulars"}},[a("check-voucher-particular")],1):e._e()],1)],1)])],1)},r=[],n=(a("4160"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o={components:{},data:function(){return{userRole:"User"}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUserRole();case 1:case"end":return t.stop()}}),t)})))()},methods:{getUserRole:function(){var e=this;e.username=localStorage.getItem("aisname"),e.accountName=e.username.toUpperCase();var t=i["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||(t.forEach((function(e){a.push(e.data())})),e.accountId=a[0].userId);var s=i["dbUsers"].collection("userRoles").where("userRoleId","==",a[0].userRoleReference),r=[];s.get().then((function(t){t.empty||(t.forEach((function(e){r.push(e.data())})),e.userRole=r[0].userRole)}))}))}}},l=o,c=(a("3f33"),a("2877")),d=Object(c["a"])(l,s,r,!1,null,null,null);t["default"]=d.exports},4937:function(e,t,a){"use strict";a("c791")},5279:function(e,t,a){"use strict";a("74cf")},"528a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"textStyle"}},[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left ml-2 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-5"},["Active"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"redTxt"},on:{click:function(t){return e.getPaginatedUsers(1,"","Active")}}},[e._v("Active")])]),a("badge",{staticClass:"badge-dot ml-5"},["Disabled"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"redTxt"},on:{click:function(t){return e.getPaginatedUsers(1,"","Disabled")}}},[e._v("Disabled")])]),a("badge",{staticClass:"badge-dot ml-5"},["All"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"redTxt"},on:{click:function(t){return e.getPaginatedUsers(1,"","All")}}},[e._v("All")])])],1)]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{attrs:{columns:e.columns,rows:e.users,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["username"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.username))])]):e._e(),"role"==t.column.field?a("span",e._l(e.roles,(function(s){return a("span",{key:s.userRoleId},[s.userRoleId==t.row.userRoleReference?a("span",[e._v(e._s(s.userRole))]):e._e()])})),0):e._e(),"emailAddress"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.emailAddress))])]):e._e(),"userReference"==t.column.field?a("span",[e._l(e.users,(function(s){return a("span",{key:s.userId},[s.userId==t.row.userReference?a("span",[e._v(e._s(s.firstname)+" "+e._s(s.lastname))]):e._e()])})),""==t.row.userReference?a("span",[a("span",[e._v("----------")])]):e._e()],2):e._e(),"status"==t.column.field?a("span",[a("span",[e._v(e._s(1==t.row.status?"Active":"Disabled"))])]):e._e(),"action"==t.column.field?a("span",[1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"redTxt",title:"Update"},on:{click:function(a){return e.updateUser(t.row.userId)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-times-circle",attrs:{id:"redTxt",title:"Disable"},on:{click:function(a){return e.changeStatusUser(t.row.id,0)}}}):e._e(),1!=t.row.status?a("span",{staticClass:"pointer ml-2 far fa-check-circle",attrs:{id:"redTxt",title:"Activate"},on:{click:function(a){return e.changeStatusUser(t.row.id,1)}}}):e._e()]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.users.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2 text-right"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1,readonly:""},on:{input:function(t){return e.getPaginatedUsers()}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{staticClass:"col-md-2 ml-2 mr-2",attrs:{id:"darkBtn"},nativeOn:{click:function(t){return e.newUser(t)}}},[e._v("New User")])],1)])],1)],1)},r=[],n=(a("99af"),a("4160"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),o=a("56d7"),l=a("2f62"),c=["#","Username","Role","Email","Status","Actions"],d=a("c1df"),u=new Date,m={components:{},data:function(){return{columns:[{label:"Username",field:"username"},{label:"Role",field:"role"},{label:"Email",field:"emailAddress"},{label:"Created by",field:"userReference"},{label:"Status",field:"status"},{label:"",field:"action",sortable:!1,width:"100px"}],loading:!0,loadError:!1,userTable:{title:"Users Table",subTitle:"",columns:[].concat(c)},usersCount:0,users:[],currentPage:1,searchTerm:"",searching:!1,roles:[],requestProcessing:!1,views:[{limitId:"30",limit:"30 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"30",listType:"Active"}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=o["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=o["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole||"Manager"==s[0].userRole?a("/main/home"):"Administrator"==s[0].userRole&&a()}))}}))},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getRoles(),e.getPaginatedUsers(1,"","Active");case 2:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(l["b"])({users:"Users/users"})),methods:{getPaginatedUsers:function(e,t,a){var s=this,r=null,n=[],i=[];s.loading=!0,s.loadError=!1,s.users=[],s.listType=a,t&&(s.searching=!0),t?"all"!=s.limit?r=o["dbUsers"].collection("users").where("username","==",t).orderBy("dateCreated","asc").limit(s.limit):"all"==s.limit&&(r=o["dbUsers"].collection("users").where("username","==",t).orderBy("dateCreated","asc")):"Active"==a?"all"!=s.limit?r=o["dbUsers"].collection("users").where("status","==",1).orderBy("dateCreated","asc").limit(s.limit):"all"==s.limit&&(r=o["dbUsers"].collection("users").where("status","==",1).orderBy("dateCreated","asc")):"Disabled"==a?"all"!=s.limit?r=o["dbUsers"].collection("users").where("status","==",0).orderBy("dateCreated","asc").limit(s.limit):"all"==s.limit&&(r=o["dbUsers"].collection("users").where("status","==",0).orderBy("dateCreated","asc")):"All"==a&&("all"!=s.limit?r=o["dbUsers"].collection("users").orderBy("dateCreated","asc").limit(s.limit):"all"==s.limit&&(r=o["dbUsers"].collection("users").orderBy("dateCreated","asc"))),r.get().then((function(t){if(!t.empty){t.forEach((function(e){n.push(e.data()),i.push(e.id)})),n.sort((function(e,t){return e.username-t.username}));for(var a=0;a<n.length;a++)n[a]["rowNum"]=1+a,n[a]["id"]=i[a],n[a].dateCreated=d.unix(n[a].dateCreated.seconds),s.users.push(n[a]);s.usersCount=n.length,s.currentPage=e}setTimeout((function(){s.loading=!1}),1e3)}))},onPageChange:function(e){var t=this.searchTerm;this.getPaginatedUsers(e,t,"Active")},resetData:function(){this.searching=!1,""==this.searchTerm&&this.getPaginatedUsers(1,"","Active")},reloadData:function(){this.searchTerm="",this.searching=!1,this.getPaginatedUsers(1,"","Active")},search:function(){var e=this.searchTerm;e&&this.getPaginatedUsers(1,e,"Active")},getRoles:function(){var e=this,t=o["dbUsers"].collection("userRoles").orderBy("userRole","asc");e.roles=[],t.get().then((function(t){t.forEach((function(t){e.roles.push(t.data())}))}))},newUser:function(){this.$router.push("/new/user")},updateUser:function(e){this.$router.push("/user/update/"+e)},changeStatusUser:function(e,t){var a=this,s="disable",r="disabled";1==t&&(s="activate",r="activated"),this.$swal({title:"Are you sure?",text:"You want to "+s+" this User",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#f5c71a",confirmButtonText:"CONFIRM",cancelButtonText:"CANCEL"}).then((function(s){s.value&&o["dbUsers"].collection("users").doc(e).update({status:t,dateModified:u}).then((function(){a.getPaginatedUsers(1,"","Active"),a.getRoles(),a.$swal({title:"Success",text:"User "+r+"!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(e){console.log(e),a.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}))}}},p=m,b=a("2877"),f=Object(b["a"])(p,s,r,!1,null,null,null);t["default"]=f.exports},"59b1":function(e,t,a){"use strict";a("d5f8")},"5c2d":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pt-4",attrs:{id:"textStyle"}},[a("div",{staticClass:"table-full-width"},[a("vue-good-table",{ref:"wtc-table",attrs:{columns:e.columns,rows:e.withholdingTaxCodes,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["withholdingTaxCode"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.withholdingTaxCode))])]):e._e(),"withholdingTaxRate"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.withholdingTaxRate))])]):e._e(),"type"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.type))])]):e._e(),"userReference"==t.column.field?a("span",[e._l(e.users,(function(s){return a("span",{key:s.userId},[s.userId==t.row.userReference?a("span",[e._v(e._s(s.firstname)+" "+e._s(s.lastname))]):e._e()])})),""==t.row.userReference?a("span",[a("span",[e._v("----------")])]):e._e()],2):e._e(),"action"==t.column.field?a("span",[a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdateWTaxCodeModal(t.row)}}})]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.withholdingTaxCodes.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getPaginatedWithholdingTaxCodes(1,"")}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-withholding-tax-code-modal",modifiers:{"new-withholding-tax-code-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Withholding Tax Code")])],1)]),a("b-modal",{attrs:{size:"lg",id:"new-withholding-tax-code-modal",title:"New Withholding Tax Code",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addWithholdingTaxCode(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-withholding-tax-code-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Withholding Tax Code:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Withholding Tax Rate:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Withholding Tax Code"},model:{value:e.newWithholdingTaxCode,callback:function(t){e.newWithholdingTaxCode=t},expression:"newWithholdingTaxCode"}}),e.$v.newWithholdingTaxCode.$anyDirty&&!e.$v.newWithholdingTaxCode.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newWithholdingTaxCode.$anyDirty&&!e.$v.newWithholdingTaxCode.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Withholding Tax Rate"},model:{value:e.newWithholdingTaxRate,callback:function(t){e.newWithholdingTaxRate=t},expression:"newWithholdingTaxRate"}}),e.$v.newWithholdingTaxRate.$anyDirty&&!e.$v.newWithholdingTaxRate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newWithholdingTaxRate.$anyDirty&&!e.$v.newWithholdingTaxRate.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Type:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Nature of Income:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{input:"inputStyle",options:e.wTypes,reduce:function(e){return e.typeId},label:"typeName",clearable:!1},model:{value:e.newType,callback:function(t){e.newType=t},expression:"newType"}}),e.$v.newType.$anyDirty&&!e.$v.newType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newNatureOfIncome,expression:"newNatureOfIncome"}],staticClass:"pl-2",attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"Nature Of Income"},domProps:{value:e.newNatureOfIncome},on:{input:function(t){t.target.composing||(e.newNatureOfIncome=t.target.value)}}})])])]),a("b-modal",{attrs:{size:"lg",id:"update-wtax-code-modal",title:"Edit Withholding Tax Code",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateWTaxCode(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("update-wtax-code-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Withholding Tax Code:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Withholding Tax Rate:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Withholding Tax Code"},model:{value:e.edit.wTaxCode,callback:function(t){e.$set(e.edit,"wTaxCode",t)},expression:"edit.wTaxCode"}}),e.$v.edit.$anyDirty&&!e.$v.edit.wTaxCode.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.wTaxCode.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Withholding Tax Rate"},model:{value:e.edit.wTaxRate,callback:function(t){e.$set(e.edit,"wTaxRate",t)},expression:"edit.wTaxRate"}}),e.$v.edit.$anyDirty&&!e.$v.edit.wTaxRate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.wTaxRate.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Type:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Nature of Income:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{input:"inputStyle",options:e.wTypes,reduce:function(e){return e.typeId},label:"typeName",clearable:!1},model:{value:e.edit.type,callback:function(t){e.$set(e.edit,"type",t)},expression:"edit.type"}}),e.$v.edit.$anyDirty&&!e.$v.edit.type.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.natureOfIncome,expression:"edit.natureOfIncome"}],staticClass:"pl-2",attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"Nature Of Income"},domProps:{value:e.edit.natureOfIncome},on:{input:function(t){t.target.composing||e.$set(e.edit,"natureOfIncome",t.target.value)}}})])])])],1)],1)},r=[],n=(a("99af"),a("4160"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),o=a("56d7"),l=a("b5ae"),c=a("c6f8"),d=a("2f62"),u=l["helpers"].regex("alphaNumAndDot",/^[ A-Za-z0-9 -./, ]*$/),m=l["helpers"].regex("alphaNumAndDot",/^[ 0-9. ]*$/),p=["#","Withholding Tax Code","Tax Rate","Type","Actions"],b=a("c1df"),f=new Date,v=a("9f25"),h={components:{},data:function(){return{columns:[{label:"Withholding Tax Code",field:"withholdingTaxCode"},{label:"Tax Rate",field:"withholdingTaxRate"},{label:"Type",field:"type"},{label:"Created by",field:"userReference"},{label:"",field:"action",sortable:!1,width:"50px"}],loading:!0,loadError:!1,withholdingTaxCodeTable:{title:"Withholding Tax Code Table",subTitle:"",columns:[].concat(p)},withholdingTaxCodesCount:0,withholdingTaxCodes:[],currentPage:1,searchTerm:"",searching:!1,views:[{limitId:"20",limit:"20 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"20",requestProcessing:!1,wTypes:[{typeId:"Individual",typeName:"Individual"},{typeId:"Corporate",typeName:"Corporate"}],newWithholdingTaxCode:"",newWithholdingTaxRate:"",newType:"Individual",newNatureOfIncome:"",edit:{id:"",wTaxCodeId:"",wTaxCode:"",wTaxRate:"",type:"",natureOfIncome:""}}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=o["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=o["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Manager"!=s[0].userRole&&"Administrator"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getPaginatedWithholdingTaxCodes(1,"");case 1:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(d["b"])({users:"Users/users"})),validations:{newWithholdingTaxCode:{required:l["required"],alphaNumCustomValidator:u},newWithholdingTaxRate:{required:l["required"],numCustomValidator:m},newType:{required:l["required"]},edit:{wTaxCode:{required:l["required"],alphaNumCustomValidator:u},wTaxRate:{required:l["required"],numCustomValidator:m},type:{required:l["required"]}}},methods:{getPaginatedWithholdingTaxCodes:function(e,t){var a=this,s=null,r=[],n=[];a.loading=!0,a.loadError=!1,a.withholdingTaxCodes=[],t&&(a.searching=!0),t?"all"!=a.limit?s=o["dbMains"].collection("withholdingTaxCode").where("withholdingTaxCode","==",Object(c["a"])(t)).orderBy("dateCreated","asc").limit(a.limit):"all"==a.limit&&(s=o["dbMains"].collection("withholdingTaxCode").where("withholdingTaxCode","==",Object(c["a"])(t)).orderBy("dateCreated","asc")):"all"!=a.limit?s=o["dbMains"].collection("withholdingTaxCode").orderBy("dateCreated","asc").limit(a.limit):"all"==a.limit&&(s=o["dbMains"].collection("withholdingTaxCode").orderBy("dateCreated","asc")),s.get().then((function(t){if(!t.empty){t.forEach((function(e){r.push(e.data()),n.push(e.id)})),r.sort((function(e,t){return e.withholdingTaxCode-t.withholdingTaxCode}));for(var s=0;s<r.length;s++)r[s]["rowNum"]=1+s,r[s]["id"]=n[s],r[s].dateCreated=b.unix(r[s].dateCreated.seconds),a.withholdingTaxCodes.push(r[s]);a.withholdingTaxCodesCount=r.length,a.currentPage=e}setTimeout((function(){a.loading=!1}),1e3)}))},onPageChange:function(e){var t=this.searchTerm;this.getPaginatedWithholdingTaxCodes(e,t)},resetData:function(){this.searching=!1,""==this.searchTerm&&this.getPaginatedWithholdingTaxCodes(1,"")},reloadData:function(){this.searchTerm="",this.searching=!1,this.getPaginatedWithholdingTaxCodes(1,"")},search:function(){var e=this.searchTerm;e&&this.getPaginatedWithholdingTaxCodes(1,e)},addWithholdingTaxCode:function(){var e=this;if(e.requestProcessing=!1,e.$v.newWithholdingTaxCode.$touch(),e.$v.newWithholdingTaxRate.$touch(),e.$v.newType.$touch(),!e.$v.newWithholdingTaxCode.$error&&!e.$v.newWithholdingTaxRate.$error&&!e.$v.newType.$error){var t=null;e.requestProcessing=!0,t=o["dbMains"].collection("withholdingTaxCode").where("withholdingTaxCode","==",Object(c["a"])(e.newWithholdingTaxCode)),t.get().then((function(t){if(t.empty){if(t){var a=o["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),s=[],r="WTC-"+f.getFullYear()+v(f.getMonth()+1,2)+f.getDate()+"-"+Math.floor(1e6*Math.random());a.get().then((function(t){t.forEach((function(e){e.exists&&s.push(e.data())}));try{o["dbMains"].collection("withholdingTaxCode").doc().set({withholdingTaxCodeId:r,withholdingTaxCode:Object(c["a"])(e.newWithholdingTaxCode),withholdingTaxRate:e.newWithholdingTaxRate,type:e.newType,natureOfIncome:e.newNatureOfIncome,userReference:s[0].userId,status:1,dateCreated:f,dateModified:f}).then((function(){e.newWithholdingTaxCode="",e.newWithholdingTaxRate="",e.newType="Individual",e.newNatureOfIncome="",e.requestProcessing=!1,e.$v.newWithholdingTaxCode.$reset(),e.$v.newWithholdingTaxRate.$reset(),e.$v.newType.$reset(),e.$bvModal.hide("new-withholding-tax-code-modal"),e.$refs["wtc-table"].reset(),e.getPaginatedWithholdingTaxCodes(1,""),e.$swal({title:"Success",text:"New withholding tax code added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}))}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Withholding tax code already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},openUpdateWTaxCodeModal:function(e){this.edit={id:e.id,wTaxCodeId:e.withholdingTaxCodeId,wTaxCode:e.withholdingTaxCode,wTaxRate:e.withholdingTaxRate,type:e.type,natureOfIncome:e.natureOfIncome},this.$bvModal.show("update-wtax-code-modal")},updateWTaxCode:function(){var e=this;if(e.requestProcessing=!0,e.$v.edit.$touch(),!e.$v.edit.$error){var t=null;t=o["dbMains"].collection("withholdingTaxCode").where("withholdingTaxCode","==",Object(c["a"])(e.edit.wTaxCode)).where("withholdingTaxCodeId","!=",e.edit.wTaxCodeId),t.get().then((function(t){if(t.empty){if(t)try{o["dbMains"].collection("withholdingTaxCode").doc(e.edit.id).update({withholdingTaxCode:Object(c["a"])(e.edit.wTaxCode),withholdingTaxRate:e.edit.wTaxRate,type:e.edit.type,natureOfIncome:e.edit.natureOfIncome,dateModified:f}).then((function(){e.edit={},e.$v.edit.$reset(),e.$bvModal.hide("update-wtax-code-modal"),e.requestProcessing=!1,e.getPaginatedWithholdingTaxCodes(1,""),e.$refs["wtc-table"].reset(),e.$swal({title:"Success",text:"Withholding tax code updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Withholding tax code already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}}}},C=h,w=(a("a40e"),a("2877")),g=Object(w["a"])(C,s,r,!1,null,null,null);t["default"]=g.exports},"6b6d":function(e,t,a){"use strict";a("2dff")},7072:function(e,t,a){},"74cf":function(e,t,a){},"841c":function(e,t,a){"use strict";var s=a("d784"),r=a("825a"),n=a("1d80"),i=a("129f"),o=a("14c3");s("search",1,(function(e,t,a){return[function(t){var a=n(this),s=void 0==t?void 0:t[e];return void 0!==s?s.call(t,a):new RegExp(t)[e](String(a))},function(e){var s=a(t,e,this);if(s.done)return s.value;var n=r(e),l=String(this),c=n.lastIndex;i(c,0)||(n.lastIndex=0);var d=o(n,l);return i(n.lastIndex,c)||(n.lastIndex=c),null===d?-1:d.index}]}))},"86e4":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5 pt-md-5"}),a("div",{attrs:{id:"textStyle"}},[a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left ml-1 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-2 pointer"},["Release"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getRefundDisbursements("Release")}}},[e._v("Release")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},["Cleared"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getRefundDisbursements("Cleared")}}},[e._v("Cleared")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},["All"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getRefundDisbursements("All")}}},[e._v("All")])])],1)]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"}),a("span",{staticClass:"col-2 pb-3 pl-4 text-right"},[a("b",[e._v("Filter by:")])]),a("span",{staticClass:"col-sm-2 pb-2 text-right"},[a("v-select",{staticStyle:{width:"150px"},attrs:{id:"inputStyle",options:e.filters,reduce:function(e){return e.filterId},label:"filter",clearable:!1,readonly:""},on:{input:function(t){return e.getRefundDisbursements(e.listType)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),a("span",{staticClass:"col-sm-2 pl-0"},["month"==e.filter?a("base-input",{staticClass:"pb-2",staticStyle:{width:"230px"},attrs:{type:"month",max:e.maxDate,min:"1997-01",id:"inputStyle"},on:{input:function(t){return e.getRefundDisbursements(e.listType)}},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}}):e._e()],1)]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{ref:"refund-disbursement-table",attrs:{columns:e.columns,rows:e.refundDisbursements,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["voucherNumber"==t.column.field?a("span",[a("span",{staticClass:"pointer",attrs:{id:"sideBarTxt"},on:{click:function(a){return e.openViewRefundDisbursementModal(t.row)}}},[e._v(e._s(t.row.voucherNumber))])]):e._e(),"transactionDate"==t.column.field?a("span",[a("span",[e._v(e._s(e._f("moment")(t.row.transactionDate,"MMM DD, YYYY")))])]):e._e(),"amount"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v("â‚± "+e._s(t.row.amount))])]):e._e(),"refundDate"==t.column.field?a("span",[a("span",[e._v(e._s(e._f("moment")(t.row.refundDate,"MMM DD, YYYY")))])]):e._e(),"userReference"==t.column.field?a("span",[e._l(e.users,(function(s){return a("span",{key:s.userId},[s.userId==t.row.userReference?a("span",[e._v(e._s(s.firstname)+" "+e._s(s.lastname))]):e._e()])})),""==t.row.userReference?a("span",[a("span",[e._v("----------")])]):e._e()],2):e._e(),"status"==t.column.field?a("span",[1==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("RELEASE")]):e._e(),2==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("CLEARED")]):e._e()]):e._e(),"action"==t.column.field?a("span",[1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdateRDModal(t.row)}}}):e._e(),1==t.row.status&&"User"!=e.userRole?a("span",{staticClass:"pointer ml-2 far fa-check-square",attrs:{id:"sideBarTxt",title:"Cleared"},on:{click:function(a){return e.changeStatus(t.row,2)}}}):e._e(),2==t.row.status&&"User"!=e.userRole?a("span",{staticClass:"pointer ml-2 far fa-square",attrs:{id:"sideBarTxt",title:"Release"},on:{click:function(a){return e.changeStatus(t.row,1)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 fa fa-file",attrs:{id:"sideBarTxt",title:"Attachment"},on:{click:function(a){return e.openAttachments(t.row)}}}):e._e()]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),e.refundDisbursements.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2 text-right"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getRefundDisbursements(e.listType)}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-refund-disbursement-modal",modifiers:{"new-refund-disbursement-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Refund Disbursement")])],1)]),a("div",{staticClass:"pl-4",attrs:{id:"duplicateView"}},[a("div",{staticClass:"row"},[e._m(0),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Voucher Number: "+e._s(e.view.voucherNumber))])])]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Transaction Date: ")]),e._v(e._s(e._f("moment")(e.view.transactionDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Amount: ")]),e._v("â‚± "+e._s(e.view.amount)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Refund Date: ")]),e._v(e._s(e._f("moment")(e.view.refundDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Particular: ")]),e._v(e._s(e.view.particular)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Issue: ")]),e._v(e._s(e.view.issue)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Chart of Account: ")]),e._v(e._s(e.view.coa)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Business Type: ")]),e._v(e._s(e.view.businessType)+" ")])]),a("hr"),a("div",{staticClass:"row"},[e._m(1),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Prepared by :")]),e._v(" "+e._s(e.user.firstname)+" "+e._s(e.user.lastname)+" ")])]),e._m(2),a("br"),e._l(e.breakCounts,(function(e){return a("span",{key:e},[a("br")])})),a("br"),a("div",{staticClass:"row"},[e._m(3),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Voucher Number: "+e._s(e.view.voucherNumber))])])]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Transaction Date: ")]),e._v(e._s(e._f("moment")(e.view.transactionDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Amount: ")]),e._v("â‚± "+e._s(e.view.amount)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Refund Date: ")]),e._v(e._s(e._f("moment")(e.view.refundDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Particular: ")]),e._v(e._s(e.view.particular)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Issue: ")]),e._v(e._s(e.view.issue)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Chart of Account: ")]),e._v(e._s(e.view.coa)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Business Type: ")]),e._v(e._s(e.view.businessType)+" ")])]),a("hr"),a("div",{staticClass:"row"},[e._m(4),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Prepared by :")]),e._v(" "+e._s(e.user.firstname)+" "+e._s(e.user.lastname)+" ")])]),e._m(5)],2),a("b-modal",{attrs:{size:"xl",id:"new-refund-disbursement-modal",title:"New Refund Disbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.newRefundDisbursement(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-refund-disbursement-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Transaction Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Refund Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date"},model:{value:e.newTransDate,callback:function(t){e.newTransDate=t},expression:"newTransDate"}}),e.$v.newTransDate.$anyDirty&&!e.$v.newTransDate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date"},model:{value:e.newRefundDate,callback:function(t){e.newRefundDate=t},expression:"newRefundDate"}}),e.$v.newRefundDate.$anyDirty&&!e.$v.newRefundDate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Particular:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.newAmount,callback:function(t){e.newAmount=t},expression:"newAmount"}}),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.newParticular,callback:function(t){e.newParticular=t},expression:"newParticular"}})],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Issue:")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Chart of Accounts:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newIssue,expression:"newIssue"}],attrs:{rows:"4",cols:"59",id:"inputStyle"},domProps:{value:e.newIssue},on:{input:function(t){t.target.composing||(e.newIssue=t.target.value)}}})]),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.coas,reduce:function(e){return e.accountId},label:"account",clearable:!1},model:{value:e.newCOA,callback:function(t){e.newCOA=t},expression:"newCOA"}}),e.$v.newCOA.$anyDirty&&!e.$v.newCOA.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Business Types:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.businessTypes,reduce:function(e){return e.businessTypeId},label:"type",clearable:!1},model:{value:e.newBusinessType,callback:function(t){e.newBusinessType=t},expression:"newBusinessType"}}),e.$v.newBusinessType.$anyDirty&&!e.$v.newBusinessType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])]),a("b-modal",{attrs:{size:"xl",id:"view-refund-disbursement-modal",title:"View Refund Disbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.printRefundDisbursement(t)}}},[e._v(" Print ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("view-refund-disbursement-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("card",{staticClass:"pl-4 pt-5 pb-5 shadow",attrs:{id:"singleView"}},[a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("REFUND DISBURSEMENT")])]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Voucher Number: "+e._s(e.view.voucherNumber))])])]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Transaction Date: ")]),e._v(e._s(e._f("moment")(e.view.transactionDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Amount: ")]),e._v("â‚± "+e._s(e.view.amount)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Refund Date: ")]),e._v(e._s(e._f("moment")(e.view.refundDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Particular: ")]),e._v(e._s(e.view.particular)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Issue: ")]),e._v(e._s(e.view.issue)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Chart of Account: ")]),e._v(e._s(e.view.coa)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Business Type: ")]),e._v(e._s(e.view.businessType)+" ")])]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Received Payment by : ")])]),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Prepared by :")]),e._v(" "+e._s(e.user.firstname)+" "+e._s(e.user.lastname)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Certified by : ")])]),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Approved by : ")])])])])],1),a("b-modal",{attrs:{size:"lg",id:"attachment-modal",title:"Attachments",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[1==e.attachmentStatus?a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addAttachments()}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add Attachment ")]):e._e(),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("attachment-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("input",{ref:"attachmentFile",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.previewImage}}),e.loadAttachment?a("card",{attrs:{shadow:""}},[a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12 text-center"},[a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}}),a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}}),a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}})],1)])]):e._e(),e.attachments.length>0&&!e.loadAttachment?a("card",{attrs:{shadow:""}},[e.attachments.length>0?a("div",{staticClass:"row pl-4",attrs:{align:"center"}},e._l(e.attachments,(function(t){return a("span",{key:t.rowNum},[a("span",{staticClass:"col-4"},[a("div",{staticClass:"mt-1 mb--2 pr-2 text-right"},[1==e.attachmentStatus?a("span",{staticClass:"pointer far fa-times-circle text-danger",staticStyle:{"z-index":"1",position:"relative",left:"0px",top:"0px"},attrs:{title:"Remove"},on:{click:function(a){return e.removeAttachment(t.name)}}}):e._e()]),a("span",{staticClass:"mt-0"},[a("a",{attrs:{target:"_blank",href:t.url}},[a("img",{staticStyle:{width:"220px",height:"220px","border-style":"solid","border-color":"black","border-width":"2px"},attrs:{src:t.url}})])])])])})),0):e._e()]):e._e(),0!=e.attachments.length||e.loadAttachment?e._e():a("card",{attrs:{shadow:""}},[a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12"},[a("h2",{staticClass:"text-center"},[e._v("NO ATTACHMENT")])])])])],1),a("b-modal",{attrs:{size:"xl",id:"edit-refund-disbursement-modal",title:"Edit Refund Disbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateRefundDisbursement(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-refund-disbursement-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Transaction Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Refund Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date"},model:{value:e.edit.transDate,callback:function(t){e.$set(e.edit,"transDate",t)},expression:"edit.transDate"}}),e.$v.edit.$anyDirty&&!e.$v.edit.transDate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date"},model:{value:e.edit.refundDate,callback:function(t){e.$set(e.edit,"refundDate",t)},expression:"edit.refundDate"}}),e.$v.edit.$anyDirty&&!e.$v.edit.refundDate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Particular:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.edit.amount,callback:function(t){e.$set(e.edit,"amount",t)},expression:"edit.amount"}}),e.$v.edit.$anyDirty&&!e.$v.edit.amount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.amount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.edit.particular,callback:function(t){e.$set(e.edit,"particular",t)},expression:"edit.particular"}})],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Issue:")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Chart of Accounts:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.issue,expression:"edit.issue"}],attrs:{rows:"4",cols:"59",id:"inputStyle"},domProps:{value:e.edit.issue},on:{input:function(t){t.target.composing||e.$set(e.edit,"issue",t.target.value)}}})]),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.coas,reduce:function(e){return e.accountId},label:"account",clearable:!1},model:{value:e.edit.coa,callback:function(t){e.$set(e.edit,"coa",t)},expression:"edit.coa"}}),e.$v.edit.$anyDirty&&!e.$v.edit.coa.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Business Types:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.businessTypes,reduce:function(e){return e.businessTypeId},label:"type",clearable:!1},model:{value:e.edit.businessType,callback:function(t){e.$set(e.edit,"businessType",t)},expression:"edit.businessType"}}),e.$v.edit.$anyDirty&&!e.$v.edit.businessType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])])],1)])],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"col-sm-6"},[a("b",[e._v("REFUND DISBURSEMENT")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Received Payment by : ")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Certified by : ")])]),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Approved by : ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"col-sm-6"},[a("b",[e._v("REFUND DISBURSEMENT")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Received Payment by : ")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Certified by : ")])]),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Approved by : ")])])])}],n=(a("4160"),a("fb6a"),a("b0c0"),a("b680"),a("d3b7"),a("25f0"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),o=a("56d7"),l=a("b5ae"),c=a("4627"),d=a("add5"),u=a.n(d),m=a("2f62"),p=l["helpers"].regex("alphaNumAndDot",/^[ 0-9 ., ]*$/),b=l["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),f=a("c1df"),v=a("e966"),h=v.bindWith(",","."),C=new Date,w=a("9f25"),g={components:{},data:function(){return{columns:[{label:"Voucher No.",field:"voucherNumber"},{label:"Transaction Date",field:"transactionDate"},{label:"Amount",field:"amount"},{label:"Refund Date",field:"refundDate"},{label:"Created by",field:"userReference"},{label:"Status",field:"status"},{label:"",field:"action",width:"100px",sortable:!1}],loading:!0,refundDisbursements:[],requestProcessing:!1,views:[{limitId:"30",limit:"30 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"30",filters:[{filterId:"month",filter:"Month"}],filter:"month",dateCreated:f().format("YYYY-MM"),maxDate:f().format("YYYY-MM"),listType:"",newType:"",banks:[],bankAccounts:[],paymentTypes:[{type:"Cash"},{type:"Check"}],coas:[],businessTypes:[],newTransDate:f().format("YYYY-MM-DD"),newRefundDate:f().format("YYYY-MM-DD"),newAmount:"",newParticular:"",newIssue:"",newCOA:"",newBusinessType:"",view:{voucherNumber:"",amount:"",transactionDate:"",refundDate:"",particular:"",issue:"",coa:"",businessTypes:""},attachment:"",attachmentData:null,attachments:[],rdId:"",uploadValue:0,loadAttachment:!0,edit:{id:"",rdId:"",transDate:"",refundDate:"",amount:"",particular:"",issue:"",coa:"",businessType:""},userRole:"",user:{firstname:"",lastname:""},breakCounts:18}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUserRole(),e.getRefundDisbursements("Release"),e.getChartOfAccounts(),e.getBusinessTypes(),e.getUser();case 5:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(m["b"])({users:"Users/users"})),validations:{newTransDate:{required:l["required"]},newRefundDate:{required:l["required"]},newAmount:{required:l["required"],amountCustomValidator:p},newCOA:{required:l["required"]},newBusinessType:{required:l["required"]},edit:{transDate:{required:l["required"]},refundDate:{required:l["required"]},amount:{required:l["required"],amountCustomValidator:p},coa:{required:l["required"]},businessType:{required:l["required"]}},newPercent:{required:l["required"],numCustomValidator:b},newTerms:{required:l["required"],numCustomValidator:b},editLoan:{percent:{required:l["required"],numCustomValidator:b},terms:{required:l["required"],numCustomValidator:b}}},methods:{getUserRole:function(){var e=this;e.username=localStorage.getItem("aisname"),e.accountName=e.username.toUpperCase();var t=o["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||t.forEach((function(e){a.push(e.data())}));var s=o["dbUsers"].collection("userRoles").where("userRoleId","==",a[0].userRoleReference),r=[];s.get().then((function(t){t.empty||(t.forEach((function(e){r.push(e.data())})),e.userRole=r[0].userRole)}))}))},getUser:function(){var e=this;e.username=localStorage.getItem("aisname");var t=o["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||(t.forEach((function(e){a.push(e.data())})),e.user.firstname=a[0].firstname,e.user.lastname=a[0].lastname)}))},getBankAccounts:function(e){var t=this,a=o["dbMains"].collection("bankAccounts").where("bankReference","==",e).orderBy("bankAccountNumber","asc");t.bankAccounts=[],a.get().then((function(e){e.forEach((function(e){t.bankAccounts.push(e.data())})),t.newBankAccount=t.bankAccounts[0].bankAccountUid}))},getChartOfAccounts:function(){var e=this,t=o["dbMains"].collection("chartOfAccounts").orderBy("account","asc");e.coas=[],t.get().then((function(t){t.forEach((function(t){e.coas.push(t.data())})),e.newCOA=e.coas[0].accountId}))},getBusinessTypes:function(){var e=this,t=o["dbMains"].collection("businessTypes").orderBy("type","asc");e.businessTypes=[],t.get().then((function(t){t.forEach((function(t){e.businessTypes.push(t.data())})),e.newBusinessType=e.businessTypes[0].businessTypeId}))},newRefundDisbursement:function(){var e=this;if(e.$v.newTransDate.$touch(),e.$v.newRefundDate.$touch(),e.$v.newAmount.$touch(),e.$v.newCOA.$touch(),e.$v.newBusinessType.$touch(),!e.$v.newTransDate.$error&&!e.$v.newRefundDate.$error&&!e.$v.newAmount.$error&&!e.$v.newCOA.$error&&!e.$v.newBusinessType.$error){e.requestProcessing=!0;try{var t=o["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),a=[],s="RDI-"+C.getFullYear()+w(C.getMonth()+1,2)+C.getDate()+"-"+Math.floor(1e6*Math.random()),r=o["dbUsers"].collection("refundDisbursements").orderBy("dateCreated","desc").limit(1),n="";r.get().then((function(r){r.forEach((function(e){e.exists&&(n=e.data().voucherNumber)}));var i="",l=new Date;""!=n?(i=w(parseInt(n.slice(7))+1,4),"1000"==i.toString()&&(i="0001")):i="0001",t.get().then((function(t){t.forEach((function(e){a.push(e.data())})),o["dbUsers"].collection("refundDisbursements").doc().set({refundDisbursementId:s,transactionDate:e.newTransDate,refundDate:e.newRefundDate,amount:e.newAmount,particular:e.newParticular,issue:e.newIssue,voucherNumber:w(l.getMonth()+1)+""+l.getFullYear().toString().slice(2,4)+"-3"+i,accountReference:e.newCOA,businessTypeReference:e.newBusinessType,status:1,userReference:a[0].userId,dateCreated:C,dateModified:C}).then((function(){e.$swal({title:"Success",text:"New refund disbursement added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.newTransDate=f().format("YYYY-MM-DD"),e.newRefundDate=f().format("YYYY-MM-DD"),e.newAmount="",e.newParticular="",e.newIssue="",e.newCOA="",e.newBusinessType="",e.requestProcessing=!1,e.$v.newTransDate.$reset(),e.$v.newRefundDate.$reset(),e.$v.newAmount.$reset(),e.$v.newCOA.$reset(),e.$v.newBusinessType.$reset(),e.$bvModal.hide("new-refund-disbursement-modal"),e.$refs["refund-disbursement-table"].reset(),e.getChartOfAccounts(),e.getBusinessTypes(),e.getRefundDisbursements(e.listType)}))}))}))}))}catch(i){console.log(i),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}},getRefundDisbursements:function(e){var t=this,a=null,s=[],r=[],n=f(t.dateCreated).startOf("month").format("YYYY-MM-DD"),i=f(t.dateCreated).endOf("month").format("YYYY-MM-DD");t.username=localStorage.getItem("aisname"),t.accountName=t.username.toUpperCase();var l=o["dbUsers"].collection("users").where("username","==",t.username),c=[],d="",u="";l.get().then((function(l){l.forEach((function(e){c.push(e.data())})),u=c[0].userId;var m=o["dbUsers"].collection("userRoles").where("userRoleId","==",c[0].userRoleReference),p=[];m.get().then((function(l){l.forEach((function(e){p.push(e.data())})),d=p[0].userRole,t.loading=!0,t.refundDisbursements=[],t.listType=e,"Administrator"==d||"Manager"==d?"Release"==e?"all"!=t.limit?a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("status","==",1).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("status","==",1)):"Cleared"==e?"all"!=t.limit?a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("status","==",2).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("status","==",2)):"All"==e&&("all"!=t.limit?a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i))):"User"==d&&("Release"==e?"all"!=t.limit?a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).where("status","==",1).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).where("status","==",1)):"Cleared"==e?"all"!=t.limit?a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).where("status","==",2).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).where("status","==",2)):"All"==e&&("all"!=t.limit?a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("refundDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u)))),a.get().then((function(e){if(!e.empty){e.forEach((function(e){r.push(e.data()),s.push(e.id)}));var a=o["dbMains"].collection("chartOfAccounts"),n=o["dbMains"].collection("businessTypes"),i=[],l=[];a.get().then((function(e){e.forEach((function(e){i.push(e.data())})),n.get().then((function(e){e.forEach((function(e){l.push(e.data())}));for(var a=0;a<r.length;a++){r[a]["id"]=s[a],r[a]["coa"]="",r[a]["businessType"]="",r[a].amount=h(parseFloat(r[a].amount.replaceAll(",","")).toFixed(2)),t.refundDisbursements.push(r[a]);for(var n=0;n<i.length;n++)i[n].accountId==r[a].accountReference&&(r[a].coa=i[n].account);for(var o=0;o<l.length;o++)l[o].businessTypeId==r[a].businessTypeReference&&(r[a].businessType=l[o].type)}}))}))}setTimeout((function(){t.loading=!1}),1e3)}))}))}))},openViewRefundDisbursementModal:function(e){var t=this;t.view={voucherNumber:e.voucherNumber,amount:e.amount,transactionDate:e.transactionDate,refundDate:e.refundDate,particular:e.particular,issue:e.issue,coa:e.coa,businessType:e.businessType},t.$bvModal.show("view-refund-disbursement-modal")},openAttachments:function(e){this.rdId=e.refundDisbursementId,this.attachmentStatus=e.status,this.$bvModal.show("attachment-modal"),this.getAttachments(this.rdId)},addAttachments:function(){this.$refs.attachmentFile.click()},previewImage:function(e){var t=this,a={maxSizeMB:1,useWebWorker:!0};t.uploadValue=0,t.attachment=null,t.attachments=[],t.attachmentData=e.target.files[0],Object(c["a"])(t.attachmentData,a).then((function(e){t.attachmentData=e,t.onUpload(t.attachmentData)}))},onUpload:function(e){var t=this,a=o["storageMains"].ref("refundDisbursements/"+t.rdId+"/"+e.name).put(e);t.requestProcessing=!1;try{t.attachment=null,t.requestProcessing=!0,a.on("state_changed",(function(e){t.uploadValue=e.bytesTransferred/e.totalBytes*100}),(function(e){console.log(e.message)}),(function(){t.uploadValue=100,t.$swal({title:"Success",text:"Attachment uploaded successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),t.requestProcessing=!1,t.getAttachments(t.rdId)}))}catch(s){console.log("error"),t.requestProcessing=!1,t.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#f5365c",confirmButtonText:"OK"})}},getAttachments:function(e){var t=this,a=0,s=o["storageMains"].ref("refundDisbursements/"+e);t.loadAttachment=!0,t.attachments=[],s.listAll().then((function(s){s.items.forEach((function(s){o["storageMains"].ref("refundDisbursements/"+e+"/"+s.name).getDownloadURL().then((function(e){a+=1,t.attachments.push({rowNum:a,name:s.name,url:e,path:s.fullPath,status:1})}))}))})).catch((function(e){console.log(e)})),setTimeout((function(){t.loadAttachment=!1}),5e3)},removeAttachment:function(e){var t=this;t.$swal({title:"Are you sure?",text:"You want to remove this attachment?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM",cancelButtonText:"CANCEL"}).then((function(a){if(a.value){var s=o["storageMains"].ref("refundDisbursements/"+t.rdId+"/"+e);try{s.delete().then((function(){t.$swal({title:"Success",text:"Attachment remove successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){t.getAttachments(t.rdId)}))}))}catch(r){console.log(r),t.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#f5365c",confirmButtonText:"OK"})}}}))},openUpdateRDModal:function(e){var t=this;t.edit={id:e.id,rdId:e.refundDisbursementId,transDate:e.transactionDate,refundDate:e.refundDate,amount:e.amount,particular:e.particular,issue:e.issue,coa:e.accountReference,businessType:e.businessTypeReference},t.$bvModal.show("edit-refund-disbursement-modal")},updateRefundDisbursement:function(){var e=this;if(e.$v.edit.$touch(),!e.$v.edit.$error){e.requestProcessing=!0;try{o["dbUsers"].collection("refundDisbursements").doc(e.edit.id).update({transactionDate:e.edit.transDate,refundDate:e.edit.refundDate,amount:e.edit.amount,particular:e.edit.particular,issue:e.edit.issue,accountReference:e.edit.coa,businessTypeReference:e.edit.businessType,dateModified:C}).then((function(){e.edit={id:"",rdId:"",transDate:"",refundDate:"",amount:"",particular:"",issue:"",coa:"",businessType:""},e.requestProcessing=!1,e.$v.edit.$reset(),e.$bvModal.hide("edit-refund-disbursement-modal"),e.$refs["refund-disbursement-table"].reset(),e.getRefundDisbursements(e.listType),e.$swal({title:"Success",text:"Refund disbursement updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}},changeStatus:function(e,t){var a=this,s="";1==t?s="Release":2==t&&(s="Cleared"),a.$swal({title:"Are you sure?",text:"You want to change the status to "+s,icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(r){r.value&&o["dbUsers"].collection("refundDisbursements").doc(e.id).update({status:t,dateModified:C}).then((function(){a.$refs["refund-disbursement-table"].reset(),a.getRefundDisbursements(s),a.$swal({title:"Success",text:"Refund disbursement status change successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}))},printRefundDisbursement:function(){this.$swal({title:"Print with duplicate?",text:"",icon:"question",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#f5c71a",confirmButtonText:"YES",cancelButtonText:"NO"}).then((function(e){e.value?u()({printable:"duplicateView",type:"html",style:'#duplicateView {font-family: "Calibri";} #borderStyle {border-width: 1px; border-style: solid;} #docStyle {display: block; overflow: inherit; white-space: normal; font-size: 12px;}',documentTitle:"Refund Disbursement Voucher"}):u()({printable:"singleView",type:"html",style:'#singleView {font-family: "Calibri";} #borderStyle {border-width: 1px; border-style: solid;} #docStyle {display: block; overflow: inherit; white-space: normal; font-size: 12px;}',documentTitle:"Refund Disbursement Voucher"})}))}}},y=g,_=(a("5279"),a("2877")),k=Object(_["a"])(y,s,r,!1,null,null,null);t["default"]=k.exports},"86ec":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"textStyle"}},[a("base-header",{staticClass:"header pb-8 pt-3 pt-lg-6 d-flex align-items-center",style:e.buildImageUrl},[a("span",{staticClass:"mask opacity-7",attrs:{id:"mainBg"}}),a("div",{staticClass:"container-fluid d-flex align-items-center"},[a("div",{staticClass:"row pt-2"},[a("div",{staticClass:"col-md-12 pt-2"},[a("p",{staticClass:"text-white pt-2",staticStyle:{"font-size":"18px"}},[a("b",[e._v("All the time saving tools you need to grow to your business")])]),a("br"),a("p",{staticClass:"text-white pt-0 mb-0",staticStyle:{"font-size":"18px"}},[a("b",[e._v("Billing Statements")])]),a("p",{staticClass:"text-white pt-0 mb-0",staticStyle:{"text-indent":"50px","font-size":"18px"}},[a("b",[e._v("Manage recurring billings and easily track payments.")])]),a("p",{staticClass:"text-white pt-0 mb-0",staticStyle:{"font-size":"18px"}},[a("b",[e._v("Technical Service Collections")])]),a("p",{staticClass:"text-white pt-0 mb-0",staticStyle:{"text-indent":"50px","font-size":"18px"}},[a("b",[e._v("Manage technical services collections.")])])])])])]),e._m(0)],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid mt--7 pb-8"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-xl-4 order-xl-2 mb-5 mb-xl-0"}),a("div",{staticClass:"col-xl-8 order-xl-1"})])])}],n=(a("4160"),a("d3b7"),a("25f0"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o={data:function(){return{username:"",userRole:"",accountName:"",bgImage:["img/theme/mainImageI.jpg"],imageUrl:""}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUserRole(),e.changeImage();case 2:case"end":return t.stop()}}),t)})))()},computed:{buildImageUrl:function(){return"min-height: 550px; background-image: url("+this.imageUrl+"); background-size: cover; background-position: center top;"}},methods:{getUserRole:function(){var e=this;e.username=localStorage.getItem("aisname");var t=i["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||t.forEach((function(e){a.push(e.data())})),e.accountName=a[0].firstname;var s=i["dbUsers"].collection("userRoles").where("userRoleId","==",a[0].userRoleReference),r=[];s.get().then((function(t){t.empty||(t.forEach((function(e){r.push(e.data())})),e.userRole=r[0].userRole)}))}))},changeImage:function(){var e=Math.floor(Math.random()*this.bgImage.length);this.imageUrl=this.bgImage[e].toString()}}},l=o,c=(a("007b"),a("2877")),d=Object(c["a"])(l,s,r,!1,null,null,null);t["default"]=d.exports},9263:function(e,t,a){"use strict";var s=a("ad6d"),r=a("9f7f"),n=RegExp.prototype.exec,i=String.prototype.replace,o=n,l=function(){var e=/a/,t=/b*/g;return n.call(e,"a"),n.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),c=r.UNSUPPORTED_Y||r.BROKEN_CARET,d=void 0!==/()??/.exec("")[1],u=l||d||c;u&&(o=function(e){var t,a,r,o,u=this,m=c&&u.sticky,p=s.call(u),b=u.source,f=0,v=e;return m&&(p=p.replace("y",""),-1===p.indexOf("g")&&(p+="g"),v=String(e).slice(u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==e[u.lastIndex-1])&&(b="(?: "+b+")",v=" "+v,f++),a=new RegExp("^(?:"+b+")",p)),d&&(a=new RegExp("^"+b+"$(?!\\s)",p)),l&&(t=u.lastIndex),r=n.call(m?a:u,v),m?r?(r.input=r.input.slice(f),r[0]=r[0].slice(f),r.index=u.lastIndex,u.lastIndex+=r[0].length):u.lastIndex=0:l&&r&&(u.lastIndex=u.global?r.index+r[0].length:t),d&&r&&r.length>1&&i.call(r[0],a,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)})),r}),e.exports=o},"976e":function(e,t,a){"use strict";a("dc90")},"9aff":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pt-4",attrs:{id:"textStyle"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left ml-1 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-2 pointer"},[1==e.seriesStat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getORSeries(1)}}},[e._v("Enabled")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},[0==e.seriesStat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getORSeries(0)}}},[e._v("Disabled")])])],1)]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{ref:"or-series-table",attrs:{columns:e.columns,rows:e.orSeries,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["startNumber"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.startNumber))])]):e._e(),"endNumber"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.endNumber))])]):e._e(),"action"==t.column.field?a("span",[1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Edit"},on:{click:function(a){return e.openEditORSeriesModal(t.row)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-times-circle",attrs:{id:"sideBarTxt",title:"Disable"},on:{click:function(a){return e.changeStatus(t.row.id,0,"Disable")}}}):e._e(),0==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-check-circle",attrs:{id:"sideBarTxt",title:"Enable"},on:{click:function(a){return e.changeStatus(t.row.id,1,"Enable")}}}):e._e()]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.orSeries.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getORSeries(e.seriesStat)}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-or-series-modal",modifiers:{"new-or-series-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Official Receipt Series")])],1)]),a("b-modal",{attrs:{size:"lg",id:"new-or-series-modal",title:"New Official Receipt Series",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addORSeries(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-or-series-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Start Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("End Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Start Number"},model:{value:e.newStartNumber,callback:function(t){e.newStartNumber=t},expression:"newStartNumber"}}),e.$v.newStartNumber.$anyDirty&&!e.$v.newStartNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newStartNumber.$anyDirty&&!e.$v.newStartNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"End Number"},model:{value:e.newEndNumber,callback:function(t){e.newEndNumber=t},expression:"newEndNumber"}}),e.$v.newEndNumber.$anyDirty&&!e.$v.newEndNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newEndNumber.$anyDirty&&!e.$v.newEndNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"edit-or-series-modal",title:"Edit Official Receipt Series",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateORSeries(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-or-series-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Start Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("End Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Start Number"},model:{value:e.edit.startNumber,callback:function(t){e.$set(e.edit,"startNumber",t)},expression:"edit.startNumber"}}),e.$v.edit.$anyDirty&&!e.$v.edit.startNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.startNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"End Number"},model:{value:e.edit.endNumber,callback:function(t){e.$set(e.edit,"endNumber",t)},expression:"edit.endNumber"}}),e.$v.edit.$anyDirty&&!e.$v.edit.endNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.endNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])])],1)],1)},r=[],n=(a("4160"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=o["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),c=new Date,d=a("9f25"),u={components:{},data:function(){return{columns:[{label:"Start Number",field:"startNumber"},{label:"End Number",field:"endNumber"},{label:"",field:"action",sortable:!1,width:"100px"}],loading:!0,orSeries:[],views:[{limitId:"20",limit:"20 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"20",requestProcessing:!1,newStartNumber:"",newEndNumber:"",edit:{id:"",seriesId:"",startNumber:"",endNumber:""},seriesStat:1}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=i["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=i["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Manager"!=s[0].userRole&&"Administrator"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getORSeries(e.seriesStat);case 1:case"end":return t.stop()}}),t)})))()},validations:{newStartNumber:{required:o["required"],numCustomValidator:l},newEndNumber:{required:o["required"],numCustomValidator:l},edit:{startNumber:{required:o["required"],numCustomValidator:l},endNumber:{required:o["required"],numCustomValidator:l}}},methods:{addORSeries:function(){var e=this;if(e.$v.newStartNumber.$touch(),e.$v.newEndNumber.$touch(),!e.$v.newStartNumber.$error&&!e.$v.newEndNumber.$error)if(e.requestProcessing=!0,e.newEndNumber<=e.newStartNumber)e.$swal({title:"Invalid",text:"End Number is less than or equal to Start Number.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1;else{var t=i["dbSales"].collection("officialReceiptSeries").where("startNumber","==",e.newStartNumber).where("endNumber","==",e.newEndNumber).where("status","==",1);t.get().then((function(t){if(t.empty){if(t){var a=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),s=[],r="ORSI-"+c.getFullYear()+d(c.getMonth()+1,2)+c.getDate()+"-"+Math.floor(1e6*Math.random());a.get().then((function(t){t.forEach((function(e){e.exists&&s.push(e.data())}));try{i["dbSales"].collection("officialReceiptSeries").doc().set({orSeriesId:r,startNumber:e.newStartNumber,endNumber:e.newEndNumber,current:"",userReference:s[0].userId,status:1,dateCreated:c,dateModified:c}).then((function(){e.newStartNumber="",e.newEndNumber="",e.requestProcessing=!1,e.$v.newStartNumber.$reset(),e.$v.newEndNumber.$reset(),e.$refs["or-series-table"].reset(),e.getORSeries(e.seriesStat),e.$bvModal.hide("new-or-series-modal"),e.$swal({title:"Success",text:"New official receipt series added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}))}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Officil receipt series already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},getORSeries:function(e){var t=this,a=null,s=[],r=[];t.loading=!0,t.orSeries=[],t.seriesStat=e,"all"!=t.limit?a=i["dbSales"].collection("officialReceiptSeries").where("status","==",e).orderBy("startNumber","asc").limit(t.limit):"all"==t.limit&&(a=i["dbSales"].collection("officialReceiptSeries").where("status","==",e).orderBy("startNumber","asc")),a.get().then((function(e){if(!e.empty){e.forEach((function(e){s.push(e.data()),r.push(e.id)}));for(var a=0;a<s.length;a++)s[a]["id"]=r[a],t.orSeries.push(s[a])}setTimeout((function(){t.loading=!1}),1e3)}))},openEditORSeriesModal:function(e){this.edit={id:e.id,seriesId:e.orSeriesId,startNumber:e.startNumber,endNumber:e.endNumber},this.$bvModal.show("edit-or-series-modal")},updateORSeries:function(){var e=this;if(e.$v.edit.$touch(),!e.$v.edit.$error)if(e.requestProcessing=!0,e.edit.endNumber<=e.edit.startNumber)e.$swal({title:"Invalid",text:"End Number is less than or equal to Start Number.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1;else{var t=i["dbSales"].collection("officialReceiptSeries").where("startNumber","==",e.edit.startNumber).where("endNumber","==",e.edit.endNumber).where("status","==",1).where("orSeriesId","!=",e.edit.seriesId);t.get().then((function(t){if(t.empty){if(t)try{i["dbSales"].collection("officialReceiptSeries").doc(e.edit.id).update({startNumber:e.edit.startNumber,endNumber:e.edit.endNumber,dateModified:c}).then((function(){e.$v.edit.$reset(),e.$bvModal.hide("edit-or-series-modal"),e.requestProcessing=!1,e.$refs["or-series-table"].reset(),e.getORSeries(e.seriesStat),e.$swal({title:"Success",text:"Billing statement series updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Official Receipt series already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},changeStatus:function(e,t,a){var s=this;s.$swal({title:"Are you sure?",text:"You want to change the status to "+a,icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(r){if(r.value)try{i["dbSales"].collection("officialReceiptSeries").doc(e).update({status:t,dateModified:c}).then((function(){s.$swal({title:"Success",text:"Official receipt series type status to "+a+".",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){s.$refs["or-series-table"].reset(),s.getORSeries(t)}))}))}catch(n){console.log(n),s.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}))}}},m=u,p=(a("59b1"),a("2877")),b=Object(p["a"])(m,s,r,!1,null,null,null);t["default"]=b.exports},"9f7f":function(e,t,a){"use strict";var s=a("d039");function r(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=s((function(){var e=r("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=s((function(){var e=r("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},a28f:function(e,t,a){"use strict";a("f8ae")},a40e:function(e,t,a){"use strict";a("2ca1")},a51f:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"textStyle"}},[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-4 text-left ml-2 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-5 pointer"},[a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"sideBarTxt"},on:{click:function(t){return e.getPaginatedBankChecks(1,"","Used")}}},[e._v("Used")])]),a("badge",{staticClass:"badge-dot ml-5 pointer"},[a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"sideBarTxt"},on:{click:function(t){return e.getPaginatedBankChecks(1,"","Cancelled")}}},[e._v("Cancelled")])]),a("badge",{staticClass:"badge-dot ml-5 pointer"},[a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"sideBarTxt"},on:{click:function(t){return e.getPaginatedBankChecks(1,"","All")}}},[e._v("All")])])],1),a("span",{staticClass:"col-2 pt-3 pl-5 text-right"},[a("b",[e._v("Filter by:")])]),a("span",{staticClass:"col-sm-3 pt-2 text-right"},[a("v-select",{staticStyle:{width:"230px"},attrs:{id:"inputStyle",options:e.filters,reduce:function(e){return e.filterId},label:"filter",clearable:!1},on:{input:function(t){return e.reloadData()}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),a("span",{staticClass:"col-sm-2 pl-0"},["dateCreated"==e.filter?a("base-input",{staticClass:"pt-2",staticStyle:{width:"200px"},attrs:{type:"month",max:e.maxDate,min:"1997-01",id:"inputStyle"},on:{input:function(t){return e.reloadData()}},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}}):e._e(),"checkDate"==e.filter?a("base-input",{staticClass:"pt-2",staticStyle:{width:"200px"},attrs:{type:"month",min:"1997-01",id:"inputStyle"},on:{input:function(t){return e.reloadData()}},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}}):e._e(),"bank"==e.filter?a("v-select",{staticClass:"pt-2",staticStyle:{width:"230px"},attrs:{id:"inputStyle",options:e.banks,reduce:function(e){return e.bankUid},label:"bank",clearable:!1},on:{input:function(t){return e.reloadData()}},model:{value:e.bank,callback:function(t){e.bank=t},expression:"bank"}}):e._e(),"bankAccount"==e.filter?a("v-select",{staticClass:"pt-2",staticStyle:{width:"230px"},attrs:{id:"inputStyle",options:e.bankAccounts,reduce:function(e){return e.bankAccountUid},label:"account",clearable:!1},on:{input:function(t){return e.reloadData()}},model:{value:e.bankAccount,callback:function(t){e.bankAccount=t},expression:"bankAccount"}}):e._e()],1)]),a("div",{staticClass:"input-group table-search pt-2 pb-2 pl-2 pr-2"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],staticClass:"form-control",attrs:{type:"text",name:"search",placeholder:"Search Voucher Number"},domProps:{value:e.searchTerm},on:{input:[function(t){t.target.composing||(e.searchTerm=t.target.value)},e.resetData],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}}}),e.searching?a("span",{staticClass:"input-group-append",on:{click:e.reloadData}},[a("base-button",{attrs:{id:"closeBtn",icon:"fa fa-window-close"}})],1):a("span",{staticClass:"input-group-append",on:{click:e.search}},[a("base-button",{staticClass:"text-light",attrs:{id:"srchBtn",icon:"fa fa-search"}})],1)]),a("div",{staticClass:"table-full-width"},[a("paper-table",{attrs:{type:"hover",id:"textStyle",loading:e.loading,loadError:e.loadError,title:e.bankCheckTable.title,placeholder:"Search Bank Check Number..","sub-title":e.bankCheckTable.subTitle,data:e.bankChecks,columns:e.bankCheckTable.columns,search:!0},on:{reloadData:e.reloadData},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("td",[e._v(e._s(s.rowNum))]),a("td",[e._v(e._s(s.voucherNumber))]),a("td",e._l(e.suppliers,(function(t){return a("span",{key:t.supplierId},[t.supplierId==s.payeeReference?a("span",[e._v(e._s(t.supplier))]):e._e()])})),0),a("td",e._l(e.banks,(function(t){return a("span",{key:t.bankUid},[t.bankUid==s.bankReference?a("span",[e._v(e._s(t.bank))]):e._e()])})),0),a("td",e._l(e.bankAccounts,(function(t){return a("span",{key:t.bankAccountUid},[t.bankAccountUid==s.bankAccountReference?a("span",[e._v(e._s(t.bankAccountNumber))]):e._e()])})),0),a("td",[e._v("â‚± "+e._s(s.bankCheckAmount))]),a("td",{staticClass:"tableSpan"},[e._v(e._s(e._f("moment")(s.voucherDate,"MMM DD, YYYY")))]),a("td",{attrs:{align:"right"}},[3==s.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(t){return e.openUpdateCheckModal(s)}}}):e._e(),0!=s.status?a("router-link",{staticClass:"pointer ml-2 fa fa-print",attrs:{to:"/check/voucher/"+s.bankCheckUid+"/voucher",id:"sideBarTxt",title:"View Print Page"}}):e._e(),0==s.status?a("span",{attrs:{id:"redTxt"}},[e._v("CANCELLED")]):e._e()],1)]}}])})],1),a("hr"),!e.loading&&e.bankChecks.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-3"},[a("span",{staticClass:"pagination-results"},[e._v(e._s(e.bankChecks[e.bankChecks.length-1].rowNum)+" of "+e._s(e.bankChecksCount))])]),a("span",{staticClass:"col-2 pt-2 text-right"},[a("b",[e._v("Limit to:")])]),a("span",{staticClass:"col-sm-3"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getPaginatedBankChecks(1,"",e.listType)}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1),a("pagination",{attrs:{searching:e.searching,searchTotalPage:e.bankChecks,totalPages:e.bankChecksCount,currentPage:e.currentPage},on:{pagechanged:e.onPageChange}})],1):e._e(),a("b-modal",{attrs:{size:"lg",id:"update-check-modal",title:"Update Check",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100 mt-0"},[a("div",{staticClass:"text-left pl-5"},[a("h2",{staticClass:"display-5",attrs:{id:"sideBarTxt"}},[e._v("Particulars")])]),a("div",{staticClass:"table-full-width pb-5 pl-5 pr-5 pt-2"},[a("paper-table",{attrs:{type:"hover",loading:e.loading,loadError:e.loadError,title:e.particularsTable.title,"sub-title":e.particularsTable.subTitle,data:e.particulars,columns:e.particularsTable.columns},on:{reloadData:e.reloadData},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("td",[e._v(e._s(s.rowNum))]),a("td",[a("span",{attrs:{id:"particular"}},[e._v(e._s(s.particular))])]),a("td",[e._v(e._s(s.referenceNumber))]),a("td",[e._v("â‚± "+e._s(s.particularAmount))]),a("td",{attrs:{align:"right"}},[""!=s.rowNum&&"Administrator"==e.userRole?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Edit"},on:{click:function(t){return e.openEditParticularModal(s)}}}):e._e(),""!=s.rowNum&&"Administrator"==e.userRole?a("span",{staticClass:"pointer ml-2 far fa-times-circle",attrs:{id:"sideBarTxt",title:"Remove"},on:{click:function(t){return e.removeParticular(s)}}}):e._e()])]}}])})],1),a("div",{staticClass:"text-right pr-5"},["Administrator"==e.userRole?a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.show("add-particular-modal")}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add Particular ")]):e._e(),a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateCheck(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("update-check-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0 pl-5 pr-5"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Remarks:")])])]),a("div",{staticClass:"form-group row mb-0 pl-5 pr-5"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.desc,expression:"edit.desc"}],staticClass:"pl-3 pr-3 pt-2 pb-2",attrs:{rows:"4",cols:"80",id:"inputStyle",placeholder:"Description"},domProps:{value:e.edit.desc},on:{input:function(t){t.target.composing||e.$set(e.edit,"desc",t.target.value)}}})])]),a("hr")]),a("b-modal",{attrs:{size:"lg",id:"add-particular-modal",title:"Add Particular",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addParticular(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("add-particular-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 pl-4 col-form-label"},[a("b",[e._v("Particular:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-3 pl-4 col-form-label"},[a("b",[e._v("Reference Number:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Particular"},model:{value:e.newParticular,callback:function(t){e.newParticular=t},expression:"newParticular"}}),e.$v.newParticular.$anyDirty&&!e.$v.newParticular.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Reference Number"},model:{value:e.newReferenceNumber,callback:function(t){e.newReferenceNumber=t},expression:"newReferenceNumber"}}),e.$v.newReferenceNumber.$anyDirty&&!e.$v.newReferenceNumber.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 pl-4 col-form-label"},[a("b",[e._v("Unit Price:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-3 pl-4 col-form-label"},[a("b",[e._v("Quantity:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Unit Price"},on:{input:function(t){return e.computeAmount(e.newUnitPrice,e.newQuantity,"add")}},model:{value:e.newUnitPrice,callback:function(t){e.newUnitPrice=t},expression:"newUnitPrice"}}),e.$v.newUnitPrice.$anyDirty&&!e.$v.newUnitPrice.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e(),e.$v.newUnitPrice.$anyDirty&&!e.$v.newUnitPrice.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Quantity"},on:{input:function(t){return e.computeAmount(e.newUnitPrice,e.newQuantity,"add")}},model:{value:e.newQuantity,callback:function(t){e.newQuantity=t},expression:"newQuantity"}}),e.$v.newQuantity.$anyDirty&&!e.$v.newQuantity.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e(),e.$v.newQuantity.$anyDirty&&!e.$v.newQuantity.numCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 pl-4 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Amount",readonly:""},model:{value:e.newAmount,callback:function(t){e.newAmount=t},expression:"newAmount"}}),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e(),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"update-particular-modal",title:"Update Particular",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateParticular(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v("Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("update-particular-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 pl-4 col-form-label"},[a("b",[e._v("Particular:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-3 pl-4 col-form-label"},[a("b",[e._v("Reference Number:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Particular"},model:{value:e.edit.particular,callback:function(t){e.$set(e.edit,"particular",t)},expression:"edit.particular"}}),e.$v.edit.particular.$anyDirty&&!e.$v.edit.particular.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Reference Number"},model:{value:e.edit.referenceNumber,callback:function(t){e.$set(e.edit,"referenceNumber",t)},expression:"edit.referenceNumber"}}),e.$v.edit.referenceNumber.$anyDirty&&!e.$v.edit.referenceNumber.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 pl-4 col-form-label"},[a("b",[e._v("Unit Price:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-3 pl-4 col-form-label"},[a("b",[e._v("Quantity:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Unit Price"},on:{input:function(t){return e.computeAmount(e.edit.unitPrice,e.edit.quantity,"edit")}},model:{value:e.edit.unitPrice,callback:function(t){e.$set(e.edit,"unitPrice",t)},expression:"edit.unitPrice"}}),e.$v.edit.unitPrice.$anyDirty&&!e.$v.edit.unitPrice.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e(),e.$v.edit.unitPrice.$anyDirty&&!e.$v.edit.unitPrice.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Quantity"},on:{input:function(t){return e.computeAmount(e.edit.unitPrice,e.edit.quantity,"edit")}},model:{value:e.edit.quantity,callback:function(t){e.$set(e.edit,"quantity",t)},expression:"edit.quantity"}}),e.$v.edit.quantity.$anyDirty&&!e.$v.edit.quantity.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e(),e.$v.edit.quantity.$anyDirty&&!e.$v.edit.quantity.numCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 pl-4 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Amount",readonly:""},model:{value:e.edit.amount,callback:function(t){e.$set(e.edit,"amount",t)},expression:"edit.amount"}}),e.$v.edit.amount.$anyDirty&&!e.$v.edit.amount.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e(),e.$v.edit.amount.$anyDirty&&!e.$v.edit.amount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])])],1)],1)],1)},r=[],n=(a("a4d3"),a("e01a"),a("99af"),a("4de4"),a("4160"),a("b680"),a("d3b7"),a("25f0"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=["#","Voucher No.","Payee","Bank","Account No.","Amount","Voucher Date","Actions"],c=["#","Particular","Reference Number","Amount","Actions"],d=a("c1df"),u=a("e966"),m=u.bindWith(",","."),p=new Date,b=o["helpers"].regex("alphaNumAndDot",/^[ A-Za-z0-9 -./, ]*$/),f=o["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),v=o["helpers"].regex("alphaNumAndDot",/^[ 0-9â‚± ,. ]*$/),h=a("9f25"),C={components:{},data:function(){return{loading:!0,loadError:!1,bankCheckTable:{title:"Bank Checks Table",subTitle:"",columns:[].concat(l)},particularsTable:{title:"Particulars Table",subTitle:"",columns:[].concat(c)},bankChecksCount:0,bankChecks:[],banks:[],activateBanks:[],bankAccounts:[],activateBankAccounts:[],particulars:[],currentPage:1,searchTerm:"",searching:!1,requestProcessing:!1,views:[{limitId:"30",limit:"30 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"30",suppliers:[],filters:[{filterId:"dateCreated",filter:"Date Created"},{filterId:"bank",filter:"Bank"},{filterId:"bankAccount",filter:"Bank Account"}],filter:"dateCreated",dateCreated:d().format("YYYY-MM"),maxDate:d().format("YYYY-MM"),listType:"",pageNum:1,bank:"",bankAccount:"",userRole:"",newParticular:"",newReferenceNumber:"",newUnitPrice:"",newQuantity:"",newAmount:"",edit:{checkId:"",desc:"",particularId:"",particular:"",referenceNumber:"",unitPrice:"",quantity:"",amount:""}}},validations:{newParticular:{required:o["required"]},newReferenceNumber:{alphaNumCustomValidator:b},newUnitPrice:{required:o["required"],amountCustomValidator:v},newQuantity:{required:o["required"],numCustomValidator:f},newAmount:{required:o["required"],amountCustomValidator:v},edit:{particular:{required:o["required"]},referenceNumber:{alphaNumCustomValidator:b},unitPrice:{required:o["required"],amountCustomValidator:v},quantity:{required:o["required"],numCustomValidator:f},amount:{required:o["required"],amountCustomValidator:v}}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getPaginatedBankChecks(1,"","Used"),e.getBanks(),e.getBankAccounts(),e.getSuppliers(),e.getUserRole();case 5:case"end":return t.stop()}}),t)})))()},methods:{closePage:function(){this.$router.push("/check/dashboard")},getUserRole:function(){var e=this;e.username=localStorage.getItem("aisname"),e.accountName=e.username.toUpperCase();var t=i["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||t.forEach((function(e){a.push(e.data())}));var s=i["dbUsers"].collection("userRoles").where("userRoleId","==",a[0].userRoleReference),r=[];s.get().then((function(t){t.empty||(t.forEach((function(e){r.push(e.data())})),e.userRole=r[0].userRole)}))}))},getPaginatedBankChecks:function(e,t,a){var s=this,r=null,n=[],o=[],l=d(s.dateCreated).startOf("month").format("YYYY-MM-DD"),c=d(s.dateCreated).endOf("month").format("YYYY-MM-DD");if(s.loading=!0,s.loadError=!1,s.bankChecks=[],s.listType=a,s.pageNum=e,t&&(s.searching=!0),t)t=t.toString(),"all"!=s.limit?r=i["db"].collection("bankChecks").where("voucherNumber","==",t.toString()).orderBy("dateCreated","desc").limit(s.limit):"all"==s.limit&&(r=i["db"].collection("bankChecks").where("voucherNumber","==",t.toString()).orderBy("dateCreated","desc"));else if("Used"==a){if("all"!=s.limit)if("dateCreated"==s.filter){var u=new Date(l),p=new Date(c);r=i["db"].collection("bankChecks").where("dateCreated",">=",u).where("dateCreated","<=",p).where("status","in",[1,2,3]).orderBy("dateCreated","desc").limit(s.limit)}else"bank"==s.filter?r=i["db"].collection("bankChecks").where("bankReference","==",s.bank).where("status","in",[1,2,3]).orderBy("bankCheckDate","desc").limit(s.limit):"bankAccount"==s.filter&&(r=i["db"].collection("bankChecks").where("bankAccountReference","==",s.bankAccount).where("status","in",[1,2,3]).orderBy("bankCheckDate","desc").limit(s.limit));else if("all"==s.limit&&"dateCreated"==s.filter){var b=new Date(l),f=new Date(c);r=i["db"].collection("bankChecks").where("dateCreated",">=",b).where("dateCreated","<=",f).where("status","in",[1,2,3]).orderBy("dateCreated","desc")}}else if("Cancelled"==a){if("all"!=s.limit)if("dateCreated"==s.filter){var v=new Date(l),h=new Date(c);r=i["db"].collection("bankChecks").where("dateCreated",">=",v).where("dateCreated","<=",h).where("status","==",0).orderBy("dateCreated","desc").limit(s.limit)}else"bank"==s.filter?r=i["db"].collection("bankChecks").where("bankReference","==",s.bank).where("status","==",0).orderBy("bankCheckDate","desc").limit(s.limit):"bankAccount"==s.filter&&(r=i["db"].collection("bankChecks").where("bankAccountReference","==",s.bankAccount).where("status","==",0).orderBy("bankCheckDate","desc").limit(s.limit));else if("all"==s.limit&&"dateCreated"==s.filter){var C=new Date(l),w=new Date(c);r=i["db"].collection("bankChecks").where("dateCreated",">=",C).where("dateCreated","<=",w).where("status","==",0).orderBy("dateCreated","desc")}}else if("All"==a)if("all"!=s.limit)if("dateCreated"==s.filter){var g=new Date(l),y=new Date(c);r=i["db"].collection("bankChecks").where("dateCreated",">=",g).where("dateCreated","<=",y).orderBy("dateCreated","desc").limit(s.limit)}else"bank"==s.filter?r=i["db"].collection("bankChecks").where("bankReference","==",s.bank).orderBy("bankCheckDate","desc").limit(s.limit):"bankAccount"==s.filter&&(r=i["db"].collection("bankChecks").where("bankAccountReference","==",s.bankAccount).orderBy("bankCheckDate","desc").limit(s.limit));else if("all"==s.limit&&"dateCreated"==s.filter){var _=new Date(l),k=new Date(c);r=i["db"].collection("bankChecks").where("dateCreated",">=",_).where("dateCreated","<=",k).orderBy("dateCreated","desc")}r.get().then((function(t){if(!t.empty){t.forEach((function(e){o.push(e.data()),n.push(e.id)}));for(var a=0;a<o.length;a++)o[a]["rowNum"]=1+a,o[a]["id"]=n[a],o[a].dateCreated=d.unix(o[a].dateCreated.seconds),o[a].voucherDate=d.unix(o[a].voucherDate.seconds),o[a].bankCheckAmount=m(parseFloat(o[a].bankCheckAmount).toFixed(2));for(var r=10*(e-1),i=10*e,l=r;l<i;l++)o[l]&&s.bankChecks.push(o[l]);s.bankChecksCount=o.length,s.currentPage=e}setTimeout((function(){s.loading=!1}),1e3)}))},onPageChange:function(e){var t=this.searchTerm;this.getPaginatedBankChecks(e,t,this.listType)},resetData:function(){this.searching=!1,""==this.searchTerm&&this.getPaginatedBankChecks(1,"",this.listType)},reloadData:function(){this.searchTerm="",this.searching=!1,this.getPaginatedBankChecks(1,"",this.listType)},search:function(){var e=this.searchTerm;e&&this.getPaginatedBankChecks(1,e,this.listType)},getBanks:function(){var e=this,t=i["dbMains"].collection("banks").orderBy("bank","asc");e.banks=[],t.get().then((function(t){t.forEach((function(t){e.banks.push(t.data())})),e.bank=e.banks[0].bankUid}))},getBankAccounts:function(){var e=this,t=i["db"].collection("bankAccounts").orderBy("bankAccountNumber","asc");e.bankAccounts=[],t.get().then((function(t){t.forEach((function(t){e.bankAccounts.push(t.data())}));for(var a=0;a<e.banks.length;a++)for(var s=0;s<e.bankAccounts.length;s++)e.banks[a].bankUid==e.bankAccounts[s].bankReference&&(e.bankAccounts[s]["account"]=e.banks[a].bank+" "+e.bankAccounts[s].bankAccountNumber);e.bankAccount=e.bankAccounts[0].bankAccountUid}))},getSuppliers:function(){var e=this,t=i["db"].collection("suppliers").orderBy("supplier","asc");e.suppliers=[],t.get().then((function(t){t.forEach((function(t){e.suppliers.push(t.data())}))}))},openUpdateCheckModal:function(e){var t=this;t.edit.checkId=e.bankCheckUid,t.edit.payee=e.payeeReference,t.edit.desc=e.description,t.getParticulars(e.bankCheckUid),t.$bvModal.show("update-check-modal")},updateCheck:function(){var e=this;e.requestProcessing=!0;try{var t=i["db"].collection("bankChecks").where("bankCheckUid","==",e.edit.checkId),a="";t.get().then((function(t){t.forEach((function(e){a=e.id})),i["db"].collection("bankChecks").doc(a).update({description:e.edit.desc,dateModified:p}).then((function(){e.requestProcessing=!1,e.getPaginatedBankChecks(e.pageNum,"",e.listType),e.$bvModal.hide("update-check-modal"),e.$swal({title:"Success",text:"Check updated successfully!",icon:"success",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}))}))}catch(s){console.log(s),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}},getParticulars:function(e){var t=this,a=i["db"].collection("bankCheckParticulars").where("bankCheckReference","==",e);t.particulars=[],a.get().then((function(e){e.forEach((function(e){t.particulars.push(e.data())})),t.loading=!0,t.loadError=!1;for(var a=0;a<t.particulars.length;a++)t.particulars[a]["rowNum"]=a+1,t.particulars[a].unitPrice=m(parseFloat(t.particulars[a].unitPrice).toFixed(2)),t.particulars[a].particularAmount=m(parseFloat(t.particulars[a].particularAmount).toFixed(2));setTimeout((function(){t.loading=!1}),1500)}))},addParticular:function(){var e=this;if(e.$v.newParticular.$touch(),e.$v.newReferenceNumber.$touch(),e.$v.newUnitPrice.$touch(),e.$v.newQuantity.$touch(),e.$v.newAmount.$touch(),!e.$v.newParticular.$error&&!e.$v.newReferenceNumber.$error&&!e.$v.newUnitPrice.$error&&!e.newQuantity.$error&&!e.$v.newAmount.$error){var t="BCPI-"+p.getFullYear()+h(p.getMonth()+1,2)+p.getDate()+"-"+Math.floor(1e6*Math.random()),a=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),s=i["db"].collection("bankChecks").where("bankCheckUid","==",e.edit.checkId),r=i["db"].collection("bankCheckParticulars").where("bankCheckReference","==",e.edit.checkId),n=[],o="",l=[],c=0;e.requestProcessing=!0,a.get().then((function(a){a.forEach((function(e){n.push(e.data())})),i["db"].collection("bankCheckParticulars").doc().set({bankCheckParticularsUid:t,particular:e.newParticular,referenceNumber:e.newReferenceNumber,unitPrice:e.newUnitPrice,particularAmount:e.newAmount,quantity:e.newQuantity,bankCheckReference:e.edit.checkId,userReference:n[0].userId,status:1,dateCreated:p,dateModified:p,createdBy:n[0].username}).then((function(){s.get().then((function(t){t.forEach((function(e){o=e.id})),r.get().then((function(t){t.forEach((function(e){l.push(e.data())}));for(var a=0;a<l.length;a++)c+=parseFloat(l[a].particularAmount);i["db"].collection("bankChecks").doc(o).update({bankCheckAmount:c.toString(),dateModified:p}).then((function(){e.newParticular="",e.newReferenceNumber="",e.newUnitPrice="",e.newQuantity="",e.newAmount="",e.$v.newParticular.$reset(),e.$v.newReferenceNumber.$reset(),e.$v.newUnitPrice.$reset(),e.$v.newQuantity.$reset(),e.$v.newAmount.$reset(),e.$bvModal.hide("add-particular-modal"),e.requestProcessing=!1,e.getParticulars(e.edit.checkId),e.getPaginatedBankChecks(e.pageNum,"",e.listType),e.$swal({title:"Success",text:"New Particular added successfully!",icon:"success",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}))}))}))}))}))}},openEditParticularModal:function(e){this.edit={checkId:e.bankCheckReference,payee:this.edit.payee,desc:this.edit.desc,particularId:e.bankCheckParticularsUid,particular:e.particular,referenceNumber:e.referenceNumber,unitPrice:e.unitPrice.replaceAll(",",""),quantity:e.quantity,amount:e.particularAmount.replaceAll(",","")},this.$bvModal.show("update-particular-modal")},computeAmount:function(e,t,a){e=e.replaceAll("â‚± ",""),e=e.replaceAll(",",""),"add"==a?this.newAmount=parseFloat(e*t).toFixed(2):"edit"==a&&(this.edit.amount=parseFloat(e*t).toFixed(2))},updateParticular:function(){var e=this;e.requestProcessing=!0;try{var t=i["db"].collection("bankCheckParticulars").where("bankCheckParticularsUid","==",e.edit.particularId),a=i["db"].collection("bankChecks").where("bankCheckUid","==",e.edit.checkId),s=i["db"].collection("bankCheckParticulars").where("bankCheckReference","==",e.edit.checkId),r="",n="",o=[],l=0;t.get().then((function(t){t.forEach((function(e){r=e.id})),i["db"].collection("bankCheckParticulars").doc(r).update({particular:e.edit.particular,referenceNumber:e.edit.referenceNumber,unitPrice:e.edit.unitPrice,quantity:e.edit.quantity,particularAmount:e.edit.amount,dateModified:p}).then((function(){a.get().then((function(t){t.forEach((function(e){n=e.id})),s.get().then((function(t){t.forEach((function(e){o.push(e.data())}));for(var a=0;a<o.length;a++)l+=parseFloat(o[a].particularAmount);i["db"].collection("bankChecks").doc(n).update({bankCheckAmount:l.toString(),dateModified:p}).then((function(){e.requestProcessing=!1,e.getParticulars(e.edit.checkId),e.getPaginatedBankChecks(e.pageNum,"",e.listType),e.$bvModal.hide("update-particular-modal"),e.$swal({title:"Success",text:"Particular updated successfully!",icon:"success",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}))}))}))}))}))}catch(c){console.log(c),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}},removeParticular:function(e){var t=this;this.$swal({title:"Are you sure?",text:"You want to remove this Particular",icon:"warning",showCancelButton:!0,confirmButtonColor:"#096b85",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(a){if(a.value){var s=t;s.requestProcessing=!0;try{var r=i["db"].collection("bankCheckParticulars").where("bankCheckParticularsUid","==",e.bankCheckParticularsUid),n=i["db"].collection("bankCheckParticulars").where("bankCheckReference","==",e.bankCheckReference),o=i["db"].collection("bankChecks").where("bankCheckUid","==",e.bankCheckReference),l=[],c="",d="",u=0;r.get().then((function(e){e.forEach((function(e){c=e.id})),i["db"].collection("bankCheckParticulars").doc(c).delete().then((function(){o.get().then((function(e){e.forEach((function(e){d=e.id})),n.get().then((function(e){e.forEach((function(e){l.push(e.data())}));for(var t=0;t<l.length;t++)u+=parseFloat(l[t].particularAmount);i["db"].collection("bankChecks").doc(d).update({bankCheckAmount:u.toString(),dateModified:p}).then((function(){s.$swal({title:"Success",text:"Particular remove successfully!",icon:"success",confirmButtonColor:"#096b85",confirmButtonText:"OK"}),s.getParticulars(s.edit.checkId),s.getPaginatedBankChecks(s.pageNum,"",s.listType)}))}))}))}))}))}catch(m){console.log(m),s.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}s.requestProcessing=!1}}))},cancelCheck:function(e){var t=this;this.$swal({title:"Are you sure?",text:"You want to cancel this Check Number",icon:"warning",showCancelButton:!0,confirmButtonColor:"#096b85",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(a){if(a.value){var s=t,r="",n=i["db"].collection("bankChecks").where("bankCheckUid","==",e.bankCheckUid);n.get().then((function(t){t.forEach((function(e){r=e.id})),i["db"].collection("bankChecks").doc(r).update({status:0,dateModified:p}).then((function(){var t=i["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",e.bankCheckSeriesReference).where("checkNumber","==",e.bankCheckNumber),a="";t.get().then((function(e){e.forEach((function(e){a=e.id})),i["db"].collection("bankCheckSeriesReports").doc(a).update({status:"cancelled",dateModified:p})})),s.getBankRecon(1),s.$swal({title:"Success",text:"Check cancelled",icon:"success",confirmButtonColor:"#096b85",confirmButtonText:"OK"})})).catch((function(e){console.log(e),s.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}))}))}}))},checkPrinted:function(e,t){var a=this,s="disable",r="disbaled";3==t&&(s="enable",r="enabled"),this.$swal({title:"Are you sure?",text:"You want to  "+s+" the check print",icon:"warning",showCancelButton:!0,confirmButtonColor:"#096b85",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(s){if(s.value){var n=a,o=i["db"].collection("bankChecks").where("bankCheckUid","==",e.bankCheckUid),l="";o.get().then((function(e){e.forEach((function(e){l=e.id})),i["db"].collection("bankChecks").doc(l).update({status:t,dateModified:p}).then((function(){n.$swal({title:"Success",text:"Check print "+r,icon:"success",confirmButtonColor:"#096b85",confirmButtonText:"OK"}),n.getPaginatedBankChecks(n.pageNum,"",n.listType)})).catch((function(e){console.log(e),n.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}))}))}}))}}},w=C,g=a("2877"),y=Object(g["a"])(w,s,r,!1,null,null,null);t["default"]=y.exports},a584:function(e,t,a){},a791:function(e,t,a){"use strict";a("7072")},a994:function(e,t,a){"use strict";a("fa44")},ac1f:function(e,t,a){"use strict";var s=a("23e7"),r=a("9263");s({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},ac8c:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"textStyle"}},[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[""!=e.reimbursements.monthOf?a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Reimbursement for "+e._s(e._f("moment")(e.reimbursements.monthOf,"MMMM YYYY")))])])]):e._e(),""!=e.reimbursements.monthOf?a("hr"):e._e(),a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Name:")]),e._v(" "+e._s(e.reimbursements.fullName)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Total Amount:")]),e._v(" â‚± "+e._s(e.reimbursements.totalAmount)+" ")])]),a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12"},e._l(e.companies,(function(t){return a("span",{key:t.companyId},[t.companyId==e.reimbursements.companyReference?a("span",[a("b",[e._v("Company: ")]),e._v(e._s(t.companyName))]):e._e()])})),0)]),3==e.reimbursements.status|4==e.reimbursements.status?a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Check No.:")]),e._v(" "+e._s(e.reimbursements.checkNumber)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Voucher No:")]),e._v(" "+e._s(e._f("moment")(e.reimbursements.voucherNumber,"MMMM DD, YYYY"))+" ")])]):e._e(),a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Status:")]),e._v(" "+e._s(e.reimbursements.statusName)+" ")]),""!=e.reimbursements.processDate?a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Process Date:")]),e._v(" "+e._s(e._f("moment")(e.reimbursements.processDate,"MMMM DD, YYYY"))+" ")]):e._e()]),4==e.reimbursements.status?a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Received Date:")]),e._v(" "+e._s(e._f("moment")(e.reimbursements.receivedDate,"MMMM DD, YYYY"))+" ")])]):e._e(),4==e.reimbursements.status||0==e.reimbursements.status?a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12"},[a("span",{attrs:{id:"particular"}},[a("b",[e._v("Remarks:")]),e._v(" "+e._s(""==e.reimbursements.remarks?"-------":e.reimbursements.remarks))])])]):e._e(),1==e.reimbursements.status|0==e.reimbursements.status|2==e.reimbursements.status?a("hr"):e._e(),1==e.reimbursements.status|0==e.reimbursements.status?a("div",{staticClass:"form-group row"},["Administrator"!=e.userRole?a("div",{staticClass:"col-sm-4 pl-5"}):e._e(),a("div",{staticClass:"col-sm-3 pl-5"},[1==e.reimbursements.status?a("base-button",{attrs:{block:"",id:"darkBtn"},on:{click:function(t){return e.openReimItemModal(e.desc)}}},[e._v("Add Item for")]):e._e()],1),a("div",{staticClass:"col-sm-5 pr-5"},[1==e.reimbursements.status?a("v-select",{attrs:{id:"inputStyle",options:e.descriptions,reduce:function(e){return e.reimbursementDescId},label:"description",clearable:!1},model:{value:e.desc,callback:function(t){e.desc=t},expression:"desc"}}):e._e(),e.$v.desc.$anyDirty&&!e.$v.desc.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),"Administrator"==e.userRole?a("div",{staticClass:"col-sm-3 pl-5"},[a("base-button",{attrs:{block:"",id:"darkBtn"},on:{click:function(t){return e.openUpdateReim(e.reimbursements)}}},[e._v("Update")])],1):e._e()]):e._e(),2==e.reimbursements.status&&"Administrator"==e.userRole?a("div",{staticClass:"form-group row"},[a("div",{staticClass:"col-sm-9 pl-5"}),a("div",{staticClass:"col-sm-3 pl-5 pr-5"},[a("base-button",{attrs:{block:"",id:"darkBtn"},on:{click:function(t){return e.openUpdateReim(e.reimbursements)}}},[e._v("Update")])],1)]):e._e(),1==e.reimbursements.status&&"Administrator"==e.userRole&&0!=e.reimItems.length?a("hr"):e._e(),0!=e.reimItems.length?a("div",{staticClass:"card-header bg-transparent"},[a("div",{staticClass:"text-left"},[a("h2",{staticClass:"display-5",attrs:{id:"sideBarTxt"}},[e._v("Reimbursement Items")])])]):e._e(),0!=e.reimItems.length?a("div",{staticClass:"table-full-width pt-2"},[a("vue-good-table",{attrs:{columns:e.reimColumns,rows:e.items,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["date"==t.column.field?a("span",[a("span",[e._v(e._s(e._f("moment")(t.row.date,"MMM DD, YYYY")))])]):e._e(),"particular"==t.column.field?a("span",[a("span",{attrs:{id:"particular"}},[e._v(e._s(t.row.particular))])]):e._e(),"amount"==t.column.field?a("span",[a("span",[e._v("â‚± "+e._s(t.row.amount))])]):e._e(),"description"==t.column.field?a("span",e._l(e.descriptions,(function(s){return a("span",{key:s.reimbursementDescId},[s.reimbursementDescId==t.row.descriptionReference?a("span",[e._v(e._s(s.description))]):e._e()])})),0):e._e(),"action"==t.column.field?a("span",[1==e.reimbursements.status|0==e.reimbursements.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdateItemModal(t.row)}}}):e._e(),a("span",{staticClass:"pointer ml-2 fa fa-file",attrs:{id:"sideBarTxt",title:"Attachment"},on:{click:function(a){return e.openAttachments(t.row)}}}),1==e.reimbursements.status|0==e.reimbursements.status?a("span",{staticClass:"pointer ml-2 far fa-times-circle text-red",attrs:{title:"Remove"},on:{click:function(a){return e.removeItem(t.row)}}}):e._e()]):e._e()])]}}],null,!1,377209928)})],1):e._e(),0!=e.reimTrans.length?a("hr"):e._e(),0!=e.reimTrans.length?a("div",{staticClass:"card-header bg-transparent"},[a("div",{staticClass:"text-left"},[a("h2",{staticClass:"display-5",attrs:{id:"sideBarTxt"}},[e._v("Transportation Reimbursement")])])]):e._e(),0!=e.reimTrans.length?a("div",{staticClass:"table-full-width"},[a("vue-good-table",{attrs:{columns:e.reimTransColumns,rows:e.trans,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["date"==t.column.field?a("span",[a("span",[e._v(e._s(e._f("moment")(t.row.date,"MMM DD, YYYY")))])]):e._e(),"transportationMode"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v(e._s(t.row.transportationMode))])]):e._e(),"from"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v(e._s(t.row.from))])]):e._e(),"to"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v(e._s(t.row.to))])]):e._e(),"purpose"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v(e._s(t.row.purpose))])]):e._e(),"amount"==t.column.field?a("span",[a("span",[e._v("â‚± "+e._s(t.row.amount))])]):e._e(),"action"==t.column.field?a("span",[1==e.reimbursements.status|0==e.reimbursements.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdateTransModal(t.row)}}}):e._e(),a("span",{staticClass:"pointer ml-2 fa fa-file",attrs:{id:"sideBarTxt",title:"Attachment"},on:{click:function(a){return e.openAttachments(t.row)}}}),1==e.reimbursements.status|0==e.reimbursements.status?a("span",{staticClass:"pointer ml-2 far fa-times-circle text-red",attrs:{title:"Remove"},on:{click:function(a){return e.removeTrans(t.row)}}}):e._e()]):e._e()])]}}],null,!1,2550606273)})],1):e._e(),a("hr"),a("div",{staticClass:"text-right"},[3==e.reimbursements.status|2==e.reimbursements.status|4==e.reimbursements.status?a("base-button",{staticClass:"col-md-2 ml-2 mr-2",attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.printReim(t)}}},[e._v("Print")]):e._e(),a("base-button",{staticClass:"col-md-2 ml-2 mr-5",attrs:{id:"darkInlineBtn"},nativeOn:{click:function(t){return e.cancelView(t)}}},[e._v("Close")])],1)]),3==e.reimbursements.status|2==e.reimbursements.status|4==e.reimbursements.status?a("card",{staticClass:"pl-4 shadow",attrs:{id:"viewSummary"}},[a("div",{staticClass:"row",attrs:{id:"centerStyle"}},[a("span",{staticClass:"col-sm-12 text-center",attrs:{id:"particular"}},[a("b",[e._v(e._s(e.company.name))])])]),a("div",{staticClass:"row",attrs:{id:"centerStyle"}},[a("span",{staticClass:"col-sm-12 text-center",attrs:{id:"particular"}},[a("b",[e._v(e._s(e.company.address))])])]),a("div",{staticClass:"row pt-4",attrs:{id:"headerStyle"}},[a("span",{staticClass:"col-sm-12 text-center"},[a("b",[e._v("Reimbursement")]),a("br")])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("span",[a("b",[e._v(e._s(e._f("moment")(e.reimbursements.processDate,"MMMM DD, YYYY")))])])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-6"},[a("b",[e._v(e._s(e.reimbursements.fullName))])]),a("div",{staticClass:"col-sm-2"}),a("div",{staticClass:"col-sm-4"},e._l(e.departments,(function(t){return a("span",{key:t.departmentUid},[t.departmentUid==e.reimbursements.departmentReference?a("span",[e._v(" "+e._s(t.departmentName)+" ")]):e._e()])})),0)]),3==e.reimbursements.status|4==e.reimbursements.status?a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Check No.:")]),e._v(" "+e._s(e.reimbursements.checkNumber)+" ")]),a("div",{staticClass:"col-sm-2"}),a("span",{staticClass:"col-sm-4"},[a("b",[e._v("Voucher No:")]),e._v(" "+e._s(e._f("moment")(e.reimbursements.voucherNumber,"MMMM DD, YYYY"))+" ")])]):e._e(),a("hr"),0!=e.reimItems.length?a("div",{staticClass:"row pb-0 text-center pl-4 pr-4",attrs:{id:"particularStyle"}},[a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Date")])])]),a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Particular")])])]),a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Description")])])]),a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Amount")])])])]):e._e(),e._l(e.reimItems,(function(t){return a("div",{key:t.reimbursementParticularId,staticClass:"row pl-4 pr-4 text-center",attrs:{id:"particularStyle"}},[a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},[a("span",[e._v(e._s(e._f("moment")(t.date,"MMM DD, YYYY")))])]),a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},[a("span",[e._v(e._s(t.particular))])]),a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},e._l(e.descriptions,(function(s){return a("span",{key:s.reimbursementDescId},[s.reimbursementDescId==t.descriptionReference?a("span",[e._v(e._s(s.description))]):e._e()])})),0),a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},[a("span",[e._v("â‚± "+e._s(t.amount))])])])})),0!=e.reimItems.length?a("div",{staticClass:"row pl-4 pr-4 text-center",attrs:{id:"particularStyle"}},[a("span",{staticClass:"col-sm-9",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Total Amount")])])]),a("span",{staticClass:"col-sm-3",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("â‚± "+e._s(e.totalItem))])])])]):e._e(),0!=e.reimTrans.length?a("br"):e._e(),0!=e.reimTrans.length?a("div",{staticClass:"row text-center pl-4 pr-4",attrs:{id:"particularStyle"}},[a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Date")])])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Mode")])])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("From")])])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("To")])])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Purpose")])])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Amount")])])])]):e._e(),e._l(e.reimTrans,(function(t){return a("div",{key:t.reimbursementParticularId,staticClass:"row pl-4 pr-4 text-center",attrs:{id:"particularStyle"}},[a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[e._v(e._s(e._f("moment")(t.date,"MMM DD, YYYY")))])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[e._v(e._s(t.transportationMode))])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[e._v(e._s(t.from))])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[e._v(e._s(t.to))])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[e._v(e._s(t.purpose))])]),a("span",{staticClass:"col-sm-2",attrs:{id:"borderStyle"}},[a("span",[e._v("â‚± "+e._s(t.amount))])])])})),0!=e.reimTrans.length?a("div",{staticClass:"row pl-4 pr-4 text-center",attrs:{id:"particularStyle"}},[a("span",{staticClass:"col-sm-10",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("Total Amount")])])]),a("span",{staticClass:"col-sm-2 ",attrs:{id:"borderStyle"}},[a("span",[a("b",[e._v("â‚± "+e._s(e.totalTrans))])])])]):e._e(),a("br"),0!=e.reimTrans.length?a("br"):e._e(),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-12"},[a("h3",[e._v("Total Reimbursement Amount: â‚± "+e._s(e.reimbursements.totalAmount))])])]),a("br"),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Prepared by :")]),e._v(" "+e._s(e.reimSignatory.prepared||e.user.firstname+" "+e.user.lastname)+" ")]),a("span",{staticClass:"col-sm-2"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Approved by : ")]),e._v(" "+e._s(e.reimSignatory.approved)+" ")])]),a("br"),e.allAttachments.length>0?a("div",{staticClass:"pl-4 pt-4",attrs:{align:"center",id:"attachmentStyle"}},e._l(e.allAttachments,(function(t){return a("span",{key:t.name},[a("span",[e.allAttachments.length>1?a("img",{staticStyle:{width:"370px",height:"250px"},attrs:{src:t.url}}):e._e(),1==e.allAttachments.length?a("img",{staticStyle:{width:"740px",height:"250px"},attrs:{src:t.url}}):e._e()])])})),0):e._e()],2):e._e()],1),a("b-modal",{attrs:{size:"lg",id:"update-modal",title:"Edit Reimbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateReim()}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("update-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Process Date:")]),2==e.editReim.status?a("b",{staticClass:"text-red"},[e._v("*")]):e._e()]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Status:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date",id:"inputStyle"},model:{value:e.editReim.processDate,callback:function(t){e.$set(e.editReim,"processDate",t)},expression:"editReim.processDate"}}),e.$v.editReim.$anyDirty&&!e.$v.editReim.processDate.required&&2==e.editReim.status?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.stats,reduce:function(e){return e.statId},label:"status",clearable:!1},model:{value:e.editReim.status,callback:function(t){e.$set(e.editReim,"status",t)},expression:"editReim.status"}}),e.$v.editReim.$anyDirty&&!e.$v.editReim.status.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Company:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.companies,reduce:function(e){return e.companyId},label:"companyName"},model:{value:e.editReim.company,callback:function(t){e.$set(e.editReim,"company",t)},expression:"editReim.company"}})],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Remarks:")]),0==e.editReim.status?a("b",{staticClass:"text-red"},[e._v("*")]):e._e()])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editReim.remarks,expression:"editReim.remarks"}],attrs:{id:"inputStyle",cols:"53",rows:"4",placeholder:"Remarks"},domProps:{value:e.editReim.remarks},on:{input:function(t){t.target.composing||e.$set(e.editReim,"remarks",t.target.value)}}}),e.$v.editReim.$anyDirty&&!e.$v.editReim.remarks.required&&0==e.editReim.status?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()])])]),a("b-modal",{attrs:{size:"lg",id:"attachment-modal",title:"Attachments",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[1==e.reimbursements.status|0==e.reimbursements.status?a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addAttachments()}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add Attachment ")]):e._e(),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("attachment-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("input",{ref:"attachmentFile",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.previewImage}}),e.loadAttachment?a("card",{attrs:{shadow:""}},[a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12 text-center"},[a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}}),a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}}),a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}})],1)])]):e._e(),e.attachments.length>0?a("card",{attrs:{shadow:""}},[e.attachments.length>0&&!e.loadAttachment?a("div",{staticClass:"row pl-4",attrs:{align:"center"}},e._l(e.attachments,(function(t){return a("span",{key:t.rowNum},[a("span",{staticClass:"col-4"},[a("div",{staticClass:"mt-1 mb--2 pr-2 text-right"},[1==e.reimbursements.status|0==e.reimbursements.status?a("span",{staticClass:"pointer far fa-times-circle text-danger",staticStyle:{"z-index":"1",position:"relative",left:"0px",top:"0px"},attrs:{title:"Remove"},on:{click:function(a){return e.removeAttachment(t.name)}}}):e._e()]),a("span",{staticClass:"mt-0"},[a("a",{attrs:{target:"_blank",href:t.url}},[a("img",{staticStyle:{width:"220px",height:"220px","border-style":"solid","border-color":"black","border-width":"2px"},attrs:{src:t.url}})])])])])})),0):e._e()]):e._e(),0!=e.attachments.length||e.loadAttachment?e._e():a("card",{attrs:{shadow:""}},[a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12"},[a("h2",{staticClass:"text-center"},[e._v("NO ATTACHMENT")])])])])],1),a("b-modal",{attrs:{size:"lg",id:"new-reim-item-modal",title:"New Reimbursement Item",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addReimItem()}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-reim-item-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Item:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date",id:"inputStyle",max:e.processMaxDate},model:{value:e.newDate,callback:function(t){e.newDate=t},expression:"newDate"}}),e.$v.newDate.$anyDirty&&!e.$v.newDate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Item"},model:{value:e.newParticular,callback:function(t){e.newParticular=t},expression:"newParticular"}}),e.$v.newParticular.$anyDirty&&!e.$v.newParticular.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newParticular.$anyDirty&&!e.$v.newParticular.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Amount"},model:{value:e.newAmount,callback:function(t){e.newAmount=t},expression:"newAmount"}}),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"new-trans-reim-modal",title:"New Transportation Reimbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addTransReim(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-trans-reim-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Mode of Transportation:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date",id:"inputStyle",max:e.processMaxDate},model:{value:e.newTransDate,callback:function(t){e.newTransDate=t},expression:"newTransDate"}}),e.$v.newTransDate.$anyDirty&&!e.$v.newTransDate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Mode of Transportation"},model:{value:e.newMode,callback:function(t){e.newMode=t},expression:"newMode"}}),e.$v.newMode.$anyDirty&&!e.$v.newMode.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newMode.$anyDirty&&!e.$v.newMode.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("From:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("To:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newFrom,expression:"newFrom"}],attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"From"},domProps:{value:e.newFrom},on:{input:function(t){t.target.composing||(e.newFrom=t.target.value)}}}),e.$v.newFrom.$anyDirty&&!e.$v.newFrom.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newFrom.$anyDirty&&!e.$v.newFrom.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()]),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newTo,expression:"newTo"}],attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"To"},domProps:{value:e.newTo},on:{input:function(t){t.target.composing||(e.newTo=t.target.value)}}}),e.$v.newTo.$anyDirty&&!e.$v.newTo.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newTo.$anyDirty&&!e.$v.newTo.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Purpose:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newPurpose,expression:"newPurpose"}],attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"Purpose"},domProps:{value:e.newPurpose},on:{input:function(t){t.target.composing||(e.newPurpose=t.target.value)}}}),e.$v.newPurpose.$anyDirty&&!e.$v.newPurpose.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newPurpose.$anyDirty&&!e.$v.newPurpose.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()]),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Amount"},model:{value:e.newTransAmount,callback:function(t){e.newTransAmount=t},expression:"newTransAmount"}}),e.$v.newTransAmount.$anyDirty&&!e.$v.newTransAmount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newTransAmount.$anyDirty&&!e.$v.newTransAmount.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"update-reim-item-modal",title:"Edit Reimbursement Item",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateReimItem()}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("update-reim-item-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Item:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date",id:"inputStyle",max:e.processMaxDate},model:{value:e.editItem.date,callback:function(t){e.$set(e.editItem,"date",t)},expression:"editItem.date"}}),e.$v.editItem.$anyDirty&&!e.$v.editItem.date.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Item"},model:{value:e.editItem.particular,callback:function(t){e.$set(e.editItem,"particular",t)},expression:"editItem.particular"}}),e.$v.editItem.$anyDirty&&!e.$v.editItem.particular.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editItem.$anyDirty&&!e.$v.editItem.particular.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Amount"},model:{value:e.editItem.amount,callback:function(t){e.$set(e.editItem,"amount",t)},expression:"editItem.amount"}}),e.$v.editItem.$anyDirty&&!e.$v.editItem.amount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editItem.$anyDirty&&!e.$v.editItem.amount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"update-trans-reim-modal",title:"Edit Transportation Reimbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateTransReim(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("update-trans-reim-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Mode of Transportation:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date",id:"inputStyle",max:e.processMaxDate},model:{value:e.editTrans.date,callback:function(t){e.$set(e.editTrans,"date",t)},expression:"editTrans.date"}}),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.date.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Mode of Transportation"},model:{value:e.editTrans.mode,callback:function(t){e.$set(e.editTrans,"mode",t)},expression:"editTrans.mode"}}),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.mode.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.mode.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("From:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("To:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editTrans.from,expression:"editTrans.from"}],attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"From"},domProps:{value:e.editTrans.from},on:{input:function(t){t.target.composing||e.$set(e.editTrans,"from",t.target.value)}}}),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.from.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.from.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()]),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editTrans.to,expression:"editTrans.to"}],attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"To"},domProps:{value:e.editTrans.to},on:{input:function(t){t.target.composing||e.$set(e.editTrans,"to",t.target.value)}}}),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.to.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.to.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Purpose:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editTrans.purpose,expression:"editTrans.purpose"}],attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"Purpose"},domProps:{value:e.editTrans.purpose},on:{input:function(t){t.target.composing||e.$set(e.editTrans,"purpose",t.target.value)}}}),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.purpose.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.purpose.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()]),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Amount"},model:{value:e.editTrans.amount,callback:function(t){e.$set(e.editTrans,"amount",t)},expression:"editTrans.amount"}}),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.amount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editTrans.$anyDirty&&!e.$v.editTrans.amount.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])])],1)},r=[],n=(a("a4d3"),a("e01a"),a("99af"),a("4160"),a("b0c0"),a("b680"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("4627"),l=a("b5ae"),c=a("7ff6"),d=a("e966"),u=d.bindWith(",","."),m=["#","Date","Particular","Amount","Description","Actions"],p=["#","Date","Mode","From","To","Purpose","Amount","Actions"],b=l["helpers"].regex("alphaNumAndDot",/^[ 0-9 ,. ]*$/),f=l["helpers"].regex("alphaNumAndDot",/^[ A-Za-z0-9 -./, ]*$/),v=a("c1df"),h=new Date,C=a("9f25"),w={components:{},data:function(){return{companies:[],reimbursements:[],reimDesc:[],descriptions:[],company:{name:"",address:""},departments:[],totalItem:0,totalTrans:0,reimColumns:[{label:"Date",field:"date"},{label:"Particular",field:"particular"},{label:"Amount",field:"amount"},{label:"Description",field:"description"},{label:"",field:"action",sortable:!1,width:"100px"}],reimItems:[],items:[],reimItemsTable:{title:"Reimbursement Items Table",subTitle:"",columns:[].concat(m)},currentPage:1,reimTransColumns:[{label:"Date",field:"date"},{label:"Mode",field:"transportationMode"},{label:"From",field:"from"},{label:"To",field:"to"},{label:"Purpose",field:"purpose"},{label:"Amount",field:"amount"},{label:"",field:"action",sortable:!1,width:"100px"}],reimTrans:[],trans:[],loadError:!1,reimTransTable:{title:"Transportation Reimbursement Table",subTitle:"",columns:[].concat(p)},currentTransPage:1,attachment:"",attachmentData:null,attachments:[],allAttachments:[],reimItemId:"",uploadValue:0,desc:"",loadAttachment:!0,newDesc:"",newDate:v().format("YYYY-MM-DD"),newParticular:"",newAmount:"",newTransDate:v().format("YYYY-MM-DD"),newMode:"",newFrom:"",newTo:"",newPurpose:"",newTransAmount:"",requestProcessing:!1,processMaxDate:v().format("YYYY-MM-DD"),editItem:{id:"",date:"",particular:"",amount:""},editTrans:{id:"",date:"",mode:"",from:"",on:"",purpose:"",amount:""},stats:[{statId:1,status:"For Approval"},{statId:2,status:"Approved"},{statId:0,status:"Rejected"}],editReim:{id:"",processDate:"",status:"",company:"",remarks:""},userRole:"",user:{firstname:"",lastname:""},reimSignatory:{prepared:"",approved:""}}},validations:{newDepartment:{required:l["required"]},newName:{required:l["required"]},newProcessDate:{required:l["required"]},newMonthOf:{required:l["required"]},desc:{required:l["required"]},newDesc:{alphaNumCustomValidator:f,required:l["required"]},newDate:{required:l["required"]},newParticular:{alphaNumCustomValidator:f,required:l["required"]},newAmount:{amountCustomValidator:b,required:l["required"]},newTransDate:{required:l["required"]},newMode:{alphaNumCustomValidator:f,required:l["required"]},newFrom:{alphaNumCustomValidator:f,required:l["required"]},newTo:{alphaNumCustomValidator:f,required:l["required"]},newPurpose:{alphaNumCustomValidator:f,required:l["required"]},newTransAmount:{alphaNumCustomValidator:f,required:l["required"]},editItem:{date:{required:l["required"]},particular:{alphaNumCustomValidator:f,required:l["required"]},amount:{amountCustomValidator:b,required:l["required"]}},editTrans:{date:{required:l["required"]},mode:{alphaNumCustomValidator:f,required:l["required"]},from:{alphaNumCustomValidator:f,required:l["required"]},to:{alphaNumCustomValidator:f,required:l["required"]},purpose:{alphaNumCustomValidator:f,required:l["required"]},amount:{alphaNumCustomValidator:f,required:l["required"]}},editReim:{processDate:{required:l["required"]},status:{required:l["required"]},remarks:{required:l["required"]}}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUserRole(),e.getReimbursement(),e.getDesc(),e.getReimItems(1),e.getReimTrans(1),e.getCompany(),e.getDepartments(),e.getUser(localStorage.getItem("aisname")),e.getCompanies();case 9:case"end":return t.stop()}}),t)})))()},methods:{getSignatory:function(){var e=this,t=i["dbMains"].collection("printSignatoryTypes").where("type","==",Object(c["a"])("Reimbursement")),a="";t.get().then((function(t){if(!t.empty){t.forEach((function(e){a=e.data().printSignatoryId}));var s=i["dbMains"].collection("printSignatories").where("signatoryTypeReference","==",a).orderBy("orderNumber","asc"),r=[],n=[],o=[];s.get().then((function(t){if(!t.empty){t.forEach((function(e){r.push(e.data()),n.push(e.id)}));for(var a=0;a<r.length;a++)r[a]["rowNum"]=a+1,r[a]["id"]=n[a],o.push(r[a]);e.reimSignatory={prepared:o[0].name,approved:o[1].name}}}))}}))},getUserRole:function(){var e=this;e.username=localStorage.getItem("aisname"),e.accountName=e.username.toUpperCase();var t=i["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||t.forEach((function(e){a.push(e.data())}));var s=i["dbUsers"].collection("userRoles").where("userRoleId","==",a[0].userRoleReference),r=[];s.get().then((function(t){t.empty||(t.forEach((function(e){r.push(e.data())})),e.userRole=r[0].userRole)}))}))},getCompanies:function(){var e=this,t=i["dbMains"].collection("companies").orderBy("companyName","asc");t.get().then((function(t){t.empty||t.forEach((function(t){e.companies.push(t.data())}))}))},getReimbursement:function(){var e=this,t=null,a="",s=null,r=[],n=this.$router.currentRoute.params.id;e.reimbursements=[],e.allAttachments=[],e.getSignatory(),t=i["dbExpense"].collection("reimbursements").where("reimbursementId","==",n),t.get().then((function(t){t.forEach((function(t){e.reimbursements.push(t.data()),a=t.id})),s=i["dbUsers"].collection("users").where("userId","==",e.reimbursements[0].nameReference),s.get().then((function(t){if(t.forEach((function(e){r.push(e.data())})),e.reimbursements[0]["id"]=a,e.reimbursements[0]["fullName"]=r[0].firstname+" "+r[0].lastname,e.reimbursements[0].totalAmount=u(parseFloat(e.reimbursements[0].totalAmount.replaceAll(",","")).toFixed(2)),1==e.reimbursements[0].status?e.reimbursements[0]["statusName"]="For Approval":2==e.reimbursements[0].status?e.reimbursements[0]["statusName"]="Approved":3==e.reimbursements[0].status?e.reimbursements[0]["statusName"]="Processed":4==e.reimbursements[0].status?e.reimbursements[0]["statusName"]="Received":0==e.reimbursements[0].status&&(e.reimbursements[0]["statusName"]="Rejected"),""!=e.reimbursements[0].checkReference){var s=i["db"].collection("bankChecks").where("bankCheckUid","==",e.reimbursements[0].checkReference);s.get().then((function(t){t.forEach((function(t){e.reimbursements[0]["checkNumber"]=t.data().bankCheckNumber,e.reimbursements[0]["voucherNumber"]=t.data().voucherNumber})),e.reimbursements=e.reimbursements[0]}))}else e.reimbursements=e.reimbursements[0]}))}))},getDesc:function(){var e=this,t=null;t=i["dbMains"].collection("reimbursementDescriptions").orderBy("description","asc"),t.get().then((function(t){t.forEach((function(t){e.descriptions.push(t.data())})),e.desc=e.descriptions[0].reimbursementDescId}))},getReimItems:function(e){var t=this,a=null,s=[],r=[],n=null,o=[],l=this.$router.currentRoute.params.id,c=0;console.log(e),t.reimItems=[],t.items=[],n=i["dbMains"].collection("reimbursementDescriptions"),n.get().then((function(e){e.forEach((function(e){o.push(e.data())})),a=i["dbExpense"].collection("reimbursementItems").where("reimbursementReference","==",l).orderBy("dateCreated","asc"),a.get().then((function(e){e.forEach((function(e){s.push(e.data()),r.push(e.id)}));for(var a=0;a<s.length;a++)s[a]["id"]=r[a];for(var n=0;n<o.length;n++)for(var i=0;i<s.length;i++)o[n].reimbursementDescId==s[i].descriptionReference&&"TRANSPORTATION"!=o[n].description&&(t.reimItems.push(s[i]),t.getAllAttachments(s[i].reimburseItemId));for(var l=0;l<t.reimItems.length;l++)t.reimItems[l]["rowNum"]=l+1,c=parseFloat(c)+parseFloat(t.reimItems[l].amount.replaceAll(",","")),t.reimItems[l].amount=u(parseFloat(t.reimItems[l].amount.replaceAll(",","")).toFixed(2)),t.items.push(t.reimItems[l]);t.totalItem=u(parseFloat(c).toFixed(2))}))}))},onPageChange:function(e){this.getReimItems(e)},getReimTrans:function(e){var t=this,a=null,s=[],r=[],n=null,o=[],l=this.$router.currentRoute.params.id,c=0;console.log(e),t.reimTrans=[],t.trans=[],n=i["dbMains"].collection("reimbursementDescriptions"),n.get().then((function(e){e.forEach((function(e){o.push(e.data())})),a=i["dbExpense"].collection("reimbursementItems").where("reimbursementReference","==",l).orderBy("dateCreated","asc"),a.get().then((function(e){e.forEach((function(e){s.push(e.data()),r.push(e.id)}));for(var a=0;a<s.length;a++)s[a]["id"]=r[a];for(var n=0;n<o.length;n++)for(var i=0;i<s.length;i++)o[n].reimbursementDescId==s[i].descriptionReference&&"TRANSPORTATION"==o[n].description&&(t.reimTrans.push(s[i]),t.getAllAttachments(s[i].reimburseItemId));for(var l=0;l<t.reimTrans.length;l++)t.reimTrans[l]["rowNum"]=l+1,c=parseFloat(c)+parseFloat(t.reimTrans[l].amount.replaceAll(",","")),t.reimTrans[l].amount=u(parseFloat(t.reimTrans[l].amount.replaceAll(",","")).toFixed(2)),t.trans.push(t.reimTrans[l]);t.reimTrans.sort((function(e,t){return t.dateCreated-e.dateCreated})),t.totalTrans=u(parseFloat(c).toFixed(2))}))}))},onTransPageChange:function(e){this.getReimTrans(e)},openAttachments:function(e){this.reimItemId=e.reimburseItemId,this.$bvModal.show("attachment-modal"),this.getAttachments(this.reimItemId)},addAttachments:function(){this.$refs.attachmentFile.click()},previewImage:function(e){var t=this,a={maxSizeMB:1,useWebWorker:!0};t.uploadValue=0,t.attachment=null,t.attachments=[],t.attachmentData=e.target.files[0],Object(o["a"])(t.attachmentData,a).then((function(e){t.attachmentData=e,t.onUpload(t.attachmentData)}))},onUpload:function(e){var t=this,a=i["expenseStorage"].ref("reimbursementFiles/"+t.reimItemId+"/"+e.name).put(e);t.requestProcessing=!1;try{t.attachment=null,t.requestProcessing=!0,a.on("state_changed",(function(e){t.uploadValue=e.bytesTransferred/e.totalBytes*100}),(function(e){console.log(e.message)}),(function(){t.uploadValue=100,t.$swal({title:"Success",text:"Attachment uploaded successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),t.requestProcessing=!1,t.getAttachments(t.reimItemId),t.getReimbursement(),t.getReimItems(1),t.getReimTrans(1)}))}catch(s){console.log("error"),t.requestProcessing=!1,t.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#f5365c",confirmButtonText:"OK"})}},getAttachments:function(e){var t=this,a=0,s=i["expenseStorage"].ref("reimbursementFiles/"+e);t.loadAttachment=!0,t.attachments=[],s.listAll().then((function(s){s.items.forEach((function(s){i["expenseStorage"].ref("reimbursementFiles/"+e+"/"+s.name).getDownloadURL().then((function(e){a+=1,t.attachments.push({rowNum:a,name:s.name,url:e,path:s.fullPath,status:1})}))}))})).catch((function(e){console.log(e)})),setTimeout((function(){t.loadAttachment=!1}),5e3)},getAllAttachments:function(e){var t=this,a=0,s=i["expenseStorage"].ref("reimbursementFiles/"+e);t.requestProcessing=!0,s.listAll().then((function(s){s.items.forEach((function(s){i["expenseStorage"].ref("reimbursementFiles/"+e+"/"+s.name).getDownloadURL().then((function(e){a+=1,t.allAttachments.push({rowNum:a,name:s.name,url:e,path:s.fullPath,status:1})}))}))})).catch((function(e){console.log(e)})),setTimeout((function(){t.requestProcessing=!1}),2e3)},removeAttachment:function(e){var t=this;t.$swal({title:"Are you sure?",text:"You want to remove this attachment?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM",cancelButtonText:"CANCEL"}).then((function(a){if(a.value){var s=i["expenseStorage"].ref("reimbursementFiles/"+t.reimItemId+"/"+e);try{s.delete().then((function(){t.$swal({title:"Success",text:"Attachment remove successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){t.getAttachments(t.reimItemId),t.getReimbursement(),t.getReimItems(1),t.getReimTrans(1)}))}))}catch(r){console.log(r),t.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#f5365c",confirmButtonText:"OK"})}}}))},openReimItemModal:function(e){var t=this,a=i["dbMains"].collection("reimbursementDescriptions").where("reimbursementDescId","==",e),s=[];a.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"TRANSPORTATION"==s[0].description||"TRANSPORTATIONS"==s[0].description?t.$bvModal.show("new-trans-reim-modal"):t.$bvModal.show("new-reim-item-modal")}))},addReimItem:function(){var e=this;if(e.$v.newDate.$touch(),e.$v.newParticular.$touch(),e.$v.newAmount.$touch(),e.requestProcessing=!1,!e.$v.newDate.$error&&!e.$v.newParticular.$error&&!e.$v.newAmount.$error){e.requestProcessing=!0,e.reimItems=[],e.items=[];var t=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),a=[],s="RII-"+h.getFullYear()+C(h.getMonth()+1,2)+h.getDate()+"-"+Math.floor(1e6*Math.random()),r=this.$router.currentRoute.params.id;t.get().then((function(t){t.forEach((function(e){a.push(e.data())})),i["dbExpense"].collection("reimbursementItems").doc().set({reimburseItemId:s,date:e.newDate,amount:e.newAmount,particular:e.newParticular,reimbursementReference:r,descriptionReference:e.desc,status:1,userReference:a[0].userId,dateCreated:h,dateModified:h}).then((function(){var t=i["dbExpense"].collection("reimbursements").where("reimbursementId","==",r),a=i["dbExpense"].collection("reimbursementItems").where("reimbursementReference","==",r),s=[],n=0,o="";a.get().then((function(a){a.forEach((function(e){s.push(e.data())})),t.get().then((function(t){t.forEach((function(e){o=e.id}));for(var a=0;a<s.length;a++)n=parseFloat(n)+parseFloat(s[a].amount.replaceAll(",",""));n=u(parseFloat(n).toFixed(2)),i["dbExpense"].collection("reimbursements").doc(o).update({totalAmount:n,dateModified:h}).then((function(){e.$swal({title:"Success",text:"New item added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.newDate=v().format("YYYY-MM-DD"),e.newParticular="",e.newAmount="",e.$v.newDate.$reset(),e.$v.newParticular.$reset(),e.$v.newAmount.$reset(),e.$bvModal.hide("new-reim-item-modal"),e.getReimbursement(),e.getReimItems(1),e.getReimTrans(1),e.requestProcessing=!1}))}))}))}))}))}))}},addTransReim:function(){var e=this;if(e.$v.newTransDate.$touch(),e.$v.newMode.$touch(),e.$v.newFrom.$touch(),e.$v.newTo.$touch(),e.$v.newPurpose.$touch(),e.$v.newTransAmount.$touch(),e.requestProcessing=!1,!e.$v.newTransDate.$error&&!e.$v.newMode.$error&&!e.$v.newFrom.$error&&!e.$v.newTo.$error&&!e.$v.newPurpose.$error&&!e.$v.newTransAmount.$error){e.requestProcessing=!0,e.reimTrans=[],e.trans=[];var t=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),a=[],s="RTI-"+h.getFullYear()+C(h.getMonth()+1,2)+h.getDate()+"-"+Math.floor(1e6*Math.random()),r=this.$router.currentRoute.params.id;t.get().then((function(t){t.forEach((function(e){a.push(e.data())})),i["dbExpense"].collection("reimbursementItems").doc().set({reimburseItemId:s,date:e.newTransDate,amount:e.newTransAmount,from:e.newFrom,to:e.newTo,transportationMode:e.newMode,purpose:e.newPurpose,reimbursementReference:r,descriptionReference:e.desc,status:1,userReference:a[0].userId,dateCreated:h,dateModified:h}).then((function(){var t=i["dbExpense"].collection("reimbursements").where("reimbursementId","==",r),a=i["dbExpense"].collection("reimbursementItems").where("reimbursementReference","==",r),s=[],n=0,o="";a.get().then((function(a){a.forEach((function(e){s.push(e.data())})),t.get().then((function(t){t.forEach((function(e){o=e.id}));for(var a=0;a<s.length;a++)n=parseFloat(n)+parseFloat(s[a].amount.replaceAll(",",""));n=u(parseFloat(n).toFixed(2)),i["dbExpense"].collection("reimbursements").doc(o).update({totalAmount:n,dateModified:h}).then((function(){e.$swal({title:"Success",text:"New item added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.newTransDate=v().format("YYYY-MM-DD"),e.newMode="",e.newFrom="",e.newTo="",e.newPurpose="",e.newTransAmount="",e.$v.newTransDate.$reset(),e.$v.newMode.$reset(),e.$v.newFrom.$reset(),e.$v.newTo.$reset(),e.$v.newPurpose.$reset(),e.$v.newTransAmount.$reset(),e.$bvModal.hide("new-trans-reim-modal"),e.getReimbursement(),e.getReimItems(1),e.getReimTrans(1),e.requestProcessing=!1}))}))}))}))}))}))}},openUpdateItemModal:function(e){this.editItem={id:e.id,date:e.date,particular:e.particular,amount:e.amount},this.$bvModal.show("update-reim-item-modal")},updateReimItem:function(){var e=this,t=this.$router.currentRoute.params.id;e.$v.editItem.$touch(),e.requestProcessing=!1,e.$v.editItem.$error||(e.requestProcessing=!0,i["dbExpense"].collection("reimbursementItems").doc(e.editItem.id).update({date:e.editItem.date,amount:e.editItem.amount,particular:e.editItem.particular,descriptionReference:e.desc,dateModified:h}).then((function(){var a=i["dbExpense"].collection("reimbursements").where("reimbursementId","==",t),s=i["dbExpense"].collection("reimbursementItems").where("reimbursementReference","==",t),r=[],n=0,o="";s.get().then((function(t){t.forEach((function(e){r.push(e.data())})),a.get().then((function(t){t.forEach((function(e){o=e.id}));for(var a=0;a<r.length;a++)n=parseFloat(n)+parseFloat(r[a].amount.replaceAll(",",""));n=u(parseFloat(n).toFixed(2)),i["dbExpense"].collection("reimbursements").doc(o).update({totalAmount:n,dateModified:h}).then((function(){e.$swal({title:"Success",text:"Item updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.$v.editItem.$reset(),e.$bvModal.hide("update-reim-item-modal"),e.getReimbursement(),e.getReimItems(1),e.requestProcessing=!1}))}))}))}))})))},openUpdateTransModal:function(e){this.editTrans={id:e.id,date:e.date,mode:e.transportationMode,from:e.from,to:e.to,purpose:e.purpose,amount:e.amount},this.$bvModal.show("update-trans-reim-modal")},updateTransReim:function(){var e=this;if(e.$v.editTrans.$touch(),e.requestProcessing=!1,!e.$v.editTrans.$error){e.requestProcessing=!0;var t=this.$router.currentRoute.params.id;i["dbExpense"].collection("reimbursementItems").doc(e.editTrans.id).update({date:e.editTrans.date,transportationMode:e.editTrans.mode,from:e.editTrans.from,to:e.editTrans.to,amount:e.editTrans.amount,purpose:e.editTrans.purpose,dateModified:h}).then((function(){var a=i["dbExpense"].collection("reimbursements").where("reimbursementId","==",t),s=i["dbExpense"].collection("reimbursementItems").where("reimbursementReference","==",t),r=[],n=0,o="";s.get().then((function(t){t.forEach((function(e){r.push(e.data())})),a.get().then((function(t){t.forEach((function(e){o=e.id}));for(var a=0;a<r.length;a++)n=parseFloat(n)+parseFloat(r[a].amount.replaceAll(",",""));n=u(parseFloat(n).toFixed(2)),i["dbExpense"].collection("reimbursements").doc(o).update({totalAmount:n,dateModified:h}).then((function(){e.$swal({title:"Success",text:"Transportation updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.$v.editTrans.$reset(),e.$bvModal.hide("update-trans-reim-modal"),e.getReimbursement(),e.getReimItems(1),e.getReimTrans(1),e.requestProcessing=!1}))}))}))}))}))}},removeItem:function(e){var t=this,a=this;a.$swal({title:"Are you sure?",text:"You want to remove this item?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(s){if(s.value){var r=t.$router.currentRoute.params.id;i["dbExpense"].collection("reimbursementItems").doc(e.id).delete().then((function(){var e=i["dbExpense"].collection("reimbursements").where("reimbursementId","==",r),t=i["dbExpense"].collection("reimbursementItems").where("reimbursementReference","==",r),s=[],n=0,o="";t.get().then((function(t){t.forEach((function(e){s.push(e.data())})),e.get().then((function(e){e.forEach((function(e){o=e.id}));for(var t=0;t<s.length;t++)n=parseFloat(n)+parseFloat(s[t].amount.replaceAll(",",""));n=u(parseFloat(n).toFixed(2)),i["dbExpense"].collection("reimbursements").doc(o).update({totalAmount:n,dateModified:h}).then((function(){a.$swal({title:"Success",text:"Item removed successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){a.getReimbursement(),a.getReimItems(1),a.getReimTrans(1),a.requestProcessing=!1}))}))}))}))}))}}))},removeTrans:function(e){var t=this,a=this;a.$swal({title:"Are you sure?",text:"You want to remove this transportation",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(s){if(s.value){var r=t.$router.currentRoute.params.id;i["dbExpense"].collection("reimbursementItems").doc(e.id).delete().then((function(){var e=i["dbExpense"].collection("reimbursements").where("reimbursementId","==",r),t=i["dbExpense"].collection("reimbursementItems").where("reimbursementReference","==",r),s=[],n=0,o="";t.get().then((function(t){t.forEach((function(e){s.push(e.data())})),e.get().then((function(e){e.forEach((function(e){o=e.id}));for(var t=0;t<s.length;t++)n=parseFloat(n)+parseFloat(s[t].amount.replaceAll(",",""));n=u(parseFloat(n).toFixed(2)),i["dbExpense"].collection("reimbursements").doc(o).update({totalAmount:n,dateModified:h}).then((function(){a.$swal({title:"Success",text:"Transportation removed successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){a.getReimbursement(),a.getReimItems(1),a.getReimTrans(1),a.requestProcessing=!1}))}))}))}))}))}}))},openUpdateReim:function(e){var t=this;t.editReim={id:e.id,processDate:e.processDate,status:e.status,company:e.companyReference,remarks:e.remarks},t.$bvModal.show("update-modal")},updateReim:function(){var e=this,t="",a="",s=!1;1!=e.editReim.status&&0!=e.editReim.status&&(a=e.editReim.processDate,t=v(e.editReim.processDate).format("YYYY-MM")),e.$v.editReim.$touch(),e.requestProcessing=!1,2==e.editReim.status?(e.$v.editReim.processDate.$error&&(s=!0),e.editReim.remarks=""):0==e.editReim.status?e.$v.editReim.remarks.$error&&(s=!0):1==e.editReim.status&&(e.editReim.remarks=""),s||(e.requestProcessing=!0,i["dbExpense"].collection("reimbursements").doc(e.editReim.id).update({processDate:a,monthOf:t,status:e.editReim.status,companyReference:e.editReim.company,remarks:e.editReim.remarks,dateModified:h}).then((function(){e.$swal({title:"Success",text:"Reimbursement updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.$v.editReim.$reset(),e.$bvModal.hide("update-modal"),e.getReimbursement(),e.getReimItems(1),e.getReimTrans(1),e.requestProcessing=!1}))})))},cancelView:function(){this.$router.push("/reimbursement")},getCompany:function(){var e=this,t=[],a=i["dbMains"].collection("companyProfile");e.company=[],a.get().then((function(a){a.forEach((function(e){t.push(e.data())})),e.company={name:t[0].name,address:t[0].address}}))},getDepartments:function(){var e=this,t=i["dbUsers"].collection("departments").orderBy("departmentName","asc");e.departments=[],t.get().then((function(t){t.forEach((function(t){e.departments.push(t.data())}))}))},getUser:function(e){if(""==e)self.$swal({title:"Warning",text:"The user ID is missing.",icon:"warning",confirmButtonColor:"#ef8157",confirmButtonText:"OK"});else if(""!=e){var t=this,a=i["dbUsers"].collection("users").where("username","==",e),s=[];a.get().then((function(e){e.forEach((function(e){s.push(e.data())})),t.user.firstname=s[0].firstname,t.user.lastname=s[0].lastname}))}},printReim:function(){this.$htmlToPaper("viewSummary")}}},g=w,y=(a("0dbd"),a("2877")),_=Object(y["a"])(g,s,r,!1,null,null,null);t["default"]=_.exports},ace6:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pt-4",attrs:{id:"textStyle"}},[a("div",{staticClass:"table-full-width"},[a("vue-good-table",{ref:"department-table",attrs:{columns:e.columns,rows:e.departments,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["departmentName"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.departmentName))])]):e._e(),"seriesCode"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.seriesCode))])]):e._e(),"userReference"==t.column.field?a("span",[e._l(e.users,(function(s){return a("span",{key:s.userId},[s.userId==t.row.userReference?a("span",[e._v(e._s(s.firstname)+" "+e._s(s.lastname))]):e._e()])})),""==t.row.userReference?a("span",[a("span",[e._v("----------")])]):e._e()],2):e._e(),"action"==t.column.field?a("span",[a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdateDepartmentModal(t.row)}}})]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.departments.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getPaginatedDepartments(1,"")}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-department-modal",modifiers:{"new-department-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Department")])],1)]),a("b-modal",{attrs:{size:"md",id:"new-department-modal",title:"New Department",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addDepartment(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v("Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-department-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Department Name:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Department"},model:{value:e.newDepartment,callback:function(t){e.newDepartment=t},expression:"newDepartment"}}),e.$v.newDepartment.$anyDirty&&!e.$v.newDepartment.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newDepartment.$anyDirty&&!e.$v.newDepartment.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Series Code:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Series Code"},model:{value:e.newSeriesCode,callback:function(t){e.newSeriesCode=t},expression:"newSeriesCode"}}),e.$v.newSeriesCode.$anyDirty&&!e.$v.newSeriesCode.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newSeriesCode.$anyDirty&&!e.$v.newSeriesCode.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])]),a("b-modal",{attrs:{size:"md",id:"update-department-modal",title:"Edit Department",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateDepartment(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("update-department-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Department:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Department"},model:{value:e.edit.department,callback:function(t){e.$set(e.edit,"department",t)},expression:"edit.department"}}),e.$v.edit.$anyDirty&&!e.$v.edit.department.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.department.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Series Code:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Series Code"},model:{value:e.edit.seriesCode,callback:function(t){e.$set(e.edit,"seriesCode",t)},expression:"edit.seriesCode"}}),e.$v.edit.$anyDirty&&!e.$v.edit.seriesCode.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.seriesCode.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])])],1)],1)},r=[],n=(a("99af"),a("4160"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),o=a("56d7"),l=a("b5ae"),c=a("7ff6"),d=a("2f62"),u=l["helpers"].regex("alphaNumAndDot",/^[ A-Za-z ]*$/),m=l["helpers"].regex("alphaNumAndDot",/^[ A-Za-z0-9 ]*$/),p=["#","Department","Series Code","Actions"],b=a("c1df"),f=new Date,v=a("9f25"),h={components:{},data:function(){return{columns:[{label:"Department",field:"departmentName"},{label:"Series Code",field:"seriesCode"},{label:"Created by",field:"userReference"},{label:"",field:"action",sortable:!1,width:"50px"}],loading:!0,loadError:!1,departmentTable:{title:"Department Table",subTitle:"",columns:[].concat(p)},departmentsCount:0,departments:[],currentPage:1,searchTerm:"",searching:!1,requestProcessing:!1,views:[{limitId:"20",limit:"20 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"20",newDepartment:"",newSeriesCode:"",edit:{id:"",departmentId:"",department:"",seriesCode:""}}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=o["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=o["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole||"Manager"==s[0].userRole?a("/main/home"):"Administrator"==s[0].userRole&&a()}))}}))},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getPaginatedDepartments(1,"");case 1:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(d["b"])({users:"Users/users"})),validations:{newDepartment:{required:l["required"],alphaCustomValidator:u},newSeriesCode:{required:l["required"],alphaNumCustomValidator:m},edit:{department:{required:l["required"],alphaCustomValidator:u},seriesCode:{required:l["required"],alphaNumCustomValidator:m}}},methods:{getPaginatedDepartments:function(e,t){var a=this,s=null,r=[],n=[];a.loading=!0,a.loadError=!1,a.departments=[],t&&(a.searching=!0),t?"all"!=a.limit?s=o["dbUsers"].collection("departments").where("departmentName","==",Object(c["a"])(t)).orderBy("dateCreated","asc").limit(a.limit):"all"==a.limit&&(s=o["dbUsers"].collection("departments").where("departmentName","==",Object(c["a"])(t)).orderBy("dateCreated","asc")):"all"!=a.limit?s=o["dbUsers"].collection("departments").orderBy("departmentName","asc").limit(a.limit):"all"==a.limit&&(s=o["dbUsers"].collection("departments").orderBy("departmentName","asc")),s.get().then((function(t){if(!t.empty){t.forEach((function(e){r.push(e.data()),n.push(e.id)})),r.sort((function(e,t){return e.departmentName-t.departmentName}));for(var s=0;s<r.length;s++)r[s]["rowNum"]=1+s,r[s]["id"]=n[s],r[s].dateCreated=b.unix(r[s].dateCreated.seconds),a.departments.push(r[s]);a.departmentsCount=r.length,a.currentPage=e}setTimeout((function(){a.loading=!1}),1e3)}))},onPageChange:function(e){var t=this.searchTerm;this.getPaginatedDepartments(e,t)},resetData:function(){this.searching=!1,""==this.searchTerm&&this.getPaginatedDepartments(1,"")},reloadData:function(){this.searchTerm="",this.searching=!1,this.getPaginatedDepartments(1,"")},search:function(){var e=this.searchTerm;e&&this.getPaginatedDepartments(1,e)},addDepartment:function(){var e=this;if(e.requestProcessing=!1,e.$v.newDepartment.$touch(),e.$v.newSeriesCode.$touch(),!e.$v.newDepartment.$error&&!e.$v.newSeriesCode.$error){var t=null,a=null;e.requestProcessing=!0,t=o["dbUsers"].collection("departments").where("departmentName","==",Object(c["a"])(e.newDepartment)),a=o["dbUsers"].collection("departments").where("seriesCode","==",e.newSeriesCode),t.get().then((function(t){t.empty?t&&a.get().then((function(t){if(t.empty){if(t){var a=o["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),s=[],r="DUID-"+f.getFullYear()+v(f.getMonth()+1,2)+f.getDate()+"-"+Math.floor(1e6*Math.random());a.get().then((function(t){t.forEach((function(e){e.exists&&s.push(e.data())}));try{o["dbUsers"].collection("departments").doc().set({departmentUid:r,departmentName:Object(c["a"])(e.newDepartment),seriesCode:e.newSeriesCode,userReference:s[0].userId,status:1,dateCreated:f,dateModified:f}).then((function(){e.newDepartment="",e.newSeriesCode="",e.requestProcessing=!1,e.$v.newDepartment.$reset(),e.$v.newSeriesCode.$reset(),e.$bvModal.hide("new-department-modal"),e.$refs["department-table"].reset(),e.getPaginatedDepartments(1,""),e.$swal({title:"Success",text:"New department added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}))}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Series code already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))})):t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Department name already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},openUpdateDepartmentModal:function(e){this.edit={id:e.id,departmentId:e.departmentUid,department:e.departmentName,seriesCode:e.seriesCode},this.$bvModal.show("update-department-modal")},updateDepartment:function(){var e=this;if(e.requestProcessing=!0,e.$v.edit.$touch(),!e.$v.edit.$error){var t=null,a=null;t=o["dbUsers"].collection("departments").where("departmentName","==",Object(c["a"])(e.edit.department)).where("departmentUid","!=",e.edit.departmentId),a=o["dbUsers"].collection("departments").where("seriesCode","==",Object(c["a"])(e.edit.seriesCode)).where("departmentUid","!=",e.edit.departmentId),t.get().then((function(t){t.empty?t&&a.get().then((function(t){if(t.empty){if(t)try{o["dbUsers"].collection("departments").doc(e.edit.id).update({departmentName:Object(c["a"])(e.edit.department),seriesCode:e.edit.seriesCode,dateModified:f}).then((function(){e.edit={},e.$v.edit.$reset(),e.$bvModal.hide("update-department-modal"),e.requestProcessing=!1,e.$refs["department-table"].reset(),e.getPaginatedDepartments(1,""),e.$swal({title:"Success",text:"Department updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Series code already exixts.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))})):t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Department already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}}}},C=h,w=(a("bb47"),a("2877")),g=Object(w["a"])(C,s,r,!1,null,null,null);t["default"]=g.exports},b04b:function(e,t,a){"use strict";a("d0ae")},b23c:function(e,t,a){},bb47:function(e,t,a){"use strict";a("c27b")},c27b:function(e,t,a){},c791:function(e,t,a){},cb7a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5 pt-md-5"},[a("card",{staticClass:"mt-5"},[a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"}),a("span",{staticClass:"col-2 pb-3 pl-4 text-right"},[a("b",[e._v("Filter by:")])]),a("span",{staticClass:"col-sm-2 pb-2 text-right"},[a("v-select",{staticStyle:{width:"150px"},attrs:{id:"inputStyle",options:e.filters,reduce:function(e){return e.filterId},label:"filter",clearable:!1,readonly:""},on:{input:function(t){return e.reloadData()}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),a("span",{staticClass:"col-sm-2 pl-0"},["month"==e.filter?a("base-input",{staticClass:"pb-2",staticStyle:{width:"230px"},attrs:{type:"month",max:e.maxDate,min:"1997-01",id:"inputStyle"},on:{input:function(t){return e.getPaginatedCashAdvance(e.listType)}},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}}):e._e()],1)]),a("div",{staticClass:"row pt-2"},[a("div",{staticClass:"col-sm-6"},[a("card-widget",{attrs:{icon:"fa fa-square",title:"Release",subTitle:e.releaseCAAmount,footerText:e.releaseCACount}})],1),a("div",{staticClass:"col-sm-6"},[a("card-widget",{attrs:{icon:"fa fa-check-square",title:"Cleared",subTitle:e.clearedCAAmount,footerText:e.clearedCACount}})],1)])])],1),a("div",{attrs:{id:"textStyle"}},[a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left ml-1 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-2 pointer"},["Release"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getPaginatedCashAdvance("Release")}}},[e._v("Release")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},["Cleared"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getPaginatedCashAdvance("Cleared")}}},[e._v("Cleared")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},["All"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getPaginatedCashAdvance("All")}}},[e._v("All")])])],1)]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{ref:"cash-advance-table",attrs:{columns:e.columns,rows:e.cashAdvances,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["name"==t.column.field?a("span",[a("span",{staticClass:"pointer",attrs:{id:"sideBarTxt"},on:{click:function(a){return e.openViewCashAdvanceModal(t.row)}}},[e._v(e._s(t.row.cashAdvanceName))])]):e._e(),"amount"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v("â‚± "+e._s(t.row.cashAdvanceAmount))])]):e._e(),"type"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.type))])]):e._e(),"caType"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.caType))])]):e._e(),"cashAdvanceDate"==t.column.field?a("span",[a("span",[e._v(e._s(e._f("moment")(t.row.cashAdvanceDate,"MMM DD, YYYY")))])]):e._e(),"userReference"==t.column.field?a("span",[e._l(e.users,(function(s){return a("span",{key:s.userId},[s.userId==t.row.userReference?a("span",[e._v(e._s(s.firstname)+" "+e._s(s.lastname))]):e._e()])})),""==t.row.userReference?a("span",[a("span",[e._v("----------")])]):e._e()],2):e._e(),"status"==t.column.field?a("span",[1==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("RELEASE")]):e._e(),2==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("CLEARED")]):e._e()]):e._e(),"action"==t.column.field?a("span",[1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdateCAModal(t.row)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-check-square",attrs:{id:"sideBarTxt",title:"Cleared"},on:{click:function(a){return e.changeStatus(t.row,2)}}}):e._e(),2==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-square",attrs:{id:"sideBarTxt",title:"Release"},on:{click:function(a){return e.changeStatus(t.row,1)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-times-circle",attrs:{id:"sideBarTxt",title:"Remove"},on:{click:function(a){return e.removeCA(t.row)}}}):e._e()]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),e.cashAdvances.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2 text-right"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getPaginatedCashAdvance(e.listType)}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-cash-advance-modal",modifiers:{"new-cash-advance-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Cash Advance")])],1)]),a("b-modal",{attrs:{size:"xl",id:"new-cash-advance-modal",title:"New Cash Advance",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.newCashAdvance(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-cash-advance-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Name:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",placeholder:"Name"},model:{value:e.newName,callback:function(t){e.newName=t},expression:"newName"}}),e.$v.newName.$anyDirty&&!e.$v.newName.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newName.$anyDirty&&!e.$v.newName.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",placeholder:"Amount"},model:{value:e.newAmount,callback:function(t){e.newAmount=t},expression:"newAmount"}}),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Release By:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Type:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.types,reduce:function(e){return e.type},label:"type",clearable:!1},model:{value:e.newType,callback:function(t){e.newType=t},expression:"newType"}}),e.$v.newType.$anyDirty&&!e.$v.newType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-4 pl-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.caTypes,reduce:function(e){return e.cashAdvanceTypeId},label:"type",clearable:!1},model:{value:e.newCAType,callback:function(t){e.newCAType=t},expression:"newCAType"}}),e.$v.newCAType.$anyDirty&&!e.$v.newCAType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-2 pr-5"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-cash-advance-type-modal",modifiers:{"new-cash-advance-type-modal":!0}}],attrs:{block:"",id:"darkBtn",disabled:e.requestProcessing}},[e._v("Add")])],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Reference:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date"},model:{value:e.newDate,callback:function(t){e.newDate=t},expression:"newDate"}}),e.$v.newDate.$anyDirty&&!e.$v.newDate.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",placeholder:"Reference"},model:{value:e.newReference,callback:function(t){e.newReference=t},expression:"newReference"}}),e.$v.newReference.$anyDirty&&!e.$v.newReference.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Desciption:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newDesc,expression:"newDesc"}],attrs:{rows:"4",cols:"59",id:"inputStyle",placeholder:"Desciption"},domProps:{value:e.newDesc},on:{input:function(t){t.target.composing||(e.newDesc=t.target.value)}}})])])]),a("b-modal",{attrs:{size:"md",id:"new-cash-advance-type-modal",title:"New Cash Advance Type",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addCAType(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-cash-advance-type-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Type:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Type"},model:{value:e.newCType,callback:function(t){e.newCType=t},expression:"newCType"}}),e.$v.newCType.$anyDirty&&!e.$v.newCType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newCType.$anyDirty&&!e.$v.newCType.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])]),a("b-modal",{attrs:{size:"md",id:"view-cash-advance-modal",title:"View Cash Advance",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("view-cash-advance-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Name:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("span",[e._v(e._s(e.view.cashAdvanceName))])])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Amount:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("span",[e._v(e._s(e.view.cashAdvanceAmount))])])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Date:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("span",[e._v(e._s(e._f("moment")(e.view.cashAdvanceDate,"MMMM DD, YYYY")))])])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Release Type:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("span",[e._v(e._s(e.view.type))])])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Cash Advance Type:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("span",[e._v(e._s(e.view.caType))])])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Reference:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("span",[e._v(e._s(e.view.reference))])])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Description:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("span",[e._v(e._s(e.view.description))])])])]),a("b-modal",{attrs:{size:"xl",id:"edit-cash-advance-modal",title:"Edit Cash Advance",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateCashAdvance(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-cash-advance-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Name:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",placeholder:"Name"},model:{value:e.edit.name,callback:function(t){e.$set(e.edit,"name",t)},expression:"edit.name"}}),e.$v.edit.$anyDirty&&!e.$v.edit.name.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.name.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",placeholder:"Amount"},model:{value:e.edit.amount,callback:function(t){e.$set(e.edit,"amount",t)},expression:"edit.amount"}}),e.$v.edit.$anyDirty&&!e.$v.edit.amount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.amount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Release By:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Type:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.types,reduce:function(e){return e.type},label:"type",clearable:!1},model:{value:e.edit.type,callback:function(t){e.$set(e.edit,"type",t)},expression:"edit.type"}}),e.$v.edit.$anyDirty&&!e.$v.edit.type.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.caTypes,reduce:function(e){return e.cashAdvanceTypeId},label:"type",clearable:!1},model:{value:e.edit.caType,callback:function(t){e.$set(e.edit,"caType",t)},expression:"edit.caType"}}),e.$v.edit.$anyDirty&&!e.$v.edit.caType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Reference:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date"},model:{value:e.edit.date,callback:function(t){e.$set(e.edit,"date",t)},expression:"edit.date"}}),e.$v.edit.$anyDirty&&!e.$v.edit.date.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",placeholder:"Reference"},model:{value:e.edit.reference,callback:function(t){e.$set(e.edit,"reference",t)},expression:"edit.reference"}}),e.$v.edit.$anyDirty&&!e.$v.edit.reference.alphaNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Desciption:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.desc,expression:"edit.desc"}],attrs:{rows:"4",cols:"59",id:"inputStyle",placeholder:"Desciption"},domProps:{value:e.edit.desc},on:{input:function(t){t.target.composing||e.$set(e.edit,"desc",t.target.value)}}})])])])],1)])],1)},r=[],n=(a("a4d3"),a("e01a"),a("4160"),a("b0c0"),a("b680"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),o=a("56d7"),l=a("b5ae"),c=a("c6f8"),d=a("2f62"),u=l["helpers"].regex("alphaNumAndDot",/^[ A-Za-z ., ]*$/),m=l["helpers"].regex("alphaNumAndDot",/^[ 0-9 ., ]*$/),p=l["helpers"].regex("alphaNumAndDot",/^[ A-Za-z0-9 -./, ]*$/),b=a("c1df"),f=a("e966"),v=f.bindWith(",","."),h=new Date,C=a("9f25"),w={components:{},data:function(){return{columns:[{label:"Name",field:"name"},{label:"Amount",field:"amount"},{label:"Release Type",field:"type"},{label:"CA Type",field:"caType"},{label:"Date",field:"cashAdvanceDate"},{label:"Created by",field:"userReference"},{label:"Status",field:"status"},{label:"",field:"action",width:"100px",sortable:!1}],loading:!0,cashAdvances:[],userRole:"",requestProcessing:!1,views:[{limitId:"30",limit:"30 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"30",filters:[{filterId:"month",filter:"Month"}],filter:"month",dateCreated:b().format("YYYY-MM"),maxDate:b().format("YYYY-MM"),listType:"",currentMonth:b().format("MMMM"),releaseCAAmount:"â‚± 0.00",releaseCACount:0,clearedCAAmount:"â‚± 0.00",clearedCACount:0,types:[{type:"Check"},{type:"Cash"},{type:"E Wallet"}],caTypes:[],newName:"",newAmount:"",newType:"Cash",newCAType:"",newDate:b().format("YYYY-MM-DD"),newReference:"",newDesc:"",newCType:"",view:{cashAdvanceName:"",cashAdvanceAmount:"",cashAdvanceDate:"",type:"",caType:"",reference:"",description:""},edit:{id:"",caId:"",name:"",amount:"",type:"",caType:"",date:"",reference:"",desc:""}}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=o["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=o["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Manager"!=s[0].userRole&&"Administrator"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUserRole(),e.getPaginatedCashAdvance("Release"),e.getCashAdvanceTypes();case 3:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(d["b"])({users:"Users/users"})),validations:{newName:{required:l["required"],alphaCustomValidator:u},newAmount:{required:l["required"],amountCustomValidator:m},newType:{required:l["required"]},newCAType:{required:l["required"]},newDate:{required:l["required"]},newReference:{alphaNumCustomValidator:p},newCType:{required:l["required"],alphaNumCustomValidator:p},edit:{name:{required:l["required"],alphaCustomValidator:u},amount:{required:l["required"],amountCustomValidator:m},type:{required:l["required"]},caType:{required:l["required"]},date:{required:l["required"]},reference:{alphaNumCustomValidator:p}}},methods:{getUserRole:function(){var e=this;e.username=localStorage.getItem("aisname"),e.accountName=e.username.toUpperCase();var t=o["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||t.forEach((function(e){a.push(e.data())}));var s=o["dbUsers"].collection("userRoles").where("userRoleId","==",a[0].userRoleReference),r=[];s.get().then((function(t){t.empty||(t.forEach((function(e){r.push(e.data())})),e.userRole=r[0].userRole)}))}))},getCashAdvanceTypes:function(){var e=this,t=o["dbExpense"].collection("cashAdvanceTypes");e.caTypes=[],t.get().then((function(t){t.forEach((function(t){e.caTypes.push(t.data())})),e.newCAType=e.caTypes[0].cashAdvanceTypeId}))},newCashAdvance:function(){var e=this;if(e.$v.newName.$touch(),e.$v.newAmount.$touch(),e.$v.newType.$touch(),e.$v.newCAType.$touch(),e.$v.newDate.$touch(),e.$v.newReference.$touch(),!e.$v.newName.$error&&!e.$v.newAmount.$error&&!e.$v.newType.$error&&!e.$v.newCAType.$error&&!e.$v.newDate.$error&&!e.$v.newReference.$error){e.requestProcessing=!0;try{var t=o["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),a=[],s="CAI-"+h.getFullYear()+C(h.getMonth()+1,2)+h.getDate()+"-"+Math.floor(1e6*Math.random());t.get().then((function(t){t.forEach((function(e){a.push(e.data())})),o["dbExpense"].collection("cashAdvances").doc().set({cashAdvanceId:s,cashAdvanceName:e.newName,cashAdvanceAmount:e.newAmount,type:e.newType,caTypeReference:e.newCAType,cashAdvanceDate:e.newDate,reference:e.newReference,description:e.newDesc,status:1,userReference:a[0].userId,dateCreated:h,dateModified:h}).then((function(){e.newName="",e.newAmount="",e.newType="Cash",e.newCAType="",e.newReference="",e.newDate=b().format("YYYY-MM-DD"),e.requestProcessing=!1,e.$v.newName.$reset(),e.$v.newAmount.$reset(),e.$v.newType.$reset(),e.$v.newCAType.$reset(),e.$v.newDate.$reset(),e.$v.newReference.$reset(),e.$bvModal.hide("new-cash-advance-modal"),e.$refs["cash-advance-table"].reset(),e.getPaginatedCashAdvance(e.listType),e.$swal({title:"Success",text:"New cash advance added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}))}catch(r){console.log(r),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}},addCAType:function(){var e=this;if(e.requestProcessing=!1,e.$v.newCType.$touch(),!e.$v.newCType.$error){var t=null;e.requestProcessing=!0,t=o["dbExpense"].collection("cashAdvanceTypes").where("type","==",Object(c["a"])(e.newCType)),t.get().then((function(t){if(t.empty){if(t){var a=o["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),s=[],r="CATI-"+h.getFullYear()+C(h.getMonth()+1,2)+h.getDate()+"-"+Math.floor(1e6*Math.random());a.get().then((function(t){t.forEach((function(e){e.exists&&s.push(e.data())}));try{o["dbExpense"].collection("cashAdvanceTypes").doc().set({cashAdvanceTypeId:r,type:Object(c["a"])(e.newCType),userReference:s[0].userId,status:1,dateCreated:h,dateModified:h}).then((function(){e.newType="",e.requestProcessing=!1,e.$v.newType.$reset(),e.$bvModal.hide("new-cash-advance-type-modal"),e.getCashAdvanceTypes(),e.$swal({title:"Success",text:"New cash advance type added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}))}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Cash Advance type already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},getPaginatedCashAdvance:function(e){var t=this,a=null,s=[],r=[],n=b(t.dateCreated).startOf("month").format("YYYY-MM-DD"),i=b(t.dateCreated).endOf("month").format("YYYY-MM-DD");t.loading=!0,t.cashAdvances=[],t.listType=e,"Release"==e?"all"!=t.limit?a=o["dbExpense"].collection("cashAdvances").where("cashAdvanceDate",">=",n).where("cashAdvanceDate","<=",i).where("status","==",1).limit(t.limit):"all"==t.limit&&(a=o["dbExpense"].collection("cashAdvances").where("cashAdvanceDate",">=",n).where("cashAdvanceDate","<=",i).where("status","==",1)):"Cleared"==e?"all"!=t.limit?a=o["dbExpense"].collection("cashAdvances").where("cashAdvanceDate",">=",n).where("cashAdvanceDate","<=",i).where("status","==",2).limit(t.limit):"all"==t.limit&&(a=o["dbExpense"].collection("cashAdvances").where("cashAdvanceDate",">=",n).where("cashAdvanceDate","<=",i).where("status","==",2)):"All"==e&&("all"!=t.limit?a=o["dbExpense"].collection("cashAdvances").where("cashAdvanceDate",">=",n).where("cashAdvanceDate","<=",i).limit(t.limit):"all"==t.limit&&(a=o["dbExpense"].collection("cashAdvances").where("cashAdvanceDate",">=",n).where("cashAdvanceDate","<=",i))),a.get().then((function(e){if(!e.empty){e.forEach((function(e){r.push(e.data()),s.push(e.id)}));var a=o["dbExpense"].collection("cashAdvanceTypes"),n=[];a.get().then((function(e){e.forEach((function(e){n.push(e.data())}));for(var a=0;a<r.length;a++){r[a]["id"]=s[a],r[a]["caType"]="",r[a].cashAdvanceAmount=v(parseFloat(r[a].cashAdvanceAmount.replaceAll(",","")).toFixed(2)),t.cashAdvances.push(r[a]);for(var i=0;i<n.length;i++)n[i].cashAdvanceTypeId==r[a].caTypeReference&&(r[a].caType=n[i].type)}}))}setTimeout((function(){t.loading=!1}),1e3),t.getCAData()}))},getCAData:function(){var e=this,t=b(e.dateCreated).startOf("month").format("YYYY-MM-DD"),a=b(e.dateCreated).endOf("month").format("YYYY-MM-DD"),s=[],r=null;r=o["dbExpense"].collection("cashAdvances").where("cashAdvanceDate",">=",t).where("cashAdvanceDate","<=",a).where("status","in",[1,2]),r.get().then((function(t){t.forEach((function(e){s.push(e.data())}));var a=0,r=0;e.releaseCACount=0,e.clearedCACount=0,e.releaseCAAmount=0,e.clearedCAAmount=0;for(var n=0;n<s.length;n++)1==s[n].status?(a=parseFloat(a)+parseFloat(s[n].cashAdvanceAmount.replaceAll(",","")),e.releaseCACount+=1):2==s[n].status&&(r=parseFloat(r)+parseFloat(s[n].cashAdvanceAmount.replaceAll(",","")),e.clearedCACount+=1);e.releaseCAAmount="â‚± "+v(a.toFixed(2)),e.clearedCAAmount="â‚± "+v(r.toFixed(2))}))},openViewCashAdvanceModal:function(e){var t=this;t.view={cashAdvanceName:e.cashAdvanceName,cashAdvanceAmount:e.cashAdvanceAmount,cashAdvanceDate:e.cashAdvanceDate,type:e.type,caType:e.caType,reference:e.reference,description:e.description},t.$bvModal.show("view-cash-advance-modal")},openUpdateCAModal:function(e){var t=this;t.edit={id:e.id,caId:e.cashAdvanceId,name:e.cashAdvanceName,amount:e.cashAdvanceAmount,type:e.type,caType:e.caTypeReference,reference:e.reference,date:e.cashAdvanceDate,desc:e.description},t.$bvModal.show("edit-cash-advance-modal")},updateCashAdvance:function(){var e=this;if(e.$v.edit.$touch(),!e.$v.edit.$error){e.requestProcessing=!0;try{o["dbExpense"].collection("cashAdvances").doc(e.edit.id).update({cashAdvanceName:e.edit.name,cashAdvanceAmount:e.edit.amount,cashAdvanceDate:e.edit.date,type:e.edit.type,caTypeReference:e.edit.caType,description:e.edit.desc,dateModified:h}).then((function(){e.edit={id:"",catId:"",name:"",amount:"",date:"",type:"",caType:"",reference:""},e.requestProcessing=!1,e.$v.edit.$reset(),e.$bvModal.hide("edit-cash-advance-modal"),e.$refs["cash-advance-table"].reset(),e.getPaginatedCashAdvance(e.listType),e.$swal({title:"Success",text:"Cash advance updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}},changeStatus:function(e,t){var a=this,s="";1==t?s="Release":2==t&&(s="Cleared"),a.$swal({title:"Are you sure?",text:"You want to change the status to "+s,icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(r){r.value&&o["dbExpense"].collection("cashAdvances").doc(e.id).update({status:t,dateModified:h}).then((function(){a.getPaginatedCashAdvance(s),a.$swal({title:"Success",text:"Cash advance status change successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}))},removeCA:function(e){var t=this;t.$swal({title:"Are you sure?",text:"You want to remove this Cash Advance",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(a){a.value&&o["dbExpense"].collection("cashAdvances").doc(e.id).delete().then((function(){t.$refs["cash-advance-table"].reset(),t.getPaginatedCashAdvance(t.listType),t.$swal({title:"Success",text:"Cash advance remove successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}))}}},g=w,y=(a("976e"),a("2877")),_=Object(y["a"])(g,s,r,!1,null,null,null);t["default"]=_.exports},cc1e:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"textStyle"}},[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[a("div",{staticClass:"card-header bg-transparent pb-5"},[a("div",{staticClass:"row pt-2 mb-1"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Bank:")])]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Account Number:")])])]),a("div",{staticClass:"row mb-2"},[a("span",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.banks,reduce:function(e){return e.bankUid},label:"bank",clearable:!1},on:{input:function(t){return e.getBankAccounts(e.bank)}},model:{value:e.bank,callback:function(t){e.bank=t},expression:"bank"}}),e.$v.bank.$anyDirty&&!e.$v.bank.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),""==e.bankAccounts?a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("span",{staticClass:"text-Red"},[e._v(" No Bank Account ")])]):a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.bankAccounts,reduce:function(e){return e.bankAccountUid},label:"bankAccountNumber",clearable:!1},on:{input:function(t){return e.getCheckSeries(e.bank,e.bankAccount)}},model:{value:e.bankAccount,callback:function(t){e.bankAccount=t},expression:"bankAccount"}}),e.$v.bankAccount.$anyDirty&&!e.$v.bankAccount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"row mb-1"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Choose Series:")])])]),a("div",{staticClass:"row mb-2"},[""==e.bankSeries||""==e.bankAccounts?a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("span",{staticClass:"text-red"},[e._v(" No Check Series ")])]):a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.bankSeries,reduce:function(e){return e.bankCheckSeriesUid},label:"bankCheckSeries",clearable:!1},model:{value:e.series,callback:function(t){e.series=t},expression:"series"}}),e.$v.series.$anyDirty&&!e.$v.series.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-button",{attrs:{block:"",id:"darkBtn"},nativeOn:{click:function(t){return e.getCheckSeriesReports(1)}}},[e._v("Submit")])],1)])]),a("div",{staticClass:"row mb-0"},[a("span",{staticClass:"col-2 pt-2 pl-3 text-right"},[a("b",[e._v("Filter by:")])]),a("span",{staticClass:"col-sm-2 pt-2 text-right"},[a("v-select",{staticStyle:{width:"150px"},attrs:{id:"inputStyle",options:e.status,reduce:function(e){return e.statusId},label:"status",clearable:!1},model:{value:e.stat,callback:function(t){e.stat=t},expression:"stat"}})],1),a("span",{staticClass:"col-sm-2 pt-2 text-right"},["all"!=e.stat&&"unused"!=e.stat&&"current"!=e.stat&&"skip"!=e.stat&&"cancelled"!=e.stat?a("v-select",{staticStyle:{width:"150px"},attrs:{id:"inputStyle",options:e.filters,reduce:function(e){return e.filterId},label:"filter",clearable:!1},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}):e._e()],1),"all"!=e.stat&&"unused"!=e.stat&&"current"!=e.stat&&"skip"!=e.stat&&"cancelled"!=e.stat?a("span",{staticClass:"col-sm-2 pl-0"},["dateCreated"==e.filter?a("base-input",{staticClass:"pt-2",staticStyle:{width:"200px"},attrs:{id:"inputStyle",type:"month",max:e.maxDate,min:"1997-01"},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}}):e._e(),"checkDate"==e.filter?a("base-input",{staticClass:"pt-2",staticStyle:{width:"200px"},attrs:{id:"inputStyle",type:"month",min:"1997-01"},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}}):e._e()],1):e._e()]),a("vue-good-table",{attrs:{columns:e.columns,rows:e.checkSeriesReports,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0,initialSortBy:{field:"checkNumber",type:"desc"}},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return["bankCheckDate"==t.column.field?a("span",[a("span",[e._v(e._s(""==t.row.bankCheckDate?"----------":t.row.bankCheckDate))])]):e._e(),"checkNumber"==t.column.field?a("span",[a("span",{attrs:{id:"particular"}},[e._v(e._s(t.row.checkNumber))])]):e._e(),"payee"==t.column.field?a("span",[a("span",[e._v(e._s(""==t.row.payee?"----------":t.row.payee))])]):e._e(),"voucherNumber"==t.column.field?a("span",[a("span",[e._v(e._s(""==t.row.voucherNumber?"----------":t.row.voucherNumber))])]):e._e(),"bankCheckAmount"==t.column.field?a("span",[a("span",[e._v(e._s(""==t.row.bankCheckAmount?"----------":t.row.bankCheckAmount))])]):e._e(),"createdBy"==t.column.field?a("span",[a("span",[e._v(e._s(""==t.row.createdBy?"----------":t.row.createdBy))])]):e._e(),"status"==t.column.field?a("span",["current"==t.row.status?a("span",{attrs:{id:"goldTxt"}},[e._v("CURRENT")]):e._e(),"used"==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("USED")]):e._e(),"unused"==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("UNUSED")]):e._e(),"skip"==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("SKIP")]):e._e(),"cancelled"==t.row.status?a("span",{attrs:{id:"redTxt"}},[e._v("CANCELLED")]):e._e()]):e._e()]}}])}),e.checkSeriesReports.length>0?a("hr",{staticClass:"mb-2 mt-2"}):e._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-9"}),a("div",{staticClass:"col-sm-3"},[e.checkSeriesReports.length>0?a("base-button",{attrs:{block:"",id:"darkBtn"},nativeOn:{click:function(t){return e.printCheckReports()}}},[e._v("Print")]):e._e()],1)])],1)],1)],1)},r=[],n=(a("99af"),a("4de4"),a("4160"),a("fb6a"),a("b680"),a("ac1f"),a("841c"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),o=a("56d7"),l=a("b5ae"),c=a("add5"),d=a.n(c),u=a("2f62"),m=["#","Check Date","Check No.","Payee","Voucher No.","Amount","Status"],p=a("c1df"),b=new Date,f=a("e966"),v=f.bindWith(",","."),h={components:{},data:function(){return{columns:[{label:"Check Date",field:"bankCheckDate"},{label:"Check No",field:"checkNumber"},{label:"Payee",field:"payee"},{label:"Voucher No",field:"voucherNumber"},{label:"Amount",field:"bankCheckAmount"},{label:"Created by",field:"createdBy"},{label:"Status",field:"status",sortable:!1}],loading:!1,loadError:!1,checkSeriesTable:{title:"Bank Reconciliation Table",subTitle:"",columns:[].concat(m)},checkSeriesReports:[],bankChecks:[],checkSeries:[],banks:[],bankAccounts:[],bankSeries:[],reportData:[],suppliers:[],bank:"",bankAccount:"",series:"",currentPage:1,status:[{statusId:"used",status:"Used"},{statusId:"unused",status:"Unused"},{statusId:"current",status:"Current"},{statusId:"cancelled",status:"Cancelled"},{statusId:"skip",status:"Skip"},{statusId:"all",status:"All"}],stat:"used",filters:[{filterId:"dateCreated",filter:"Date Created"},{filterId:"checkDate",filter:"Check Date"},{filterId:"all",filter:"All"}],filter:"dateCreated",dateCreated:p().format("YYYY-MM"),maxDate:p().format("YYYY-MM")}},validations:{bank:{required:l["required"]},bankAccount:{required:l["required"]},series:{required:l["required"]}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=o["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=o["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Manager"!=s[0].userRole&&"Administrator"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getBanks(),e.getSuppliers();case 2:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(u["b"])({users:"Users/users"})),methods:{closePage:function(){this.$router.push("/check/dashboard")},onPageChange:function(e){this.getCheckSeriesReports(e)},getBanks:function(){var e=this,t=o["dbMains"].collection("banks").orderBy("bank","asc");e.banks=[],e.checkSeries=[],e.bankChecks=[],e.reportData=[],e.checkSeriesReports=[],t.get().then((function(t){t.forEach((function(t){e.banks.push(t.data())})),e.bank=e.banks[0].bankUid,e.getBankAccounts(e.banks[0].bankUid)}))},getBankAccounts:function(e){var t=this,a=o["dbMains"].collection("bankAccounts").where("bankReference","==",e);t.bankAccounts=[],t.checkSeries=[],t.bankChecks=[],t.reportData=[],t.checkSeriesReports=[],t.bankAccount="",a.get().then((function(e){e.forEach((function(e){t.bankAccounts.push(e.data())})),0!=t.bankAccounts.length&&(t.bankAccount=t.bankAccounts[0].bankAccountUid,t.getCheckSeries(t.bank,t.bankAccount))}))},getCheckSeries:function(e,t){var a=this,s=o["dbMains"].collection("bankCheckSeries").where("bankReference","==",e).where("bankAccountReference","==",t).orderBy("bankCheckSeries","asc");a.bankSeries=[],a.checkSeries=[],a.bankChecks=[],a.reportData=[],a.checkSeriesReports=[],a.series="",s.get().then((function(e){e.forEach((function(e){a.bankSeries.push(e.data())})),a.series=a.bankSeries[0].bankCheckSeriesUid}))},getSuppliers:function(){var e=this,t=o["db"].collection("suppliers").orderBy("supplier","asc");e.suppliers=[],t.get().then((function(t){t.forEach((function(t){e.suppliers.push(t.data())}))}))},getCheckSeriesReports:function(e){var t=this,a=null,s=null;if(t.checkSeries=[],t.bankChecks=[],t.reportData=[],t.checkSeriesReports=[],t.$v.bank.$touch(),t.$v.bankAccount.$touch(),t.$v.series.$touch(),!t.$v.bank.$error&&!t.$v.bankAccount.$error&&!t.$v.series.$error){var r=p(t.dateCreated).startOf("month").format("YYYY-MM-DD"),n=p(t.dateCreated).endOf("month").format("YYYY-MM-DD");if("used"==t.stat)if("all"==t.filter)a=o["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",t.series).where("status","==",t.stat).orderBy("checkNumber","asc"),s=o["db"].collection("bankChecks").where("bankCheckSeriesReference","==",t.series).where("status","in",[1,2,3]);else if("dateCreated"==t.filter){var i=new Date(r),l=new Date(n);a=o["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",t.series).where("status","==",t.stat),s=o["db"].collection("bankChecks").where("bankCheckSeriesReference","==",t.series).where("dateCreated",">=",i).where("dateCreated","<=",l).where("status","in",[1,2,3])}else"checkDate"==t.filter&&(a=o["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",t.series).where("status","==",t.stat),s=o["db"].collection("bankChecks").where("bankCheckSeriesReference","==",t.series).where("bankCheckDate",">=",r).where("bankCheckDate","<=",n).where("status","in",[1,2,3]));else"cancelled"==t.stat?(a=o["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",t.series).where("status","==",t.stat).orderBy("checkNumber","asc"),s=o["db"].collection("bankChecks").where("bankCheckSeriesReference","==",t.series).where("status","==",0)):"current"==t.stat||"unused"==t.stat||"skip"==t.stat?(a=o["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",t.series).where("status","==",t.stat).orderBy("checkNumber","asc"),s=o["db"].collection("bankChecks").where("bankCheckSeriesReference","==",t.series)):"all"==t.stat&&(a=o["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",t.series).orderBy("checkNumber","asc"),s=o["db"].collection("bankChecks").where("bankCheckSeriesReference","==",t.series));var c=[],d=[];a.get().then((function(a){a.forEach((function(e){c.push(e.data())})),t.checkSeries=c,t.checkSeries.sort((function(e,t){return t.checkNumber-e.checkNumber})),s.get().then((function(a){a.forEach((function(e){d.push(e.data())})),t.bankChecks=d,"used"==t.stat&&(t.bankChecks.length<=0&&(t.checkSeries=[]),t.checkSeries.length<=0&&(t.checkSeries=[]));for(var s=0,r=0;r<t.checkSeries.length;r++){t.checkSeries[r]["payee"]="",t.checkSeries[r]["bankCheckDate"]="",t.checkSeries[r]["voucherNumber"]="",t.checkSeries[r]["bankCheckAmount"]="",t.checkSeries[r]["createdBy"]="";for(var n=0;n<t.bankChecks.length;n++)if(t.checkSeries[r].checkNumber==t.bankChecks[n].bankCheckNumber){for(var i=0;i<t.suppliers.length;i++)t.bankChecks[n].payeeReference==t.suppliers[i].supplierId&&(t.checkSeries[r].payee=t.suppliers[i].supplier);for(var o=0;o<t.users.length;o++)t.users[o].userId==t.bankChecks[n].userReference&&(t.checkSeries[r].createdBy=t.users[o].firstname+" "+t.users[o].lastname);t.checkSeries[r].bankCheckDate=p(t.bankChecks[n].bankCheckDate).format("MMM DD, YYYY"),t.checkSeries[r].voucherNumber=t.bankChecks[n].voucherNumber,t.checkSeries[r].bankCheckAmount="â‚± "+v(parseFloat(t.bankChecks[n].bankCheckAmount).toFixed(2)),"used"==t.stat&&(s++,t.checkSeries[r]["rowNum"]=s,t.reportData.push(t.checkSeries[r]))}"used"!=t.stat&&(s++,t.checkSeries[r]["rowNum"]=s,t.reportData.push(t.checkSeries[r]))}for(var l=0;l<t.reportData.length;l++)t.checkSeriesReports.push(t.reportData[l]);t.currentPage=e}))})),t.$v.bank.$reset(),t.$v.bankAccount.$reset(),t.$v.series.$reset()}},cancelCheck:function(e){var t=this;this.$swal({title:"Are you sure?",text:"You want to cancel this Check Number",icon:"warning",showCancelButton:!0,confirmButtonColor:"#096b85",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(a){if(a.value){var s=o["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",e.checkSeriesReference).where("checkNumber","==",e.checkNumber),r="",n=e.status;s.get().then((function(a){a.forEach((function(e){r=e.id})),o["db"].collection("bankCheckSeriesReports").doc(r).update({status:"cancelled",dateModified:b}).then((function(){if("current"==n){var a=o["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",e.checkSeriesReference).where("status","==","unused").orderBy("checkNumber","asc").startAfter(e.checkNumber),s="";a.limit(1).get().then((function(e){e.empty||(e.forEach((function(e){s=e.id})),o["db"].collection("bankCheckSeriesReports").doc(s).update({status:"current",dateModified:b}))}))}t.$swal({title:"Success",text:"Check number cancelled successfully",icon:"success",confirmButtonColor:"#096b85",confirmButtonText:"OK"}).then((function(){t.getCheckSeriesReports(1)}))})).catch((function(e){console.log(e),t.requestProcessing=!1,t.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#096b85",confirmButtonText:"OK"})}))}))}}))},printCheckReports:function(){var e=this,t=o["dbMains"].collection("banks").where("bankUid","==",this.bank),a=o["dbMains"].collection("bankAccounts").where("bankAccountUid","==",this.bankAccount),s=o["dbMains"].collection("bankCheckSeries").where("bankCheckSeriesUid","==",this.series),r=o["db"].collection("suppliers").orderBy("supplier","asc"),n="",i="",l="",c=[],u=[];t.get().then((function(t){t.forEach((function(e){n=e.data().bank})),a.get().then((function(t){t.forEach((function(e){i=e.data().bankAccountNumber})),s.get().then((function(t){t.forEach((function(e){l=e.data().bankCheckSeries})),r.get().then((function(t){t.forEach((function(e){c.push(e.data())})),u=e.reportData;for(var a=0;a<u.length;a++){for(var s="",r=0;r<c.length;r++)u[a].payeeReference==c[r].supplierId&&(s=c[r].supplier);""!=s?u[a]["payee"]=s:""==s&&(u[a]["payee"]="")}var o=l.search("-"),m=l.slice(0,o);d()({printable:u,properties:[{field:"checkNumber",displayName:"Check Number"},{field:"payee",displayName:"Check Payee"},{field:"bankCheckDate",displayName:"Check Date"},{field:"voucherNumber",displayName:"Voucher No."},{field:"bankCheckAmount",displayName:"Amount"},{field:"status",displayName:"Status"}],type:"json",header:"<h2>"+n+"</h2><h4>Account Number: "+i+"</h4><h4>Series Number: "+m.slice(0,m.length-1)+"</h4><h5>Check Reports ("+p().format("MMMM DD, YYYY")+")</h5>",style:'td { text-align: center; } body { font-family: "Calibri"; }',documentTitle:n+" Check Reports of "+p().format("MMMM YYYY")})}))}))}))}))}}},C=h,w=a("2877"),g=Object(w["a"])(C,s,r,!1,null,null,null);t["default"]=g.exports},d03b:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"textStyle"}},[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[a("div",{staticClass:"form-group row pt-2 mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Firstname:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Middlename:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Firstname"},model:{value:e.newFirstname,callback:function(t){e.newFirstname=t},expression:"newFirstname"}}),e.$v.newFirstname.$anyDirty&&!e.$v.newFirstname.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newFirstname.$anyDirty&&!e.$v.newFirstname.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Middlename"},model:{value:e.newMiddlename,callback:function(t){e.newMiddlename=t},expression:"newMiddlename"}}),e.$v.newMiddlename.$anyDirty&&!e.$v.newMiddlename.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newMiddlename.$anyDirty&&!e.$v.newMiddlename.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Lastname:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Email Address:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Lastname"},model:{value:e.newLastname,callback:function(t){e.newLastname=t},expression:"newLastname"}}),e.$v.newLastname.$anyDirty&&!e.$v.newLastname.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newLastname.$anyDirty&&!e.$v.newLastname.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Email Address"},model:{value:e.newEmailAddress,callback:function(t){e.newEmailAddress=t},expression:"newEmailAddress"}}),e.$v.newEmailAddress.$anyDirty&&!e.$v.newEmailAddress.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newEmailAddress.$anyDirty&&!e.$v.newEmailAddress.email?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Contact Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Username:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Contact Number"},model:{value:e.newContactNumber,callback:function(t){e.newContactNumber=t},expression:"newContactNumber"}}),e.$v.newContactNumber.$anyDirty&&!e.$v.newContactNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newContactNumber.$anyDirty&&!e.$v.newContactNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Username"},model:{value:e.newUsername,callback:function(t){e.newUsername=t},expression:"newUsername"}}),e.$v.newUsername.$anyDirty&&!e.$v.newUsername.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Password:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("User Role:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"password",id:"inputStyle",placeholder:"Password"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),e.$v.newPassword.$anyDirty&&!e.$v.newPassword.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.userRoles,reduce:function(e){return e.userRoleId},label:"userRole"},model:{value:e.newUserRole,callback:function(t){e.newUserRole=t},expression:"newUserRole"}}),e.$v.newUserRole.$anyDirty&&!e.$v.newUserRole.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Department:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.departments,reduce:function(e){return e.departmentUid},label:"departmentName"},model:{value:e.newDepartment,callback:function(t){e.newDepartment=t},expression:"newDepartment"}}),e.$v.newDepartment.$anyDirty&&!e.$v.newDepartment.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1)]),a("hr"),a("div",{staticClass:"text-center"},[a("base-button",{staticClass:"col-md-2 ml-2",attrs:{id:"darkBtn"},nativeOn:{click:function(t){return e.addUser(t)}}},[e._v("Save")]),a("base-button",{staticClass:"col-md-2 ml-2",attrs:{id:"darkInlineBtn"},nativeOn:{click:function(t){return e.cancelNewUser(t)}}},[e._v("Close")])],1)])],1)],1)},r=[],n=(a("4160"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=o["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),c=o["helpers"].regex("alphaNumAndDot",/^[ A-Za-z ]*$/),d=new Date,u=a("9f25"),m=a("323d"),p={components:{},data:function(){return{userRoles:[],departments:[],newFirstname:"",newMiddlename:"",newLastname:"",newEmailAddress:"",newContactNumber:"",newUsername:"",newPassword:"",newUserRole:"",newDepartment:"",requestProcessing:!1}},validations:{newFirstname:{required:o["required"],alphaCustomValidator:c},newMiddlename:{required:o["required"],alphaCustomValidator:c},newLastname:{required:o["required"],alphaCustomValidator:c},newEmailAddress:{required:o["required"],email:o["email"]},newContactNumber:{required:o["required"],numCustomValidator:l},newUsername:{required:o["required"]},newPassword:{required:o["required"]},newUserRole:{required:o["required"]},newDepartment:{required:o["required"]}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=i["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=i["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"Administrator"!=s[0].userRole?a("/main/home"):a()}))}}))},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getRoles(),e.getDepartments();case 2:case"end":return t.stop()}}),t)})))()},methods:{getRoles:function(){var e=this,t=i["dbUsers"].collection("userRoles").orderBy("userRole","asc");e.userRoles=[],t.get().then((function(t){t.forEach((function(t){e.userRoles.push(t.data())})),e.newUserRole=e.userRoles[0].userRoleId}))},getDepartments:function(){var e=this,t=i["dbUsers"].collection("departments").orderBy("departmentName","asc");e.departments=[],t.get().then((function(t){t.forEach((function(t){e.departments.push(t.data())})),e.newDepartment=e.departments[0].departmentUid}))},addUser:function(){var e=this,t=!0,a=localStorage.getItem("aisname");if(e.requestProcessing=!1,e.$v.newFirstname.$touch(),e.$v.newMiddlename.$touch(),e.$v.newLastname.$touch(),e.$v.newEmailAddress.$touch(),e.$v.newContactNumber.$touch(),e.$v.newUsername.$touch(),e.$v.newPassword.$touch(),e.$v.newUserRole.$touch(),e.$v.newDepartment.$touch(),e.$v.newFirstname.$error||e.$v.newMiddlename.$error||e.$v.newLastname.$error||e.$v.newEmailAddress.$error||e.$v.newContactNumber.$error||e.$v.newUsername.$error||e.$v.newPassword.error||e.$v.newUserRole.$error||e.$v.newDepartment.$error||(t=!1),!t){var s=i["dbUsers"].collection("users").where("username","==",e.newUsername),r=i["dbUsers"].collection("users").where("firstname","==",e.newFirstname).where("middlename","==",e.newMiddlename).where("lastname","==",e.newLastname),n=i["dbUsers"].collection("users").where("emailAddress","==",e.newEmailAddress),o=i["dbUsers"].collection("users").where("contactNumber","==",e.newContactNumber);e.requestProcessing=!0,s.get().then((function(t){t.empty?r.get().then((function(t){t.empty?n.get().then((function(t){t.empty?o.get().then((function(t){if(t.empty){var s=i["dbUsers"].collection("users").where("username","==",a),r=[],n="UAI-"+d.getFullYear()+u(d.getMonth()+1,2)+d.getDate()+"-"+Math.floor(1e6*Math.random());s.get().then((function(t){t.forEach((function(e){e.exists&&r.push(e.data())}));try{i["dbUsers"].collection("users").doc().set({userId:n,firstname:e.newFirstname,middlename:e.newMiddlename,lastname:e.newLastname,emailAddress:e.newEmailAddress,contactNumber:e.newContactNumber,username:e.newUsername,password:m.generate(e.newPassword),userRoleReference:e.newUserRole,departmentReference:e.newDepartment,userReference:r[0].userId,status:1,dateCreated:d,dateModified:d,createdBy:a}).then((function(){var t="AKI-"+d.getFullYear()+u(d.getMonth()+1,2)+d.getDate()+"-"+Math.floor(1e6*Math.random());i["dbUsers"].collection("accountKeys").doc().set({accountKeyId:t,userReference:n,secretKey:Math.floor(1e10*Math.random()+1),dateCreated:d,dateModified:d}).then((function(){e.newFirstname="",e.newMiddlename="",e.newLastname="",e.newEmailAddress="",e.newContactNumber="",e.newUsername="",e.newPassword="",e.newDepartment="",e.$v.newFirstname.$reset(),e.$v.newMiddlename.$reset(),e.$v.newLastname.$reset(),e.$v.newEmailAddress.$reset(),e.$v.newContactNumber.$reset(),e.$v.newUsername.$reset(),e.$v.newPassword.$reset(),e.$v.newUserRole.$reset(),e.$v.newDepartment.$reset(),e.getRoles(),e.$router.push("/users"),e.$swal({title:"Success",text:"New User added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}))}catch(s){console.log(s),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}))}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Contact number already used",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))})):t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Email address already used",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))})):t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Name already exists",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))})):t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Username already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},cancelNewUser:function(){this.$router.push("/users/")}}},b=p,f=(a("a791"),a("2877")),v=Object(f["a"])(b,s,r,!1,null,null,null);t["default"]=v.exports},d0ae:function(e,t,a){},d39d:function(e,t,a){},d5f8:function(e,t,a){},d694:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pl-4"},[a("div",{staticClass:"card-header bg-transparent pb-5"},[a("div",{staticClass:"text-right"})]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"checkType"}},[a("b",[e._v("Department:")])]),a("div",{staticClass:"col-sm-8"},[a("v-select",{staticClass:"form-control-plaintext",attrs:{options:e.departments,reduce:function(e){return e.departmentUid},label:"departmentName"},model:{value:e.newDepartment,callback:function(t){e.newDepartment=t},expression:"newDepartment"}}),e.$v.newDepartment.$anyDirty&&!e.$v.newDepartment.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"bank"}},[a("b",[e._v("Bank:")])]),a("div",{staticClass:"col-sm-8"},[a("v-select",{staticClass:"form-control-plaintext",attrs:{options:e.activateBanks,reduce:function(e){return e.bankUid},label:"bank"},on:{input:function(t){return e.getActivateBankAccounts(e.newBank)}},model:{value:e.newBank,callback:function(t){e.newBank=t},expression:"newBank"}}),e.$v.newBank.$anyDirty&&!e.$v.newBank.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1),a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"bankAccount"}},[a("b",[e._v("Account Number:")])]),""==e.activateBankAccounts?a("div",{staticClass:"col-sm-8"},[a("span",{staticClass:"text-danger"},[e._v("No Bank Account")])]):a("div",{staticClass:"col-sm-8"},[a("v-select",{staticClass:"form-control-plaintext",attrs:{options:e.activateBankAccounts,reduce:function(e){return e.bankAccountUid},label:"bankAccountNumber"},on:{input:function(t){return e.getCheckSeries(e.newBank,e.newBankAccount)}},model:{value:e.newBankAccount,callback:function(t){e.newBankAccount=t},expression:"newBankAccount"}}),e.$v.newBankAccount.$anyDirty&&!e.$v.newBankAccount.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1),a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"checkSeries"}},[a("b",[e._v("Check Series:")])]),""==e.checkSeries||""==e.activateBankAccounts?a("div",{staticClass:"col-sm-8"},[a("span",{staticClass:"text-danger"},[e._v(" No Check Series ")])]):a("div",{staticClass:"col-sm-8"},[a("v-select",{staticClass:"form-control-plaintext",attrs:{options:e.checkSeries,reduce:function(e){return e.bankCheckSeriesUid},label:"bankCheckSeries"},on:{input:function(t){return e.getCheckNumber(e.newBank,e.newBankAccount,e.newCheckSeries,"current")}},model:{value:e.newCheckSeries,callback:function(t){e.newCheckSeries=t},expression:"newCheckSeries"}}),e.$v.newCheckSeries.$anyDirty&&!e.$v.newCheckSeries.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1),a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"checkNumber"}},[a("b",[e._v("Check Number:")])]),""==e.checkSeries||""==e.activateBankAccounts||""==e.checkNumbers?a("div",{staticClass:"col-sm-6"},[a("span",{staticClass:"text-danger"},[e._v(" No Check Number ")])]):a("div",{staticClass:"col-sm-6"},[a("v-select",{staticClass:"form-control-plaintext",attrs:{options:e.checkNumbers,reduce:function(e){return e.checkNumber},label:"checkNumber",readonly:""},model:{value:e.newCheckNumber,callback:function(t){e.newCheckNumber=t},expression:"newCheckNumber"}}),e.$v.newCheckNumber.$anyDirty&&!e.$v.newCheckNumber.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-3 pt-2"},[""!=e.newCheckNumber?a("base-button",{attrs:{id:"redBtn"},nativeOn:{click:function(t){return e.statusCheckNumber(e.newBank,e.newBankAccount,"skip")}}},[e._v("Skip")]):e._e(),""!=e.newCheckNumber?a("base-button",{attrs:{id:"goldBtn"},nativeOn:{click:function(t){return e.statusCheckNumber(e.newBank,e.newBankAccount,"cancel")}}},[e._v("Cancelled")]):e._e()],1),a("div",{staticClass:"col-sm-3"}),a("div",{staticClass:"col-sm-9"},[""!=e.checkSeries||""!=e.activateBankAccounts||""!=e.checkNumbers?a("a",{staticClass:"pr-2",attrs:{id:"redTxt"},on:{click:function(t){return e.getCheckNumber(e.newBank,e.newBankAccount,e.newCheckSeries,"current")}}},[e._v("Current")]):e._e(),""!=e.checkSeries||""!=e.activateBankAccounts||""!=e.checkNumbers?a("a",{staticClass:"pr-2",attrs:{id:"goldTxt"},on:{click:function(t){return e.getCheckNumber(e.newBank,e.newBankAccount,e.newCheckSeries,"skip")}}},[e._v("Skip")]):e._e(),""!=e.checkSeries||""!=e.activateBankAccounts||""!=e.checkNumbers?a("a",{staticClass:"pr-2",attrs:{id:"sideBarTxt"},on:{click:function(t){return e.getCheckNumber(e.newBank,e.newBankAccount,e.newCheckSeries,"unused")}}},[e._v("Unused")]):e._e()]),a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"checkPayee"}},[a("b",[e._v("Payee:")])]),a("div",{staticClass:"col-sm-7"},[a("v-select",{staticClass:"form-control-plaintext",attrs:{options:e.suppliers,reduce:function(e){return e.supplierId},label:"supplier"},on:{input:function(t){return e.clearDesc()}},model:{value:e.newCheckPayee,callback:function(t){e.newCheckPayee=t},expression:"newCheckPayee"}}),e.$v.newCheckPayee.$anyDirty&&!e.$v.newCheckPayee.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-1 pt-1"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-payee-modal",modifiers:{"new-payee-modal":!0}}],attrs:{id:"redBtn",icon:"ni ni-fat-add",title:"Add Payee"}})],1),a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"amount"}},[a("b",[e._v("Description:")])]),a("div",{staticClass:"col-sm-8"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newDesc,expression:"newDesc"}],staticClass:"form-control form-control-alternative pl-2",attrs:{row:"5",placeholder:"Description"},domProps:{value:e.newDesc},on:{input:function(t){t.target.composing||(e.newDesc=t.target.value)}}}),e.$v.newDesc.$anyDirty&&!e.$v.newDesc.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()]),a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"checkDate"}},[a("b",[e._v("Check Date:")])]),a("div",{staticClass:"col-sm-8"},[a("base-input",{staticClass:"form-control-plaintext",attrs:{id:"checkDate",type:"date",placeholder:"Check Date"},model:{value:e.newCheckDate,callback:function(t){e.newCheckDate=t},expression:"newCheckDate"}}),e.$v.newCheckDate.$anyDirty&&!e.$v.newCheckDate.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-12 ml-7 pl-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.dateDays,expression:"dateDays"}],staticClass:"mr-2",attrs:{type:"radio",value:"7"},domProps:{checked:e._q(e.dateDays,"7")},on:{click:function(t){return e.editDate(7)},change:function(t){e.dateDays="7"}}}),a("label",{staticClass:"mr-2"},[e._v("7 Days")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.dateDays,expression:"dateDays"}],staticClass:"mr-2",attrs:{type:"radio",value:"15"},domProps:{checked:e._q(e.dateDays,"15")},on:{click:function(t){return e.editDate(15)},change:function(t){e.dateDays="15"}}}),a("label",{staticClass:"mr-2"},[e._v("15 Days")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.dateDays,expression:"dateDays"}],staticClass:"mr-2",attrs:{type:"radio",value:"30"},domProps:{checked:e._q(e.dateDays,"30")},on:{click:function(t){return e.editDate(30)},change:function(t){e.dateDays="30"}}}),a("label",{staticClass:"mr-2"},[e._v("30 Days")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.dateDays,expression:"dateDays"}],staticClass:"mr-2",attrs:{type:"radio",value:"45"},domProps:{checked:e._q(e.dateDays,"45")},on:{click:function(t){return e.editDate(45)},change:function(t){e.dateDays="45"}}}),a("label",{staticClass:"mr-2"},[e._v("45 Days")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.dateDays,expression:"dateDays"}],staticClass:"mr-2",attrs:{type:"radio",value:""},domProps:{checked:e._q(e.dateDays,"")},on:{click:function(t){return e.editDate("")},change:function(t){e.dateDays=""}}}),a("label",{staticClass:"mr-2"},[e._v("Choose Date")])]),a("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"amount"}},[a("b",[e._v("Amount:")])]),a("div",{staticClass:"col-sm-8"},[a("base-input",{staticClass:"form-control-plaintext",attrs:{id:"amount",type:"text",placeholder:"Amount",readonly:""},model:{value:e.newAmount,callback:function(t){e.newAmount=t},expression:"newAmount"}}),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e(),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.amountCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1)]),a("hr"),a("div",{staticClass:"card-header bg-transparent pb-2"},[a("div",{staticClass:"text-left"},[a("h5",{attrs:{id:"sideBarTxt"}},[e._v("Particulars")])])]),a("card",{staticClass:"pl-2 pr-2"},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label"},[a("b",[e._v("Particular:")])]),a("div",{staticClass:"col-sm-4"},[a("base-input",{staticClass:"form-control-plaintext",attrs:{type:"text",placeholder:"Particular"},model:{value:e.newParticular,callback:function(t){e.newParticular=t},expression:"newParticular"}}),e.$v.newParticular.$anyDirty&&!e.$v.newParticular.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e(),e.$v.newParticular.$anyDirty&&!e.$v.newParticular.alphaNumCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1),a("label",{staticClass:"col-sm-2 col-form-label"},[a("b",[e._v("Reference No.:")])]),a("div",{staticClass:"col-sm-4"},[a("base-input",{staticClass:"form-control-plaintext",attrs:{type:"text",placeholder:"Reference Number"},model:{value:e.newReferenceNumber,callback:function(t){e.newReferenceNumber=t},expression:"newReferenceNumber"}}),e.$v.newReferenceNumber.$anyDirty&&!e.$v.newReferenceNumber.alphaNumCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label"},[a("b",[e._v("Unit Price:")])]),a("div",{staticClass:"col-sm-4"},[a("base-input",{staticClass:"form-control-plaintext",attrs:{type:"text",placeholder:"Unit Price"},on:{input:function(t){return e.computeAmount(e.newUnitPrice,e.newQuantity,"add")}},model:{value:e.newUnitPrice,callback:function(t){e.newUnitPrice=t},expression:"newUnitPrice"}}),e.$v.newUnitPrice.$anyDirty&&!e.$v.newUnitPrice.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e(),e.$v.newUnitPrice.$anyDirty&&!e.$v.newUnitPrice.amountCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1),a("label",{staticClass:"col-sm-2 col-form-label"},[a("b",[e._v("Quantity:")])]),a("div",{staticClass:"col-sm-4"},[a("base-input",{staticClass:"form-control-plaintext",attrs:{type:"text",placeholder:"Quantity"},on:{input:function(t){return e.computeAmount(e.newUnitPrice,e.newQuantity,"add")}},model:{value:e.newQuantity,callback:function(t){e.newQuantity=t},expression:"newQuantity"}}),e.$v.newQuantity.$anyDirty&&!e.$v.newQuantity.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e(),e.$v.newQuantity.$anyDirty&&!e.$v.newQuantity.numCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label"},[a("b",[e._v("Amount:")])]),a("div",{staticClass:"col-sm-4"},[a("base-input",{staticClass:"form-control-plaintext",attrs:{type:"text",placeholder:"Amount",readonly:""},model:{value:e.newParticularAmount,callback:function(t){e.newParticularAmount=t},expression:"newParticularAmount"}}),e.$v.newParticularAmount.$anyDirty&&!e.$v.newParticularAmount.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e(),e.$v.newParticularAmount.$anyDirty&&!e.$v.newParticularAmount.amountCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5 pt-2"},[a("base-button",{attrs:{block:"",id:"redBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addParticular(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")])],1)])]),a("div",{staticClass:"table-full-width"},[a("paper-table",{attrs:{type:"hover",loading:!1,loadError:e.loadError,title:e.particularsTable.title,"sub-title":e.particularsTable.subTitle,data:e.checkParticulars,columns:e.particularsTable.columns},on:{reloadData:e.reloadData},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("td",[e._v(e._s(s.rowNum))]),a("td",[e._v(e._s(s.particular))]),a("td",[e._v(e._s(s.referenceNumber))]),a("td",[e._v(e._s(s.unitPrice))]),a("td",[e._v(e._s(s.quantity))]),a("td",[e._v(e._s(s.particularAmount))]),a("td",{attrs:{align:"right"}},[""!=s.rowNum?a("span",{staticClass:"pointer ml-2 far fa-times-circle text-red",attrs:{title:"Remove"},on:{click:function(t){return e.removeParticular(s)}}}):e._e()])]}}])})],1),a("hr"),a("div",{staticClass:"text-center"},[""!=e.activateBankAccounts&&""!=e.checkSeries&&0!=e.checkParticulars.length?a("base-button",{staticClass:"col-md-2 ml-2",attrs:{id:"redBtn"},nativeOn:{click:function(t){return e.addCheck(t)}}},[e._v("Save")]):e._e(),a("base-button",{staticClass:"col-md-2 ml-2",attrs:{id:"goldBtn"},nativeOn:{click:function(t){return e.cancelNewCheck(t)}}},[e._v("Close")])],1)],1),a("b-modal",{attrs:{size:"lg",id:"new-payee-modal",title:"Add Payee",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"pull-right"},[a("base-button",{attrs:{type:"primary",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addPayee(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{type:"danger",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-payee-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-3 col-form-label"},[a("b",[e._v("Payee Name:")])]),a("div",{staticClass:"col-sm-9"},[a("base-input",{staticClass:"form-control-plaintext",attrs:{type:"text",placeholder:"Payee"},model:{value:e.newPayee,callback:function(t){e.newPayee=t},expression:"newPayee"}}),e.$v.newPayee.$anyDirty&&!e.$v.newPayee.required?a("i",{staticClass:"text-danger"},[e._v("Field Required")]):e._e(),e.$v.newPayee.$anyDirty&&!e.$v.newPayee.alphaNumCustomValidator?a("i",{staticClass:"text-danger"},[e._v("Invalid Characters")]):e._e()],1)])])],1)],1)},r=[],n=(a("99af"),a("4160"),a("fb6a"),a("a434"),a("b680"),a("d3b7"),a("ac1f"),a("25f0"),a("841c"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=a("c6f8"),c=o["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),d=o["helpers"].regex("alphaNumAndDot",/^[ 0-9â‚± ,. ]*$/),u=o["helpers"].regex("alphaNumAndDot",/^[ A-Za-z0-9 -./, ]*$/),m=["#","Particular","Reference No.","Unit Price","Quantity","Amount","Actions"],p=a("c1df"),b=new Date,f=a("9f25"),v=a("e966"),h=v.bindWith(",","."),C={name:"new-check",components:{},data:function(){return{banks:[],activateBanks:[],activateBankAccounts:[],departments:[],suppliers:[],checkSeries:[],checkNumbers:[],newCheckNumber:"",newCheckDate:"",newAmount:"",newCheckPayee:"",newDesc:"",newDepartment:"",newBank:"",newBankAccount:"",newCheckSeries:"",newPayee:"",loading:!0,loadError:!1,particularsTable:{title:"Particulars Table",subTitle:"",columns:[].concat(m)},checkParticulars:[],requestProcessing:!1,newParticular:"",newReferenceNumber:"",newUnitPrice:"",newParticularAmount:"",newQuantity:"",totalAmount:"",dateDays:""}},validations:{newCheckDate:{required:o["required"]},newCheckNumber:{required:o["required"]},newAmount:{required:o["required"],amountCustomValidator:d},newCheckPayee:{required:o["required"]},newDepartment:{required:o["required"]},newBank:{required:o["required"]},newBankAccount:{required:o["required"]},newCheckSeries:{required:o["required"]},newPayee:{required:o["required"],alphaNumCustomValidator:u},newDesc:{required:o["required"]},newParticular:{required:o["required"],alphaNumCustomValidator:u},newReferenceNumber:{alphaNumCustomValidator:u},newUnitPrice:{required:o["required"],amountCustomValidator:d},newParticularAmount:{required:o["required"],amountCustomValidator:d},newQuantity:{required:o["required"],numCustomValidator:c}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getActivateBanks(),e.getDepartments(),e.getSuppliers(),e.getParticulars();case 4:case"end":return t.stop()}}),t)})))()},methods:{getActivateBanks:function(){var e=this,t=i["db"].collection("banks").orderBy("bank","asc");e.activateBanks=[],t.get().then((function(t){t.forEach((function(t){e.activateBanks.push(t.data())})),e.newBank=e.activateBanks[0].bankUid,e.getActivateBankAccounts(e.activateBanks[0].bankUid)}))},getActivateBankAccounts:function(e){var t=this,a=i["db"].collection("bankAccounts").where("bankReference","==",e).orderBy("bankAccountNumber","asc");t.activateBankAccounts=[],a.get().then((function(e){e.forEach((function(e){t.activateBankAccounts.push(e.data())})),t.newBankAccount=t.activateBankAccounts[0].bankAccountUid,t.getCheckSeries(t.newBank,t.newBankAccount)}))},getCheckSeries:function(e,t){var a=this,s=i["db"].collection("bankCheckSeries").where("bankReference","==",e).where("bankAccountReference","==",t).orderBy("bankCheckSeries","asc");a.checkSeries=[],s.get().then((function(e){e.forEach((function(e){a.checkSeries.push(e.data())}));for(var t=0;t<a.checkSeries.length;t++){var s=a.checkSeries[t].bankCheckSeries.search("-");a.checkSeries[t].bankCheckSeries=a.checkSeries[t].bankCheckSeries.slice(0,s)}a.newCheckSeries=a.checkSeries[0].bankCheckSeriesUid,a.getCheckNumber(a.newBank,a.newBankAccount,a.newCheckSeries,"current")}))},getCheckNumber:function(e,t,a,s){var r=this,n=i["db"].collection("bankCheckSeriesReports").where("bankReference","==",e).where("bankAccountReference","==",t).where("checkSeriesReference","==",a).where("status","==",s).orderBy("checkNumber","asc");r.checkNumbers=[],r.newCheckNumber="",n.get().then((function(e){e.forEach((function(e){e.exists&&r.checkNumbers.push(e.data())})),0!=r.checkNumbers.length&&(r.newCheckNumber=r.checkNumbers[0].checkNumber)}))},getDepartments:function(){var e=this,t=i["dbUsers"].collection("departments").orderBy("departmentName","asc");e.departments=[],t.get().then((function(t){t.forEach((function(t){e.departments.push(t.data())})),e.newDepartment=e.departments[0].departmentUid}))},getSuppliers:function(){var e=this,t=i["db"].collection("suppliers").orderBy("supplier","asc");e.suppliers=[],t.get().then((function(t){t.forEach((function(t){e.suppliers.push(t.data())}))}))},cancelNewCheck:function(){this.$router.push("/check/dashboard")},addPayee:function(){var e=this;if(e.requestProcessing=!1,e.$v.newPayee.$touch(),!e.$v.newPayee.$error){var t=null;e.requestProcessing=!0,t=i["db"].collection("suppliers").where("supplier","==",Object(l["a"])(e.newPayee)),t.get().then((function(t){if(t.empty){if(t){var a=localStorage.getItem("aisname"),s=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),r=[],n="SID-"+b.getFullYear()+f(b.getMonth()+1,2)+b.getDate()+"-"+Math.floor(1e6*Math.random());s.get().then((function(t){t.forEach((function(t){t.exists&&r.push(t.data());try{i["db"].collection("suppliers").doc().set({supplierId:n,supplier:Object(l["a"])(e.newPayee),status:1,userReference:r[0].userId,dateCreated:b,createdBy:a}).then((function(){e.newPayee="",e.$v.newPayee.$reset(),e.requestProcessing=!1,e.$bvModal.hide("new-payee-modal"),e.getSuppliers(),e.$swal({title:"Success",text:"New Payee added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(s){console.log(s)}}))}))}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Payee already exists.",icon:"error",confirmButtonColor:"#f5365c",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},getParticulars:function(){var e=this;if(e.loading=!1,0!=e.checkParticulars.length){var t=a("e966"),s=t.bindWith(",","."),r=0,n=0;e.loading=!0,e.loadError=!1;for(var i=0;i<e.checkParticulars.length;i++)e.checkParticulars[i].rowNum=i+1,n=e.checkParticulars[i].particularAmount.replaceAll("â‚± ",""),r+=parseFloat(n.replaceAll(",",""));e.newAmount="â‚± "+s(parseFloat(r).toFixed(2)),setTimeout((function(){e.loading=!1}),1500)}else 0==e.checkParticulars.length&&(e.checkParticulars=[],e.newAmount="")},reloadData:function(){this.getParticulars()},computeAmount:function(e,t,a){e=e.replaceAll("â‚± ",""),this.newUnitPrice="â‚± "+e,e=e.replaceAll(",",""),"add"==a?(this.newParticularAmount=e*t,this.newParticularAmount="â‚± "+h(parseFloat(this.newParticularAmount).toFixed(2))):"update"==a&&(this.edit.particularAmount=e*t)},addParticular:function(){var e=this,t=!0;if(e.requestProcessing=!1,e.$v.newParticular.$touch(),e.$v.newReferenceNumber.$touch(),e.$v.newUnitPrice.$touch(),e.$v.newParticularAmount.$touch(),e.$v.newQuantity.$touch(),e.$v.newParticular.$error||e.$v.newUnitPrice.$error||e.$v.newParticularAmount.$error||e.$v.newQuantity.$error||e.$v.newReferenceNumber.$error||(t=!1),!t){e.requestProcessing=!0,0==e.checkParticulars.length&&(e.checkParticulars=[]);var a={rowNum:"",particular:e.newParticular,referenceNumber:e.newReferenceNumber,unitPrice:e.newUnitPrice,particularAmount:e.newParticularAmount,quantity:e.newQuantity,status:1};e.checkParticulars.push(a),e.$swal({title:"Success",text:"New Particular added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.newParticular="",e.newReferenceNumber="",e.newUnitPrice="",e.newParticularAmount="",e.newQuantity="",e.$v.newParticular.$reset(),e.$v.newReferenceNumber.$reset(),e.$v.newUnitPrice.$reset(),e.$v.newParticularAmount.$reset(),e.$v.newQuantity.$reset(),e.$bvModal.hide("add-particular-modal"),e.getParticulars()})),e.requestProcessing=!1}},editDate:function(e){this.newCheckDate=""!=e?p().add(e,"day").format("YYYY-MM-DD"):""},clearDesc:function(){this.$v.newDesc.$reset()},addCheck:function(){var e=this;if(e.requestProcessing=!1,e.$v.newCheckDate.$touch(),e.$v.newCheckNumber.$touch(),e.$v.newAmount.$touch(),e.$v.newCheckPayee.$touch(),e.$v.newDepartment.$touch(),e.$v.newBank.$touch(),e.$v.newBankAccount.$touch(),e.$v.newCheckSeries.$touch(),e.newAmount=e.newAmount.replaceAll(",",""),e.newAmount=e.newAmount.replaceAll("â‚± ",""),!e.$v.newCheckDate.$error&&!e.$v.newCheckNumber.$error&&!e.$v.newAmount.$error&&!e.$v.newCheckPayee.$error&&!e.$v.newDepartment.$error&&!e.$v.newBank.$error&&!e.$v.newBankAccount.$error&&!e.$v.newCheckSeries.$error){var t=i["db"].collection("suppliers").where("supplierId","==",e.newCheckPayee),a=[];t.get().then((function(t){t.forEach((function(e){a.push(e.data())})),"CASH"==a[0].supplier?(e.$v.newDesc.$touch(),e.$v.newDesc.$error?e.$swal({title:"Error",text:"Description is required",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}):e.newCheck()):e.newCheck()}))}},newCheck:function(){var e=this;e.requestProcessing=!0,this.$swal({title:"Are you sure?",text:"You want to save this check",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#f5c71a",confirmButtonText:"CONFIRM"}).then((function(t){if(t.value){var a=null;a=i["db"].collection("bankChecks").where("bankCheckNumber","==",e.newCheckNumber).where("bankCheckSeriesReference","==",e.newCheckSeries).where("bankReference","==",e.newBank).where("bankAccountReference","==",e.newBankAccount),a.get().then((function(t){if(t.empty){if(t){var a=i["db"].collection("bankCheckSeries").where("bankCheckSeriesUid","==",e.newCheckSeries),s=i["db"].collection("bankChecks").orderBy("voucherDate","desc"),r=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),n=i["dbUsers"].collection("departments").where("departmentUid","==",e.newDepartment),o=[],l=[],c="",d=[],u=[];a.get().then((function(t){t.forEach((function(e){e.exists&&(l.push(e.data()),c=e.id)})),s.limit(1).get().then((function(t){t.forEach((function(e){e.exists&&d.push(e.data())}));var a=parseInt(l.bankCheckSeries)+99,s="";r.get().then((function(t){t.forEach((function(e){o.push(e.data())})),n.get().then((function(t){t.forEach((function(e){u.push(e.data())}));var r=new Date,n="postdated",l="BCI-"+b.getFullYear()+f(b.getMonth()+1,2)+b.getDate()+"-"+Math.floor(1e6*Math.random());0!=d.length?(s=f(parseInt(d[0].voucherNumber.slice(7))+1,5),"100000"==s.toString()&&(s="00001")):s="00001",p(e.newCheckDate).format("YYYY-MM-DD")==p(b).format("YYYY-MM-DD")&&(n="dated");try{i["db"].collection("bankChecks").doc().set({bankCheckUid:l,bankCheckNumber:e.newCheckNumber,bankCheckDate:e.newCheckDate,bankCheckAmount:e.newAmount,checkType:n,voucherNumber:f(r.getMonth()+1)+""+r.getFullYear().toString().slice(2,4)+"-"+u[0].seriesCode+s,voucherDate:r,departmentReference:e.newDepartment,payeeReference:e.newCheckPayee,description:e.newDesc,bankReference:e.newBank,bankAccountReference:e.newBankAccount,bankCheckSeriesReference:e.newCheckSeries,status:3,userReference:o[0].userId,dateCreated:b,dateModified:b,createdBy:o[0].username}).then((function(){a==e.newCheckNumber&&i["db"].collection("bankCheckSeries").doc(c).update({status:0,dateModified:b});for(var t=0;t<e.checkParticulars.length;t++){var s="BCPI-"+b.getFullYear()+f(b.getMonth()+1,2)+b.getDate()+"-"+Math.floor(1e6*Math.random());e.checkParticulars[t].unitPrice=e.checkParticulars[t].unitPrice.replaceAll(",",""),e.checkParticulars[t].unitPrice=e.checkParticulars[t].unitPrice.replaceAll("â‚± ",""),e.checkParticulars[t].particularAmount=e.checkParticulars[t].particularAmount.replaceAll(",",""),e.checkParticulars[t].particularAmount=e.checkParticulars[t].particularAmount.replaceAll("â‚± ",""),i["db"].collection("bankCheckParticulars").doc().set({bankCheckParticularsUid:s,particular:e.checkParticulars[t].particular,referenceNumber:e.checkParticulars[t].referenceNumber,unitPrice:e.checkParticulars[t].unitPrice,particularAmount:e.checkParticulars[t].particularAmount,quantity:e.checkParticulars[t].quantity,bankCheckReference:l,userReference:o[0].userId,status:1,dateCreated:b,dateModified:b,createdBy:o[0].username}).then((function(){var t=i["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",e.newCheckSeries).where("checkNumber","==",e.newCheckNumber),a="",s=[];t.get().then((function(t){if(t.forEach((function(e){a=e.id,s.push(e.data())})),i["db"].collection("bankCheckSeriesReports").doc(a).update({checkReference:l,status:"used",dateModified:b}),"current"==s[0].status){var r=parseInt(e.newCheckNumber),n=i["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",e.newCheckSeries).where("status","==","unused").orderBy("checkNumber","asc").startAfter(r),o="";n.limit(1).get().then((function(e){e.forEach((function(e){o=e.id})),i["db"].collection("bankCheckSeriesReports").doc(o).update({status:"current",dateModified:b})}))}e.newCheckNumber="",e.newCheckDate="",e.newAmount="",e.newCheckPayee="",e.newDesc="",e.checkParticulars=[],e.$v.newCheckDate.$reset(),e.$v.newAmount.$reset(),e.$v.newCheckPayee.$reset(),e.$v.newDepartment.$reset(),e.$v.newBank.$reset(),e.$v.newBankAccount.$reset(),e.$v.newDesc.$reset(),e.requestProcessing=!1,e.$swal({title:"Success",text:"New Check added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.$router.push("/check/voucher/"+l)}))}))}))}}))}catch(m){console.log(m),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}))}))}))}))}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Check already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}else e.requestProcessing=!1}))},removeParticular:function(e){var t=this;this.$swal({title:"Are you sure?",text:"You want to remove this Particular",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#f5c71a",confirmButtonText:"CONFIRM"}).then((function(a){a.value&&(t.checkParticulars.splice(parseInt(e.rowNum-1),1),t.$swal({title:"Success",text:"Particular remove successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),t.requestProcessing=!1,t.getParticulars())}))},statusCheckNumber:function(e,t,a){var s=this;this.$swal({title:"Are you sure?",text:"You want to "+a+" this Check Number",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#f5c71a",confirmButtonText:"CONFIRM"}).then((function(r){if(r.value){"cancel"==a&&(a="cancelled");var n=i["db"].collection("bankCheckSeriesReports").where("bankReference","==",e).where("bankAccountReference","==",t).where("checkSeriesReference","==",s.newCheckSeries).where("checkNumber","==",s.newCheckNumber),o="",l=[];n.get().then((function(r){r.empty||(r.forEach((function(e){o=e.id,l.push(e.data())})),i["db"].collection("bankCheckSeriesReports").doc(o).update({status:a,dateModified:b}).then((function(){if("current"==l[0].status){var r=parseInt(s.newCheckNumber),n=i["db"].collection("bankCheckSeriesReports").where("checkSeriesReference","==",s.newCheckSeries).where("status","==","unused").orderBy("checkNumber","asc").startAfter(r),o="";n.limit(1).get().then((function(r){r.empty||(r.forEach((function(e){o=e.id})),i["db"].collection("bankCheckSeriesReports").doc(o).update({status:"current",dateModified:b}).then((function(){s.getCheckSeries(e,t),s.requestProcessing=!1,s.$swal({title:"Success",text:"Check number "+a+" successfully",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(e){console.log(e),s.requestProcessing=!1,s.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})))}))}else s.getCheckSeries(e,t),s.requestProcessing=!1,s.$swal({title:"Success",text:"Check number "+a+" successfully",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})))}))}}))}}},w=C,g=a("2877"),y=Object(g["a"])(w,s,r,!1,null,null,null);t["default"]=y.exports},d784:function(e,t,a){"use strict";a("ac1f");var s=a("6eeb"),r=a("d039"),n=a("b622"),i=a("9263"),o=a("9112"),l=n("species"),c=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){return"$0"==="a".replace(/./,"$0")}(),u=n("replace"),m=function(){return!!/./[u]&&""===/./[u]("a","$0")}(),p=!r((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2!==a.length||"a"!==a[0]||"b"!==a[1]}));e.exports=function(e,t,a,u){var b=n(e),f=!r((function(){var t={};return t[b]=function(){return 7},7!=""[e](t)})),v=f&&!r((function(){var t=!1,a=/a/;return"split"===e&&(a={},a.constructor={},a.constructor[l]=function(){return a},a.flags="",a[b]=/./[b]),a.exec=function(){return t=!0,null},a[b](""),!t}));if(!f||!v||"replace"===e&&(!c||!d||m)||"split"===e&&!p){var h=/./[b],C=a(b,""[e],(function(e,t,a,s,r){return t.exec===i?f&&!r?{done:!0,value:h.call(t,a,s)}:{done:!0,value:e.call(a,t,s)}:{done:!1}}),{REPLACE_KEEPS_$0:d,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:m}),w=C[0],g=C[1];s(String.prototype,e,w),s(RegExp.prototype,b,2==t?function(e,t){return g.call(e,this,t)}:function(e){return g.call(e,this)})}u&&o(RegExp.prototype[b],"sham",!0)}},dc90:function(e,t,a){},de02:function(e,t,a){},e016:function(e,t,a){},e3a9:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",{staticClass:"pt-4",attrs:{id:"textStyle"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left ml-1 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-2 pointer"},[1==e.seriesStat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getBSSeries(1)}}},[e._v("Enabled")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},[0==e.seriesStat?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getBSSeries(0)}}},[e._v("Disabled")])])],1)]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{ref:"bs-series-table",attrs:{columns:e.columns,rows:e.bsSeries,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["startNumber"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.startNumber))])]):e._e(),"endNumber"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.endNumber))])]):e._e(),"action"==t.column.field?a("span",[1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Edit"},on:{click:function(a){return e.openEditBSSeriesModal(t.row)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-times-circle",attrs:{id:"sideBarTxt",title:"Disable"},on:{click:function(a){return e.changeStatus(t.row.id,0,"Disable")}}}):e._e(),0==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-check-circle",attrs:{id:"sideBarTxt",title:"Enable"},on:{click:function(a){return e.changeStatus(t.row.id,1,"Enable")}}}):e._e()]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),!e.loading&&e.bsSeries.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getBSSeries(e.seriesStat)}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-bs-series-modal",modifiers:{"new-bs-series-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Billing Statement Series")])],1)]),a("b-modal",{attrs:{size:"lg",id:"new-bs-series-modal",title:"New Billing Statement Series",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addBSSeries(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-bs-series-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Start Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("End Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Start Number"},model:{value:e.newStartNumber,callback:function(t){e.newStartNumber=t},expression:"newStartNumber"}}),e.$v.newStartNumber.$anyDirty&&!e.$v.newStartNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newStartNumber.$anyDirty&&!e.$v.newStartNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"End Number"},model:{value:e.newEndNumber,callback:function(t){e.newEndNumber=t},expression:"newEndNumber"}}),e.$v.newEndNumber.$anyDirty&&!e.$v.newEndNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newEndNumber.$anyDirty&&!e.$v.newEndNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"edit-bs-series-modal",title:"Edit Billing Statement Series",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateBSSeries(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-bs-series-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Start Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("End Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"Start Number"},model:{value:e.edit.startNumber,callback:function(t){e.$set(e.edit,"startNumber",t)},expression:"edit.startNumber"}}),e.$v.edit.$anyDirty&&!e.$v.edit.startNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.startNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{id:"inputStyle",type:"text",placeholder:"End Number"},model:{value:e.edit.endNumber,callback:function(t){e.$set(e.edit,"endNumber",t)},expression:"edit.endNumber"}}),e.$v.edit.$anyDirty&&!e.$v.edit.endNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.endNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])])],1)],1)},r=[],n=(a("4160"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=o["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),c=new Date,d=a("9f25"),u={components:{},data:function(){return{columns:[{label:"Start Number",field:"startNumber"},{label:"End Number",field:"endNumber"},{label:"",field:"action",sortable:!1,width:"100px"}],loading:!0,bsSeries:[],views:[{limitId:"20",limit:"20 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"20",requestProcessing:!1,newStartNumber:"",newEndNumber:"",edit:{id:"",seriesId:"",startNumber:"",endNumber:""},seriesStat:1}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=i["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=i["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Manager"!=s[0].userRole&&"Administrator"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getBSSeries(e.seriesStat);case 1:case"end":return t.stop()}}),t)})))()},validations:{newStartNumber:{required:o["required"],numCustomValidator:l},newEndNumber:{required:o["required"],numCustomValidator:l},edit:{startNumber:{required:o["required"],numCustomValidator:l},endNumber:{required:o["required"],numCustomValidator:l}}},methods:{addBSSeries:function(){var e=this;if(e.$v.newStartNumber.$touch(),e.$v.newEndNumber.$touch(),!e.$v.newStartNumber.$error&&!e.$v.newEndNumber.$error)if(e.requestProcessing=!0,e.newEndNumber<=e.newStartNumber)e.$swal({title:"Invalid",text:"End Number is less than or equal to Start Number.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1;else{var t=i["dbSales"].collection("billingStatementSeries").where("startNumber","==",e.newStartNumber).where("endNumber","==",e.newEndNumber).where("status","==",1);t.get().then((function(t){if(t.empty){if(t){var a=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),s=[],r="BSS-"+c.getFullYear()+d(c.getMonth()+1,2)+c.getDate()+"-"+Math.floor(1e6*Math.random());a.get().then((function(t){t.forEach((function(e){e.exists&&s.push(e.data())}));try{i["dbSales"].collection("billingStatementSeries").doc().set({billingStatementSeriesId:r,startNumber:e.newStartNumber,endNumber:e.newEndNumber,current:"",userReference:s[0].userId,status:1,dateCreated:c,dateModified:c}).then((function(){e.newStartNumber="",e.newEndNumber="",e.requestProcessing=!1,e.$v.newStartNumber.$reset(),e.$v.newEndNumber.$reset(),e.getBSSeries(e.seriesStat),e.$bvModal.hide("new-bs-series-modal"),e.$refs["bs-series-table"].reset(),e.$swal({title:"Success",text:"New billing statement series added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}))}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Billing statement series already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},getBSSeries:function(e){var t=this,a=null,s=[],r=[];t.loading=!0,t.bsSeries=[],t.seriesStat=e,"all"!=t.limit?a=i["dbSales"].collection("billingStatementSeries").where("status","==",e).orderBy("startNumber","asc").limit(t.limit):"all"==t.limit&&(a=i["dbSales"].collection("billingStatementSeries").where("status","==",e).orderBy("startNumber","asc")),a.get().then((function(e){if(!e.empty){e.forEach((function(e){s.push(e.data()),r.push(e.id)}));for(var a=0;a<s.length;a++)s[a]["id"]=r[a],t.bsSeries.push(s[a])}setTimeout((function(){t.loading=!1}),1e3)}))},openEditBSSeriesModal:function(e){this.edit={id:e.id,seriesId:e.billingStatementSeriesId,startNumber:e.startNumber,endNumber:e.endNumber},this.$bvModal.show("edit-bs-series-modal")},updateBSSeries:function(){var e=this;if(e.$v.edit.$touch(),!e.$v.edit.$error)if(e.requestProcessing=!0,e.edit.endNumber<=e.edit.startNumber)e.$swal({title:"Invalid",text:"End Number is less than or equal to Start Number.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1;else{var t=i["dbSales"].collection("billingStatementSeries").where("startNumber","==",e.edit.startNumber).where("endNumber","==",e.edit.endNumber).where("status","==",1).where("billingStatementSeriesId","!=",e.edit.seriesId);t.get().then((function(t){if(t.empty){if(t)try{i["dbSales"].collection("billingStatementSeries").doc(e.edit.id).update({startNumber:e.edit.startNumber,endNumber:e.edit.endNumber,dateModified:c}).then((function(){e.$v.edit.$reset(),e.$bvModal.hide("edit-bs-series-modal"),e.requestProcessing=!1,e.$refs["bs-series-table"].reset(),e.getBSSeries(e.seriesStat),e.$swal({title:"Success",text:"Billing statement series updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a)}}else t.forEach((function(t){t.exists&&(e.$swal({title:"Invalid",text:"Billing statement series already exists.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),e.requestProcessing=!1)}))}))}},changeStatus:function(e,t,a){var s=this;s.$swal({title:"Are you sure?",text:"You want to change the status to "+a,icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(r){if(r.value)try{i["dbSales"].collection("billingStatementSeries").doc(e).update({status:t,dateModified:c}).then((function(){s.$swal({title:"Success",text:"Billing statement series type status to "+a+".",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){s.$refs["bs-series-table"].reset(),s.getBSSeries(t)}))}))}catch(n){console.log(n),s.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}))}}},m=u,p=(a("fbf2"),a("2877")),b=Object(p["a"])(m,s,r,!1,null,null,null);t["default"]=b.exports},e3c7:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5 pt-md-5"}),a("div",{attrs:{id:"textStyle"}},[a("div",{staticClass:"col-12 container-fluid mt--7"},[a("card",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left ml-1 mt-2 mb-2 pt-2"},[a("badge",{staticClass:"badge-dot ml-2 pointer"},["Release"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getLoanDisbursements("Release")}}},[e._v("Release")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},["Cleared"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getLoanDisbursements("Cleared")}}},[e._v("Cleared")])]),a("badge",{staticClass:"badge-dot ml-3 pointer"},["All"==e.listType?a("i",{attrs:{id:"activeBadge"}}):a("i",{attrs:{id:"redBg"}}),a("span",{staticClass:"pointer status",attrs:{id:"linkTxt"},on:{click:function(t){return e.getLoanDisbursements("All")}}},[e._v("All")])])],1)]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"}),a("span",{staticClass:"col-2 pb-3 pl-4 text-right"},[a("b",[e._v("Filter by:")])]),a("span",{staticClass:"col-sm-2 pb-2 text-right"},[a("v-select",{staticStyle:{width:"150px"},attrs:{id:"inputStyle",options:e.filters,reduce:function(e){return e.filterId},label:"filter",clearable:!1,readonly:""},on:{input:function(t){return e.getLoanDisbursements(e.listType)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),a("span",{staticClass:"col-sm-2 pl-0"},["month"==e.filter?a("base-input",{staticClass:"pb-2",staticStyle:{width:"230px"},attrs:{type:"month",max:e.maxDate,min:"1997-01",id:"inputStyle"},on:{input:function(t){return e.getLoanDisbursements(e.listType)}},model:{value:e.dateCreated,callback:function(t){e.dateCreated=t},expression:"dateCreated"}}):e._e()],1)]),a("div",{staticClass:"table-full-width"},[a("vue-good-table",{ref:"loan-disbursement-table",attrs:{columns:e.columns,rows:e.loanDisbursements,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loading},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["voucherNumber"==t.column.field?a("span",[a("span",{staticClass:"pointer",attrs:{id:"sideBarTxt"},on:{click:function(a){return e.openViewLoanDisbursementModal(t.row)}}},[e._v(e._s(t.row.voucherNumber))])]):e._e(),"amount"==t.column.field?a("span",[a("span",{staticClass:"tableSpan"},[e._v("â‚± "+e._s(t.row.amount))])]):e._e(),"transactionDate"==t.column.field?a("span",[a("span",[e._v(e._s(e._f("moment")(t.row.transactionDate,"MMM DD, YYYY")))])]):e._e(),"bank"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.bank))])]):e._e(),"account"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.account))])]):e._e(),"userReference"==t.column.field?a("span",[e._l(e.users,(function(s){return a("span",{key:s.userId},[s.userId==t.row.userReference?a("span",[e._v(e._s(s.firstname)+" "+e._s(s.lastname))]):e._e()])})),""==t.row.userReference?a("span",[a("span",[e._v("----------")])]):e._e()],2):e._e(),"status"==t.column.field?a("span",[1==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("RELEASE")]):e._e(),2==t.row.status?a("span",{attrs:{id:"sideBarTxt"}},[e._v("CLEARED")]):e._e()]):e._e(),"action"==t.column.field?a("span",[1==t.row.status?a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdateLDModal(t.row)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 fa fa-percent",attrs:{id:"sideBarTxt",title:"Loan Percent"},on:{click:function(a){return e.openLoanPercentModal(t.row)}}}):e._e(),1==t.row.status&&"User"!=e.userRole?a("span",{staticClass:"pointer ml-2 far fa-check-square",attrs:{id:"sideBarTxt",title:"Cleared"},on:{click:function(a){return e.changeStatus(t.row,2)}}}):e._e(),2==t.row.status&&"User"!=e.userRole?a("span",{staticClass:"pointer ml-2 far fa-square",attrs:{id:"sideBarTxt",title:"Release"},on:{click:function(a){return e.changeStatus(t.row,1)}}}):e._e(),1==t.row.status?a("span",{staticClass:"pointer ml-2 fa fa-file",attrs:{id:"sideBarTxt",title:"Attachment"},on:{click:function(a){return e.openAttachments(t.row)}}}):e._e()]):e._e()])]}}])})],1),a("hr",{staticClass:"mb-2 mt-2"}),e.loanDisbursements.length?a("div",{staticClass:"row pl-4"},[a("div",{staticClass:"col-9"}),a("span",{staticClass:"col-1 pt-2 text-right"},[a("b",[e._v("View:")])]),a("span",{staticClass:"col-sm-2"},[a("v-select",{attrs:{id:"inputStyle",options:e.views,reduce:function(e){return e.limitId},label:"limit",clearable:!1},on:{input:function(t){return e.getLoanDisbursements(e.listType)}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)]):e._e(),a("hr",{staticClass:"mb-2 mt-2"}),a("div",{staticClass:"text-right pt-2"},[a("base-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-loan-disbursement-modal",modifiers:{"new-loan-disbursement-modal":!0}}],staticClass:"col-md-4 ml-2 mr-2",attrs:{id:"darkBtn"}},[e._v("New Loan Disbursement")])],1)]),a("div",{staticClass:"pl-4",attrs:{id:"duplicateView"}},[a("div",{staticClass:"row"},[e._m(0),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Voucher Number: "+e._s(e.view.voucherNumber))])])]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Transaction Date: ")]),e._v(e._s(e._f("moment")(e.view.transactionDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Amount: ")]),e._v("â‚± "+e._s(e.view.amount)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Bank: ")]),e._v(e._s(e.view.bank)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Account Number: ")]),e._v(e._s(e.view.account)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Payment Type: ")]),e._v(e._s(e.view.paymentType)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Chart of Account: ")]),e._v(e._s(e.view.coa)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Business Type: ")]),e._v(e._s(e.view.businessType)+" ")]),"Check"==e.view.paymentType?a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Check Number: ")]),e._v(e._s(e.view.checkReference)+" ")]):e._e()]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Total Amount Due: ")]),e._v("â‚± "+e._s(""==e.view.totalAmountDue?"----------":e.view.totalAmountDue)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Total Amount: ")]),e._v("â‚± "+e._s(e.view.totalAmount)+" ")])]),a("hr"),e._m(1),e._l(e.dues,(function(t){return a("div",{key:t.date,staticClass:"row"},[a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.date))]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.terms)+" days")]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.percent)+"%")]),a("span",{staticClass:"col-sm-2"},[e._v("â‚± "+e._s(t.amountDue))]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.days)+" days")]),a("span",{staticClass:"col-sm-2"},[e._v("â‚± "+e._s(t.totalDue))])])})),a("hr"),a("div",{staticClass:"row"},[e._m(2),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Prepared by :")]),e._v(" "+e._s(e.user.firstname)+" "+e._s(e.user.lastname)+" ")])]),e._m(3),a("br"),e._l(e.breakCounts,(function(e){return a("span",{key:e},[a("br")])})),a("br"),a("div",{staticClass:"row"},[e._m(4),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Voucher Number: "+e._s(e.view.voucherNumber))])])]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Transaction Date: ")]),e._v(e._s(e._f("moment")(e.view.transactionDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Amount: ")]),e._v("â‚± "+e._s(e.view.amount)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Bank: ")]),e._v(e._s(e.view.bank)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Account Number: ")]),e._v(e._s(e.view.account)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Payment Type: ")]),e._v(e._s(e.view.paymentType)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Chart of Account: ")]),e._v(e._s(e.view.coa)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Business Type: ")]),e._v(e._s(e.view.businessType)+" ")]),"Check"==e.view.paymentType?a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Check Number: ")]),e._v(e._s(e.view.checkReference)+" ")]):e._e()]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Total Amount Due: ")]),e._v("â‚± "+e._s(""==e.view.totalAmountDue?"----------":e.view.totalAmountDue)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Total Amount: ")]),e._v("â‚± "+e._s(e.view.totalAmount)+" ")])]),a("hr"),e._m(5),e._l(e.dues,(function(t){return a("div",{key:t.date,staticClass:"row"},[a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.date))]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.terms)+" days")]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.percent)+"%")]),a("span",{staticClass:"col-sm-2"},[e._v("â‚± "+e._s(t.amountDue))]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.days)+" days")]),a("span",{staticClass:"col-sm-2"},[e._v("â‚± "+e._s(t.totalDue))])])})),a("hr"),a("div",{staticClass:"row"},[e._m(6),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Prepared by :")]),e._v(" "+e._s(e.user.firstname)+" "+e._s(e.user.lastname)+" ")])]),e._m(7)],2),a("b-modal",{attrs:{size:"xl",id:"new-loan-disbursement-modal",title:"New Loan Disbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.newLoanDisbursement(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("new-loan-disbursement-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Transaction Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Bank:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date"},model:{value:e.newTransDate,callback:function(t){e.newTransDate=t},expression:"newTransDate"}}),e.$v.newTransDate.$anyDirty&&!e.$v.newTransDate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.banks,reduce:function(e){return e.bankUid},label:"bank",clearable:!1},on:{input:function(t){return e.getBankAccounts(e.newBank)}},model:{value:e.newBank,callback:function(t){e.newBank=t},expression:"newBank"}}),e.$v.newBank.$anyDirty&&!e.$v.newBank.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Bank Account:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Payment Type:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[""==e.bankAccounts?a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("span",{staticClass:"text-red"},[e._v("No Bank Account")])]):a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.bankAccounts,reduce:function(e){return e.bankAccountUid},label:"bankAccountNumber",clearable:!1},model:{value:e.newBankAccount,callback:function(t){e.newBankAccount=t},expression:"newBankAccount"}}),e.$v.newBankAccount.$anyDirty&&!e.$v.newBankAccount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.paymentTypes,reduce:function(e){return e.type},label:"type",clearable:!1},model:{value:e.newPaymentType,callback:function(t){e.newPaymentType=t},expression:"newPaymentType"}}),e.$v.newPaymentType.$anyDirty&&!e.$v.newPaymentType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},["Check"==e.newPaymentType?a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Check Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]):e._e(),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},["Check"==e.newPaymentType?a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.newCheckNo,callback:function(t){e.newCheckNo=t},expression:"newCheckNo"}}),e.$v.newCheckNo.$anyDirty&&!e.$v.newCheckNo.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newCheckNo.$anyDirty&&!e.$v.newCheckNo.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1):e._e(),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.newAmount,callback:function(t){e.newAmount=t},expression:"newAmount"}}),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newAmount.$anyDirty&&!e.$v.newAmount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Chart of Accounts:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Business Types:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.coas,reduce:function(e){return e.accountId},label:"account",clearable:!1},model:{value:e.newCOA,callback:function(t){e.newCOA=t},expression:"newCOA"}}),e.$v.newCOA.$anyDirty&&!e.$v.newCOA.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.businessTypes,reduce:function(e){return e.businessTypeId},label:"type",clearable:!1},model:{value:e.newBusinessType,callback:function(t){e.newBusinessType=t},expression:"newBusinessType"}}),e.$v.newBusinessType.$anyDirty&&!e.$v.newBusinessType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])]),a("b-modal",{attrs:{size:"xl",id:"view-loan-disbursement-modal",title:"View Loan Disbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.printLoanDisbursement(t)}}},[e._v(" Print ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("view-loan-disbursement-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("card",{staticClass:"pl-4 pt-5 pb-5 shadow",attrs:{id:"singleView"}},[a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("LOAN DISBURSEMENT")])]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Voucher Number: "+e._s(e.view.voucherNumber))])])]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Transaction Date: ")]),e._v(e._s(e._f("moment")(e.view.transactionDate,"MMMM DD, YYYY"))+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Amount: ")]),e._v("â‚± "+e._s(e.view.amount)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Bank: ")]),e._v(e._s(e.view.bank)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Account Number: ")]),e._v(e._s(e.view.account)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Payment Type: ")]),e._v(e._s(e.view.paymentType)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Chart of Account: ")]),e._v(e._s(e.view.coa)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Business Type: ")]),e._v(e._s(e.view.businessType)+" ")]),"Check"==e.view.paymentType?a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Check Number: ")]),e._v(e._s(e.view.checkReference)+" ")]):e._e()]),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Total Amount Due: ")]),e._v("â‚± "+e._s(""==e.view.totalAmountDue?"----------":e.view.totalAmountDue)+" ")]),a("span",{staticClass:"col-sm-6"},[a("b",[e._v("Total Amount: ")]),e._v("â‚± "+e._s(e.view.totalAmount)+" ")])]),e.dues.length>0?a("hr"):e._e(),e.dues.length>0?a("div",{staticClass:"row pb-2"},[a("span",{staticClass:"col-sm-2"},[a("b",[e._v("DUE DATE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("TERMS")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("PERCENT")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("AMOUNT DUE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("DAYS DUE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("TOTAL")])])]):e._e(),e._l(e.dues,(function(t){return a("div",{key:t.date,staticClass:"row"},[a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.date))]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.terms)+" days")]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.percent)+"%")]),a("span",{staticClass:"col-sm-2"},[e._v("â‚± "+e._s(t.amountDue))]),a("span",{staticClass:"col-sm-2"},[e._v(e._s(t.days)+" days")]),a("span",{staticClass:"col-sm-2"},[e._v("â‚± "+e._s(t.totalDue))])])})),a("hr"),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Received Payment by : ")])]),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Prepared by :")]),e._v(" "+e._s(e.user.firstname)+" "+e._s(e.user.lastname)+" ")])]),a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Certified by : ")])]),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Approved by : ")])])])],2)],1),a("b-modal",{attrs:{size:"lg",id:"attachment-modal",title:"Attachments",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[1==e.attachmentStatus?a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addAttachments()}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add Attachment ")]):e._e(),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("attachment-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("input",{ref:"attachmentFile",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.previewImage}}),e.loadAttachment?a("card",{attrs:{shadow:""}},[a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12 text-center"},[a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}}),a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}}),a("b-spinner",{staticClass:"ml-3 mr-3",attrs:{type:"grow",label:"Spinning"}})],1)])]):e._e(),e.attachments.length>0&&!e.loadAttachment?a("card",{attrs:{shadow:""}},[e.attachments.length>0?a("div",{staticClass:"row pl-4",attrs:{align:"center"}},e._l(e.attachments,(function(t){return a("span",{key:t.rowNum},[a("span",{staticClass:"col-4"},[a("div",{staticClass:"mt-1 mb--2 pr-2 text-right"},[1==e.attachmentStatus?a("span",{staticClass:"pointer far fa-times-circle text-danger",staticStyle:{"z-index":"1",position:"relative",left:"0px",top:"0px"},attrs:{title:"Remove"},on:{click:function(a){return e.removeAttachment(t.name)}}}):e._e()]),a("span",{staticClass:"mt-0"},[a("a",{attrs:{target:"_blank",href:t.url}},[a("img",{staticStyle:{width:"220px",height:"220px","border-style":"solid","border-color":"black","border-width":"2px"},attrs:{src:t.url}})])])])])})),0):e._e()]):e._e(),0!=e.attachments.length||e.loadAttachment?e._e():a("card",{attrs:{shadow:""}},[a("div",{staticClass:"row pl-4"},[a("span",{staticClass:"col-sm-12"},[a("h2",{staticClass:"text-center"},[e._v("NO ATTACHMENT")])])])])],1),a("b-modal",{attrs:{size:"xl",id:"edit-loan-disbursement-modal",title:"Edit Loan Disbursement",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateLoanDisbursement(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-loan-disbursement-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Transaction Date:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Bank:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"date"},model:{value:e.edit.transDate,callback:function(t){e.$set(e.edit,"transDate",t)},expression:"edit.transDate"}}),e.$v.edit.$anyDirty&&!e.$v.edit.transDate.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.banks,reduce:function(e){return e.bankUid},label:"bank",clearable:!1},on:{input:function(t){return e.getBankAccounts(e.edit.bank)}},model:{value:e.edit.bank,callback:function(t){e.$set(e.edit,"bank",t)},expression:"edit.bank"}}),e.$v.edit.$anyDirty&&!e.$v.edit.bank.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Bank Account:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Payment Type:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[""==e.bankAccounts?a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("span",{staticClass:"text-red"},[e._v("No Bank Account")])]):a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.bankAccounts,reduce:function(e){return e.bankAccountUid},label:"bankAccountNumber",clearable:!1},model:{value:e.edit.bankAccount,callback:function(t){e.$set(e.edit,"bankAccount",t)},expression:"edit.bankAccount"}}),e.$v.edit.$anyDirty&&!e.$v.edit.bankAccount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.paymentTypes,reduce:function(e){return e.type},label:"type",clearable:!1},model:{value:e.edit.paymentType,callback:function(t){e.$set(e.edit,"paymentType",t)},expression:"edit.paymentType"}}),e.$v.edit.$anyDirty&&!e.$v.edit.paymentType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},["Check"==e.edit.paymentType?a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Check Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]):e._e(),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Amount:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},["Check"==e.edit.paymentType?a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.edit.checkNo,callback:function(t){e.$set(e.edit,"checkNo",t)},expression:"edit.checkNo"}}),e.$v.edit.$anyDirty&&!e.$v.edit.checkNo.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.checkNo.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1):e._e(),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.edit.amount,callback:function(t){e.$set(e.edit,"amount",t)},expression:"edit.amount"}}),e.$v.edit.$anyDirty&&!e.$v.edit.amount.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.amount.amountCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Chart of Accounts:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Business Types:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.coas,reduce:function(e){return e.accountId},label:"account",clearable:!1},model:{value:e.edit.coa,callback:function(t){e.$set(e.edit,"coa",t)},expression:"edit.coa"}}),e.$v.edit.$anyDirty&&!e.$v.edit.coa.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.businessTypes,reduce:function(e){return e.businessTypeId},label:"type",clearable:!1},model:{value:e.edit.businessType,callback:function(t){e.$set(e.edit,"businessType",t)},expression:"edit.businessType"}}),e.$v.edit.$anyDirty&&!e.$v.edit.businessType.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])]),a("b-modal",{attrs:{size:"lg",id:"loan-percent-modal",title:"Percents",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.show("add-loan-percent-modal")}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add Loan Percent ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("loan-percent-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"table-full-width"},[a("vue-good-table",{attrs:{columns:e.percentColumns,rows:e.loanPercents,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,15,20]},"sort-options":{enabled:!0},"line-numbers":!0,isLoading:e.loadingPercent},scopedSlots:e._u([{key:"table-row",fn:function(t){return[a("b",["percent"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.percent)+"%")])]):e._e(),"terms"==t.column.field?a("span",[a("span",[e._v(e._s(t.row.terms)+" day/s")])]):e._e(),"action"==t.column.field?a("span",[a("span",{staticClass:"pointer ml-2 far fa-edit",attrs:{id:"sideBarTxt",title:"Update"},on:{click:function(a){return e.openUpdatePercentModal(t.row)}}}),a("span",{staticClass:"pointer ml-2 fa fa-times-circle",attrs:{id:"sideBarTxt",title:"Remove"},on:{click:function(a){return e.removeLoanPercent(t.row)}}})]):e._e()])]}}])})],1)]),a("b-modal",{attrs:{size:"sm",id:"add-loan-percent-modal",title:"Add Loan Percent",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.addLoanPercent(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Add ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("add-loan-percent-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Percent:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.newPercent,callback:function(t){e.newPercent=t},expression:"newPercent"}}),e.$v.newPercent.$anyDirty&&!e.$v.newPercent.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newPercent.$anyDirty&&!e.$v.newPercent.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Terms:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.newTerms,callback:function(t){e.newTerms=t},expression:"newTerms"}}),e.$v.newTerms.$anyDirty&&!e.$v.newTerms.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.newTerms.$anyDirty&&!e.$v.newTerms.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])]),a("b-modal",{attrs:{size:"sm",id:"edit-loan-percent-modal",title:"Edit Loan Percent",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateLoanPercent(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-loan-percent-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Percent:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.editLoan.percent,callback:function(t){e.$set(e.editLoan,"percent",t)},expression:"editLoan.percent"}}),e.$v.editLoan.$anyDirty&&!e.$v.editLoan.percent.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editLoan.$anyDirty&&!e.$v.editLoan.percent.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Terms:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{type:"text"},model:{value:e.editLoan.terms,callback:function(t){e.$set(e.editLoan,"terms",t)},expression:"editLoan.terms"}}),e.$v.editLoan.$anyDirty&&!e.$v.editLoan.terms.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.editLoan.$anyDirty&&!e.$v.editLoan.terms.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])])],1)])],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"col-sm-6"},[a("b",[e._v("LOAN DISBURSEMENT")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row pb-2"},[a("span",{staticClass:"col-sm-2"},[a("b",[e._v("DUE DATE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("TERMS")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("PERCENT")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("AMOUNT DUE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("DAYS DUE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("TOTAL")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Received Payment by : ")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Certified by : ")])]),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Approved by : ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"col-sm-6"},[a("b",[e._v("LOAN DISBURSEMENT")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row pb-2"},[a("span",{staticClass:"col-sm-2"},[a("b",[e._v("DUE DATE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("TERMS")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("PERCENT")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("AMOUNT DUE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("DAYS DUE")])]),a("span",{staticClass:"col-sm-2"},[a("b",[e._v("TOTAL")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Received Payment by : ")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Certified by : ")])]),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-5"},[a("b",[e._v("Approved by : ")])])])}],n=(a("4160"),a("fb6a"),a("b0c0"),a("b680"),a("d3b7"),a("25f0"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),o=a("56d7"),l=a("b5ae"),c=a("4627"),d=a("add5"),u=a.n(d),m=a("2f62"),p=l["helpers"].regex("alphaNumAndDot",/^[ 0-9 ., ]*$/),b=l["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),f=a("c1df"),v=a("e966"),h=v.bindWith(",","."),C=new Date,w=a("9f25"),g={components:{},data:function(){return{columns:[{label:"Voucher No.",field:"voucherNumber"},{label:"Amount",field:"amount"},{label:"Transaction Date",field:"transactionDate"},{label:"Bank",field:"bank"},{label:"Bank Account",field:"account"},{label:"Created by",field:"userReference"},{label:"Status",field:"status"},{label:"",field:"action",width:"100px",sortable:!1}],loading:!0,loanDisbursements:[],requestProcessing:!1,views:[{limitId:"30",limit:"30 Records"},{limitId:"50",limit:"50 Records"},{limitId:"all",limit:"All Records"}],limit:"30",filters:[{filterId:"month",filter:"Month"}],filter:"month",dateCreated:f().format("YYYY-MM"),maxDate:f().format("YYYY-MM"),listType:"",newType:"",banks:[],bankAccounts:[],paymentTypes:[{type:"Cash"},{type:"Check"}],coas:[],businessTypes:[],newTransDate:f().format("YYYY-MM-DD"),newBank:"",newBankAccount:"",newPaymentType:"Cash",newCheckNo:"",newAmount:"",newCOA:"",newBusinessType:"",view:{voucherNumber:"",amount:"",transactionDate:"",bank:"",account:"",paymentType:"",checkReference:"",coa:"",businessTypes:""},dues:[],attachment:"",attachmentData:null,attachments:[],ldId:"",uploadValue:0,loadAttachment:!0,edit:{id:"",ldId:"",transDate:"",bank:"",bankAccount:"",paymentType:"",checkNo:"",amount:"",coa:"",businessType:""},percentColumns:[{label:"Percent (%)",field:"percent"},{label:"Terms (Days)",field:"terms"},{label:"",field:"action",width:"80px",sortable:!1}],loanPercents:[],loanId:"",loadingPercent:!1,newPercent:"",newTerms:"",editLoan:{id:"",pId:"",percent:"",terms:"",loanReference:""},userRole:"",user:{firstname:"",lastname:""},breakCounts:0}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUserRole(),e.getLoanDisbursements("Release"),e.getBanks(),e.getChartOfAccounts(),e.getBusinessTypes(),e.getUser();case 6:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(m["b"])({users:"Users/users"})),validations:{newTransDate:{required:l["required"]},newBank:{required:l["required"]},newBankAccount:{required:l["required"]},newPaymentType:{required:l["required"]},newCheckNo:{required:l["required"],numCustomValidator:b},newAmount:{required:l["required"],amountCustomValidator:p},newCOA:{required:l["required"]},newBusinessType:{required:l["required"]},edit:{transDate:{required:l["required"]},bank:{required:l["required"]},bankAccount:{required:l["required"]},paymentType:{required:l["required"]},checkNo:{required:l["required"],numCustomValidator:b},amount:{required:l["required"],amountCustomValidator:p},coa:{required:l["required"]},businessType:{required:l["required"]}},newPercent:{required:l["required"],numCustomValidator:b},newTerms:{required:l["required"],numCustomValidator:b},editLoan:{percent:{required:l["required"],numCustomValidator:b},terms:{required:l["required"],numCustomValidator:b}}},methods:{getUserRole:function(){var e=this;e.username=localStorage.getItem("aisname"),e.accountName=e.username.toUpperCase();var t=o["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||t.forEach((function(e){a.push(e.data())}));var s=o["dbUsers"].collection("userRoles").where("userRoleId","==",a[0].userRoleReference),r=[];s.get().then((function(t){t.empty||(t.forEach((function(e){r.push(e.data())})),e.userRole=r[0].userRole)}))}))},getUser:function(){var e=this;e.username=localStorage.getItem("aisname");var t=o["dbUsers"].collection("users").where("username","==",e.username),a=[];t.get().then((function(t){t.empty||(t.forEach((function(e){a.push(e.data())})),e.user.firstname=a[0].firstname,e.user.lastname=a[0].lastname)}))},getBanks:function(){var e=this,t=o["dbMains"].collection("banks").orderBy("bank","asc");e.banks=[],t.get().then((function(t){t.forEach((function(t){e.banks.push(t.data())})),e.newBank=e.banks[0].bankUid,e.getBankAccounts(e.banks[0].bankUid)}))},getBankAccounts:function(e){var t=this,a=o["dbMains"].collection("bankAccounts").where("bankReference","==",e).orderBy("bankAccountNumber","asc");t.bankAccounts=[],a.get().then((function(e){e.forEach((function(e){t.bankAccounts.push(e.data())})),t.newBankAccount=t.bankAccounts[0].bankAccountUid}))},getChartOfAccounts:function(){var e=this,t=o["dbMains"].collection("chartOfAccounts").orderBy("account","asc");e.coas=[],t.get().then((function(t){t.forEach((function(t){e.coas.push(t.data())})),e.newCOA=e.coas[0].accountId}))},getBusinessTypes:function(){var e=this,t=o["dbMains"].collection("businessTypes").orderBy("type","asc");e.businessTypes=[],t.get().then((function(t){t.forEach((function(t){e.businessTypes.push(t.data())})),e.newBusinessType=e.businessTypes[0].businessTypeId}))},newLoanDisbursement:function(){var e=this,t=!1;if(e.$v.newTransDate.$touch(),e.$v.newBank.$touch(),e.$v.newBankAccount.$touch(),e.$v.newPaymentType.$touch(),e.$v.newCheckNo.$touch(),e.$v.newAmount.$touch(),e.$v.newCOA.$touch(),e.$v.newBusinessType.$touch(),"Cash"==e.newPaymentType?(e.$v.newTransDate.$error||e.$v.newBank.$error||e.$v.newBankAccount.$error||e.$v.newPaymentType.$error||e.$v.newAmount.$error||e.$v.newCOA.$error||e.$v.newBusinessType.$error)&&(t=!0):"Check"==e.newPaymentType&&(e.$v.newTransDate.$error||e.$v.newBank.$error||e.$v.newBankAccount.$error||e.$v.newPaymentType.$error||e.$v.newCheckNo.$error||e.$v.newAmount.$error||e.$v.newCOA.$error||e.$v.newBusinessType.$error)&&(t=!0),!t){e.requestProcessing=!0;try{var a=o["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),s=[],r="LDI-"+C.getFullYear()+w(C.getMonth()+1,2)+C.getDate()+"-"+Math.floor(1e6*Math.random()),n=o["dbUsers"].collection("loanDisbursements").orderBy("dateCreated","desc").limit(1),i="";n.get().then((function(t){t.forEach((function(e){e.exists&&(i=e.data().voucherNumber)}));var n="",l=new Date;""!=i?(n=w(parseInt(i.slice(7))+1,4),"1000"==n.toString()&&(n="0001")):n="0001",a.get().then((function(t){t.forEach((function(e){s.push(e.data())})),o["dbUsers"].collection("loanDisbursements").doc().set({loanDisbursementId:r,transactionDate:e.newTransDate,bankReference:e.newBank,bankAccountReference:e.newBankAccount,paymentType:e.newPaymentType,checkReference:e.newCheckNo,amount:e.newAmount,totalAmountDue:"",voucherNumber:w(l.getMonth()+1)+""+l.getFullYear().toString().slice(2,4)+"-2"+n,accountReference:e.newCOA,businessTypeReference:e.newBusinessType,status:1,userReference:s[0].userId,dateCreated:C,dateModified:C}).then((function(){e.$swal({title:"Success",text:"New loan disbursement added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.newTransDate=f().format("YYYY-MM-DD"),e.newBank="",e.newBankAccount="",e.newPaymentType="Cash",e.newCheckNo="",e.newAmount="",e.newCOA="",e.newBusinessType="",e.requestProcessing=!1,e.$v.newTransDate.$reset(),e.$v.newBank.$reset(),e.$v.newBankAccount.$reset(),e.$v.newPaymentType.$reset(),e.$v.newCheckNo.$reset(),e.$v.newAmount.$reset(),e.$v.newCOA.$reset(),e.$v.newBusinessType.$reset(),e.$bvModal.hide("new-loan-disbursement-modal"),e.$refs["loan-disbursement-table"].reset(),e.getBanks(),e.getChartOfAccounts(),e.getBusinessTypes(),e.getLoanDisbursements(e.listType)}))}))}))}))}catch(l){console.log(l),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}},getLoanDisbursements:function(e){var t=this,a=null,s=[],r=[],n=f(t.dateCreated).startOf("month").format("YYYY-MM-DD"),i=f(t.dateCreated).endOf("month").format("YYYY-MM-DD");t.username=localStorage.getItem("aisname"),t.accountName=t.username.toUpperCase();var l=o["dbUsers"].collection("users").where("username","==",t.username),c=[],d="",u="";l.get().then((function(l){l.forEach((function(e){c.push(e.data())})),u=c[0].userId;var m=o["dbUsers"].collection("userRoles").where("userRoleId","==",c[0].userRoleReference),p=[];m.get().then((function(l){l.forEach((function(e){p.push(e.data())})),d=p[0].userRole,t.loading=!0,t.loanDisbursements=[],t.listType=e,"Administrator"==d||"Manager"==d?"Release"==e?"all"!=t.limit?a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("status","==",1).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("status","==",1)):"Cleared"==e?"all"!=t.limit?a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("status","==",2).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("status","==",2)):"All"==e&&("all"!=t.limit?a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i))):"User"==d&&("Release"==e?"all"!=t.limit?a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).where("status","==",1).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).where("status","==",1)):"Cleared"==e?"all"!=t.limit?a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).where("status","==",2).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).where("status","==",2)):"All"==e&&("all"!=t.limit?a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u).limit(t.limit):"all"==t.limit&&(a=o["dbUsers"].collection("loanDisbursements").where("transactionDate",">=",n).where("transactionDate","<=",i).where("userReference","==",u)))),a.get().then((function(e){if(!e.empty){e.forEach((function(e){r.push(e.data()),s.push(e.id)}));var a=o["dbMains"].collection("banks"),n=o["dbMains"].collection("bankAccounts"),i=o["dbMains"].collection("chartOfAccounts"),l=o["dbMains"].collection("businessTypes"),c=[],d=[],u=[],m=[];a.get().then((function(e){e.forEach((function(e){c.push(e.data())})),n.get().then((function(e){e.forEach((function(e){d.push(e.data())})),i.get().then((function(e){e.forEach((function(e){u.push(e.data())})),l.get().then((function(e){e.forEach((function(e){m.push(e.data())}));for(var a=0;a<r.length;a++){r[a]["id"]=s[a],r[a]["bank"]="",r[a]["account"]="",r[a]["coa"]="",r[a]["businessType"]="",r[a]["totalAmount"]="",r[a].amount=h(parseFloat(r[a].amount.replaceAll(",","")).toFixed(2)),t.loanDisbursements.push(r[a]);for(var n=0;n<c.length;n++)c[n].bankUid==r[a].bankReference&&(r[a].bank=c[n].bank);for(var i=0;i<d.length;i++)d[i].bankAccountUid==r[a].bankAccountReference&&(r[a].account=d[i].bankAccountNumber);for(var o=0;o<u.length;o++)u[o].accountId==r[a].accountReference&&(r[a].coa=u[o].account);for(var l=0;l<m.length;l++)m[l].businessTypeId==r[a].businessTypeReference&&(r[a].businessType=m[l].type)}}))}))}))}))}setTimeout((function(){t.loading=!1}),1e3)}))}))}))},openViewLoanDisbursementModal:function(e){var t=this,a=[],s=o["dbUsers"].collection("loanPercents").where("loanReference","==",e.loanDisbursementId).orderBy("terms","asc");s.get().then((function(s){s.forEach((function(e){a.push(e.data())}));var r,n="",i="",o=0,l=0;t.dues=[];for(var c=0;c<a.length;c++)r=f(e.transactionDate).add(a[c].terms,"days").format("MMM DD, YYYY"),t.dues.push({date:r});a.length<=1?t.breakCounts=12:a.length>1&&a.length<12&&(t.breakCounts=13-a.length);for(var d=0;d<t.dues.length;d++){var u=0;t.dues[d]["days"]=0,t.dues[d]["amountDue"]=0,t.dues[d]["totalDue"]=0,t.dues[d]["percent"]=a[d].percent,t.dues[d]["terms"]=a[d].terms,1==t.dues.length?f(C).isAfter(t.dues[d].date)&&(n=parseFloat(a[d].percent)/100,n=parseFloat(n).toFixed(2),i=n*parseFloat(e.amount.replaceAll(",","")),l=f(C).diff(f(t.dues[d]),"days"),t.dues[d].amountDue=h(parseFloat(i).toFixed(2)),t.dues[d].days=l,i*=l,t.dues[d].totalDue=h(parseFloat(i).toFixed(2)),o+=i):t.dues.length>1&&(u=d+1,u<t.dues.length&&f(C).isAfter(t.dues[d].date)&&(f(C).isSameOrBefore(t.dues[d+1].date)?(n=parseFloat(a[d].percent)/100,n=parseFloat(n).toFixed(2),i=n*parseFloat(e.amount.replaceAll(",","")),l=f(C).diff(f(t.dues[d].date),"days"),t.dues[d].amountDue=h(parseFloat(i).toFixed(2)),t.dues[d].days=l,i*=l,t.dues[d].totalDue=h(parseFloat(i).toFixed(2)),o+=i):(n=parseFloat(a[d].percent)/100,n=parseFloat(n).toFixed(2),i=n*parseFloat(e.amount.replaceAll(",","")),d>0?(l=f(t.dues[d-1].date).diff(f(t.dues[d].date),"days"),l<0&&(l*=-1)):0==d&&(l=f(t.dues[d+1].date).diff(f(t.dues[d].date),"days"),l<0&&(l*=-1)),t.dues[d].amountDue=h(parseFloat(i).toFixed(2)),t.dues[d].days=l,i*=l,t.dues[d].totalDue=h(parseFloat(i).toFixed(2)),o+=i)),u==t.dues.length&&f(C).isAfter(t.dues[d].date)&&(n=parseFloat(a[d].percent)/100,n=parseFloat(n).toFixed(2),i=n*parseFloat(e.amount.replaceAll(",","")),l=f(C).diff(f(t.dues[d].date),"days"),t.dues[d].amountDue=h(parseFloat(i).toFixed(2)),t.dues[d].days=l,i*=l,t.dues[d].totalDue=h(parseFloat(i).toFixed(2)),o+=i))}t.view={voucherNumber:e.voucherNumber,amount:e.amount,transactionDate:e.transactionDate,bank:e.bank,account:e.account,paymentType:e.paymentType,checkReference:e.checkReference,totalAmountDue:h(parseFloat(o).toFixed(2)),coa:e.coa,businessType:e.businessType,totalAmount:h(parseFloat(o+parseFloat(e.amount.replaceAll(",",""))).toFixed(2))},t.$bvModal.show("view-loan-disbursement-modal")}))},openAttachments:function(e){this.ldId=e.loanDisbursementId,this.attachmentStatus=e.status,this.$bvModal.show("attachment-modal"),this.getAttachments(this.ldId)},addAttachments:function(){this.$refs.attachmentFile.click()},previewImage:function(e){var t=this,a={maxSizeMB:1,useWebWorker:!0};t.uploadValue=0,t.attachment=null,t.attachments=[],t.attachmentData=e.target.files[0],Object(c["a"])(t.attachmentData,a).then((function(e){t.attachmentData=e,t.onUpload(t.attachmentData)}))},onUpload:function(e){var t=this,a=o["storageMains"].ref("loanDisbursements/"+t.ldId+"/"+e.name).put(e);t.requestProcessing=!1;try{t.attachment=null,t.requestProcessing=!0,a.on("state_changed",(function(e){t.uploadValue=e.bytesTransferred/e.totalBytes*100}),(function(e){console.log(e.message)}),(function(){t.uploadValue=100,t.$swal({title:"Success",text:"Attachment uploaded successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}),t.requestProcessing=!1,t.getAttachments(t.ldId)}))}catch(s){console.log("error"),t.requestProcessing=!1,t.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#f5365c",confirmButtonText:"OK"})}},getAttachments:function(e){var t=this,a=0,s=o["storageMains"].ref("loanDisbursements/"+e);t.loadAttachment=!0,t.attachments=[],s.listAll().then((function(s){s.items.forEach((function(s){o["storageMains"].ref("loanDisbursements/"+e+"/"+s.name).getDownloadURL().then((function(e){a+=1,t.attachments.push({rowNum:a,name:s.name,url:e,path:s.fullPath,status:1})}))}))})).catch((function(e){console.log(e)})),setTimeout((function(){t.loadAttachment=!1}),5e3)},removeAttachment:function(e){var t=this;t.$swal({title:"Are you sure?",text:"You want to remove this attachment?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM",cancelButtonText:"CANCEL"}).then((function(a){if(a.value){var s=o["storageMains"].ref("loanDisbursements/"+t.ldId+"/"+e);try{s.delete().then((function(){t.$swal({title:"Success",text:"Attachment remove successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){t.getAttachments(t.ldId)}))}))}catch(r){console.log(r),t.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#f5365c",confirmButtonText:"OK"})}}}))},openUpdateLDModal:function(e){var t=this;t.edit={id:e.id,ldId:e.cashDisbursementId,transDate:e.transactionDate,bank:e.bankReference,bankAccount:e.bankAccountReference,paymentType:e.paymentType,checkNo:e.checkReference,amount:e.amount,coa:e.accountReference,businessType:e.businessTypeReference},t.$bvModal.show("edit-loan-disbursement-modal")},updateLoanDisbursement:function(){var e=this,t=!1;if(e.$v.edit.transDate.$touch(),e.$v.edit.bank.$touch(),e.$v.edit.bankAccount.$touch(),e.$v.edit.paymentType.$touch(),e.$v.edit.amount.$touch(),e.$v.edit.coa.$touch(),e.$v.edit.businessType.$touch(),"Cash"==e.edit.paymentType?(e.$v.edit.transDate.$error||e.$v.edit.bank.$error||e.$v.edit.bankAccount.$error||e.$v.edit.paymentType.$error||e.$v.edit.amount.$error||e.$v.edit.coa.$error||e.$v.edit.businessType.$error)&&(t=!0):"Check"==e.edit.paymentType&&(e.$v.edit.transDate.$error||e.$v.edit.bank.$error||e.$v.edit.bankAccount.$error||e.$v.edit.paymentType.$error||e.$v.edit.checkNo.$error||e.$v.edit.amount.$error||e.$v.edit.coa.$error||e.$v.edit.businessType.$error)&&(t=!0),!t){e.requestProcessing=!0;try{o["dbUsers"].collection("loanDisbursements").doc(e.edit.id).update({transactionDate:e.edit.transDate,bankReference:e.edit.bank,bankAccountReference:e.edit.bankAccount,paymentType:e.edit.paymentType,checkReference:e.edit.checkNo,amount:e.edit.amount,accountReference:e.edit.coa,businessTypeReference:e.edit.businessType,dateModified:C}).then((function(){e.edit={id:"",ldId:"",transDate:"",bank:"",bankAccount:"",paymentType:"",checkNo:"",amount:"",coa:"",businessType:""},e.requestProcessing=!1,e.$v.edit.$reset(),e.$bvModal.hide("edit-loan-disbursement-modal"),e.$refs["loan-disbursement-table"].reset(),e.getLoanDisbursements(e.listType),e.$swal({title:"Success",text:"Loan disbursement updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}},openLoanPercentModal:function(e){this.loanId=e.loanDisbursementId,this.getLoanPercents(e.loanDisbursementId),this.$bvModal.show("loan-percent-modal")},getLoanPercents:function(e){var t=this,a=null,s=[],r=[];t.loanPercents=[],t.loadingPercent=!0,a=o["dbUsers"].collection("loanPercents").where("loanReference","==",e).orderBy("terms","asc"),a.get().then((function(e){if(!e.empty){e.forEach((function(e){r.push(e.data()),s.push(e.id)}));for(var a=0;a<r.length;a++)r[a]["id"]=s[a],t.loanPercents.push(r[a])}})),setTimeout((function(){t.loadingPercent=!1}),1e3)},addLoanPercent:function(){var e=this;if(e.$v.newPercent.$touch(),e.$v.newTerms.$touch(),!e.$v.newPercent.$error&&!e.$v.newTerms.$error){e.requestProcessing=!0;try{var t=o["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),a=[],s="LPI-"+C.getFullYear()+w(C.getMonth()+1,2)+C.getDate()+"-"+Math.floor(1e6*Math.random());t.get().then((function(t){t.forEach((function(e){a.push(e.data())})),o["dbUsers"].collection("loanPercents").doc().set({loanPercentId:s,percent:e.newPercent,terms:parseInt(e.newTerms),loanReference:e.loanId,status:1,userReference:a[0].userId,dateCreated:C,dateModified:C}).then((function(){e.$swal({title:"Success",text:"New loan percent added successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"}).then((function(){e.newPercent="",e.newTerms="",e.requestProcessing=!1,e.$v.newPercent.$reset(),e.$v.newTerms.$reset(),e.$bvModal.hide("add-loan-percent-modal"),e.getLoanPercents(e.loanId)}))}))}))}catch(r){console.log(r),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}},openUpdatePercentModal:function(e){var t=this;t.loanId=e.loanReference,t.editLoan={id:e.id,pId:e.loanPercentId,percent:e.percent,terms:e.terms,loanReference:e.loanReference},t.$bvModal.show("edit-loan-percent-modal")},updateLoanPercent:function(){var e=this;if(e.$v.editLoan.$touch(),!e.$v.editLoan.$error){e.requestProcessing=!0;try{o["dbUsers"].collection("loanPercents").doc(e.editLoan.id).update({percent:e.editLoan.percent,terms:parseInt(e.editLoan.terms),dateModified:C}).then((function(){e.edit={id:"",pId:"",percent:"",terms:""},e.requestProcessing=!1,e.$v.editLoan.$reset(),e.$bvModal.hide("edit-loan-percent-modal"),console.log(e.loanId),e.getLoanPercents(e.loanId),e.$swal({title:"Success",text:"Loan percent updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(t){console.log(t),e.requestProcessing=!1,e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}}},removeLoanPercent:function(e){var t=this;t.requestProcessing=!0;try{o["dbUsers"].collection("loanPercents").doc(e.id).delete().then((function(){t.requestProcessing=!1,t.getLoanPercents(t.loanId),t.$swal({title:"Success",text:"Loan percent remove successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}catch(a){console.log(a),t.requestProcessing=!1,t.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}},changeStatus:function(e,t){var a=this,s="";1==t?s="Release":2==t&&(s="Cleared"),a.$swal({title:"Are you sure?",text:"You want to change the status to "+s,icon:"warning",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#C72111",confirmButtonText:"CONFIRM"}).then((function(r){r.value&&o["dbUsers"].collection("loanDisbursements").doc(e.id).update({status:t,dateModified:C}).then((function(){a.$refs["loan-disbursement-table"].reset(),a.getLoanDisbursements(s),a.$swal({title:"Success",text:"Loan disbursement status change successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})}))}))},printLoanDisbursement:function(){this.$swal({title:"Print with duplicate?",text:"",icon:"question",showCancelButton:!0,confirmButtonColor:"#b80000",cancelButtonColor:"#f5c71a",confirmButtonText:"YES",cancelButtonText:"NO"}).then((function(e){e.value?u()({printable:"duplicateView",type:"html",style:'#duplicateView {font-family: "Calibri";} #borderStyle {border-width: 1px; border-style: solid;} #docStyle {display: block; overflow: inherit; white-space: normal; font-size: 12px;}',documentTitle:"Loan Disbursement Voucher"}):u()({printable:"singleView",type:"html",style:'#singleView {font-family: "Calibri";} #borderStyle {border-width: 1px; border-style: solid;} #docStyle {display: block; overflow: inherit; white-space: normal; font-size: 12px;}',documentTitle:"Loan Disbursement Voucher"})}))}}},y=g,_=(a("a994"),a("2877")),k=Object(_["a"])(y,s,r,!1,null,null,null);t["default"]=k.exports},e579:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--6"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4 text-center pt-3 pb-3"},[a("card",{attrs:{type:"user"}},[a("p",{staticClass:"card-text pt-5 pb-3"},[a("b-avatar",{attrs:{id:"redBg",size:"9rem",text:e.avatarLetter}})],1),a("div",{staticClass:"author"},[a("hr"),a("div",{staticClass:"block block-two"}),a("div",{staticClass:"block block-three"}),a("div",{staticClass:"block block-four"})])])],1),a("div",{staticClass:"col-md-8 pt-8 pb-3"},[a("card",[a("div",{staticClass:"card-header bg-transparent pb-2"},[a("div",{staticClass:"text-left"},[a("b",[e._v("COMPANY PROFILE")])])]),a("div",{staticClass:"row pt-3 pl-3 mb-0"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Name: ")]),e._v(e._s(e.company.name)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Address: ")]),e._v(e._s(e.company.address)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Tin Number: ")]),e._v(e._s(e.company.tinNumber)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Tel No.: ")]),e._v(e._s(e.company.telNumber)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Telefax: ")]),e._v(e._s(e.company.telefax)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Email Address: ")]),e._v(e._s(e.company.emailAddress)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"text-right"},[a("base-button",{staticClass:"col-md-2 ml-2",attrs:{id:"darkBtn"},nativeOn:{click:function(t){return e.openEditProfileModal(e.company)}}},[e._v("Edit")])],1)])],1)]),a("b-modal",{attrs:{size:"lg",id:"edit-profile-modal",title:"Edit Company Profile",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateProfile(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-profile-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Company Name:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Address:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Company Name"},model:{value:e.edit.name,callback:function(t){e.$set(e.edit,"name",t)},expression:"edit.name"}}),e.$v.edit.$anyDirty&&!e.$v.edit.name.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.name.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.address,expression:"edit.address"}],staticClass:"pl-2",attrs:{rows:"4",cols:"39",id:"inputStyle",placeholder:"Address"},domProps:{value:e.edit.address},on:{input:function(t){t.target.composing||e.$set(e.edit,"address",t.target.value)}}}),e.$v.edit.$anyDirty&&!e.$v.edit.address.required?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()])]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Tin Number:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Tel No.:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Tin Number"},model:{value:e.edit.tinNumber,callback:function(t){e.$set(e.edit,"tinNumber",t)},expression:"edit.tinNumber"}}),e.$v.edit.$anyDirty&&!e.$v.edit.tinNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.tinNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Tel No."},model:{value:e.edit.telNo,callback:function(t){e.$set(e.edit,"telNo",t)},expression:"edit.telNo"}}),e.$v.edit.$anyDirty&&!e.$v.edit.telNo.contactNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Telefax:")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Email Address:")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Telefax"},model:{value:e.edit.telefax,callback:function(t){e.$set(e.edit,"telefax",t)},expression:"edit.telefax"}}),e.$v.edit.$anyDirty&&!e.$v.edit.telefax.contactNumCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Email Address"},model:{value:e.edit.emailAddress,callback:function(t){e.$set(e.edit,"emailAddress",t)},expression:"edit.emailAddress"}}),e.$v.edit.$anyDirty&&!e.$v.edit.emailAddress.email?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)])])],1)],1)},r=[],n=(a("4160"),a("fb6a"),a("b0c0"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=o["helpers"].regex("alphaNumAndDot",/^[ A-Za-z. ]*$/),c=o["helpers"].regex("alphaNumAndDot",/^[ -. 0-9 ]*$/),d=o["helpers"].regex("alphaNumAndDot",/^[ -. 0-9() ]*$/),u=new Date,m={name:"user-profile",data:function(){return{company:[],departments:[],userRole:"",avatarLetter:"",edit:{id:"",name:"",address:"",tinNumber:"",telNo:"",telefax:"",emailAddress:""},repeatPassword:"",requestProcessing:!1}},beforeRouteEnter:function(e,t,a){var s=localStorage.getItem("aisname"),r=i["dbUsers"].collection("users").where("username","==",s),n=[];r.get().then((function(e){if(!e.empty){e.forEach((function(e){n.push(e.data())}));var t=i["dbUsers"].collection("userRoles").where("userRoleId","==",n[0].userRoleReference),s=[];t.get().then((function(e){e.forEach((function(e){s.push(e.data())})),"User"==s[0].userRole?a("/main/home"):"Administrator"!=s[0].userRole&&"Manager"!=s[0].userRole||a()}))}}))},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getCompany();case 1:case"end":return t.stop()}}),t)})))()},validations:{edit:{name:{required:o["required"],alphaCustomValidator:l},address:{required:o["required"]},tinNumber:{required:o["required"],numCustomValidator:c},telNo:{contactNumCustomValidator:d},telefax:{contactNumCustomValidator:d},emailAddress:{email:o["email"]}}},methods:{getCompany:function(){var e=this,t=i["dbMains"].collection("companyProfile"),a="";e.company=[],t.get().then((function(t){t.forEach((function(t){e.company.push(t.data()),a=t.id}));for(var s=0;s<e.company.length;s++)e.company[s]["id"]=a;e.company=e.company[0],e.avatarLetter=e.company.name.slice(0,1)}))},openEditProfileModal:function(e){this.edit={id:e.id,name:e.name,address:e.address,tinNumber:e.tinNumber,telNo:e.telNumber,telefax:e.telefax,emailAddress:e.emailAddress},this.$bvModal.show("edit-profile-modal")},updateProfile:function(){var e=this;e.requestProcessing=!1,e.$v.edit.$touch(),e.$v.edit.$error||(e.requestProcessing=!0,i["dbMains"].collection("companyProfile").doc(e.edit.id).update({name:e.edit.name,address:e.edit.address,tinNumber:e.edit.tinNumber,telNumber:e.edit.telNo,telefax:e.edit.telefax,emailAddress:e.edit.emailAddress,dateModified:u}).then((function(){e.$v.edit.$reset(),e.$bvModal.hide("edit-profile-modal"),e.getCompany(),e.requestProcessing=!1,e.$swal({title:"Success",text:"Compnay profile updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){e.requestProcessing=!1,console.log(t),e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})))}}},p=m,b=a("2877"),f=Object(b["a"])(p,s,r,!1,null,null,null);t["default"]=f.exports},f10e:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-header",{staticClass:"pb-6 pb-8 pt-5"}),a("div",{staticClass:"col-12 container-fluid mt--6"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4 text-center pt-3 pb-3"},[a("card",{attrs:{type:"user"}},[a("p",{staticClass:"card-text pt-5 pb-3"},[a("b-avatar",{attrs:{id:"redBg",size:"9rem"}})],1),a("div",{staticClass:"author"},[a("hr"),a("h2",{staticClass:"display-5",attrs:{id:"darkTxt"}},[a("b",[e._v(e._s(e.user.username))])]),a("div",{staticClass:"block block-two"}),a("div",{staticClass:"block block-three"}),a("div",{staticClass:"block block-four"})])])],1),a("div",{staticClass:"col-md-8 pt-3 pb-3"},[a("card",[a("div",{staticClass:"card-header bg-transparent pb-2"},[a("div",{staticClass:"text-left"},[a("b",[e._v("PROFILE")])])]),a("div",{staticClass:"row pt-3 pl-3 mb-0"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Name: ")]),e._v(e._s(e.user.firstname)+" "+e._s(e.user.lastname)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Role: ")]),e._v(e._s(e.userRole)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Email Address: ")]),e._v(e._s(e.user.emailAddress)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Contact Number: ")]),e._v(e._s(e.user.contactNumber)+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Status: ")]),e._v(e._s(1==e.user.status?"Active":"Disabled")+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},[a("span",{staticClass:"col-sm-12"},[a("b",[e._v("Date Created: ")]),e._v(e._s(e._f("moment")(e.user.dateCreated,"MMMM DD, YYYY"))+" ")])]),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"row pl-3"},e._l(e.departments,(function(t){return a("span",{key:t.departmentUid,staticClass:"col-sm-12"},[t.departmentUid==e.user.departmentReference?a("span",[a("b",[e._v("Department: ")]),e._v(e._s(t.departmentName)+" ")]):e._e()])})),0),a("hr",{staticClass:"mt-2 mb-2"}),a("div",{staticClass:"text-right"},[a("base-button",{staticClass:"col-md-2 ml-2",attrs:{id:"darkBtn"},nativeOn:{click:function(t){return e.openEditProfileModal(e.user)}}},[e._v("Edit")]),a("base-button",{staticClass:"col-md-4 ml-2",attrs:{id:"darkInlineBtn"},nativeOn:{click:function(t){return e.$bvModal.show("change-password-modal")}}},[e._v("Change Password")])],1)])],1)]),a("b-modal",{attrs:{size:"lg",id:"edit-profile-modal",title:"Edit Profile",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.updateProfile(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("edit-profile-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Firstname:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Middlename:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Firstname"},model:{value:e.edit.firstname,callback:function(t){e.$set(e.edit,"firstname",t)},expression:"edit.firstname"}}),e.$v.edit.$anyDirty&&!e.$v.edit.firstname.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.firstname.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Middlename"},model:{value:e.edit.middlename,callback:function(t){e.$set(e.edit,"middlename",t)},expression:"edit.middlename"}}),e.$v.edit.$anyDirty&&!e.$v.edit.middlename.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.middlename.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Lastname:")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Email Address:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Lastname"},model:{value:e.edit.lastname,callback:function(t){e.$set(e.edit,"lastname",t)},expression:"edit.lastname"}}),e.$v.edit.$anyDirty&&!e.$v.edit.lastname.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.lastname.alphaCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Email Address"},model:{value:e.edit.emailAddress,callback:function(t){e.$set(e.edit,"emailAddress",t)},expression:"edit.emailAddress"}}),e.$v.edit.$anyDirty&&!e.$v.edit.emailAddress.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.emailAddress.email?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Contact Number")]),a("b",{staticClass:"text-red"},[e._v("*")])]),a("label",{staticClass:"col-sm-6 col-form-label"},[a("b",[e._v("Department:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("base-input",{attrs:{type:"text",id:"inputStyle",placeholder:"Contact Number"},model:{value:e.edit.contactNumber,callback:function(t){e.$set(e.edit,"contactNumber",t)},expression:"edit.contactNumber"}}),e.$v.edit.$anyDirty&&!e.$v.edit.contactNumber.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e(),e.$v.edit.$anyDirty&&!e.$v.edit.contactNumber.numCustomValidator?a("i",{staticClass:"text-red"},[e._v("Invalid Characters")]):e._e()],1),a("div",{staticClass:"col-sm-6 pl-5 pr-5"},[a("v-select",{attrs:{id:"inputStyle",options:e.departments,reduce:function(e){return e.departmentUid},label:"departmentName"},model:{value:e.edit.department,callback:function(t){e.$set(e.edit,"department",t)},expression:"edit.department"}}),e.$v.edit.department.$anyDirty&&!e.$v.department.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])]),a("b-modal",{attrs:{size:"md",id:"change-password-modal",title:"Change Password",centered:"","hide-header-close":!0,"no-close-on-backdrop":!0,"no-close-on-esc":!0},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"},[a("div",{staticClass:"text-right"},[a("base-button",{attrs:{id:"darkBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.editPassword(t)}}},[e.requestProcessing?a("i",{staticClass:"fa fa-spinner fa-spin"}):e._e(),e._v(" Update ")]),a("base-button",{attrs:{id:"darkInlineBtn",disabled:e.requestProcessing},nativeOn:{click:function(t){return e.$bvModal.hide("change-password-modal")}}},[e._v("Close")])],1)])]},proxy:!0}])},[a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Old Password:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{type:"password",id:"inputStyle",placeholder:"Old Password"},model:{value:e.oldPassword,callback:function(t){e.oldPassword=t},expression:"oldPassword"}}),e.$v.oldPassword.$anyDirty&&!e.$v.oldPassword.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("New Password:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{type:"password",id:"inputStyle",placeholder:"New Password"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),e.$v.newPassword.$anyDirty&&!e.$v.newPassword.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)]),a("div",{staticClass:"form-group row mb-0"},[a("label",{staticClass:"col-sm-12 col-form-label"},[a("b",[e._v("Repeat New Password:")]),a("b",{staticClass:"text-red"},[e._v("*")])])]),a("div",{staticClass:"form-group row mb-0"},[a("div",{staticClass:"col-sm-12 pl-5 pr-5"},[a("base-input",{attrs:{type:"password",id:"inputStyle",placeholder:"Repeat New Password"},model:{value:e.repeatPassword,callback:function(t){e.repeatPassword=t},expression:"repeatPassword"}}),e.$v.repeatPassword.$anyDirty&&!e.$v.repeatPassword.required?a("i",{staticClass:"text-red"},[e._v("Field Required")]):e._e()],1)])])],1)],1)},r=[],n=(a("4160"),a("fb6a"),a("159b"),a("96cf"),a("1da1")),i=a("56d7"),o=a("b5ae"),l=o["helpers"].regex("alphaNumAndDot",/^[ A-Za-z. ]*$/),c=o["helpers"].regex("alphaNumAndDot",/^[ 0-9 ]*$/),d=a("c1df"),u=new Date,m=a("323d"),p={name:"user-profile",data:function(){return{user:[],departments:[],userRole:"",avatarLetter:"",edit:{id:"",userId:"",firstname:"",middlename:"",lastname:"",emailAddress:"",contactNumber:"",department:""},oldPassword:"",newPassword:"",repeatPassword:"",requestProcessing:!1}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUser(localStorage.getItem("aisname")),e.getDepartments();case 2:case"end":return t.stop()}}),t)})))()},validations:{edit:{firstname:{required:o["required"],alphaCustomValidator:l},middlename:{required:o["required"],alphaCustomValidator:l},lastname:{required:o["required"],alphaCustomValidator:l},emailAddress:{required:o["required"],email:o["email"]},contactNumber:{required:o["required"],numCustomValidator:c},department:{required:o["required"]}},oldPassword:{required:o["required"]},newPassword:{required:o["required"]},repeatPassword:{required:o["required"]}},methods:{getUserRole:function(e){var t=this,a=i["dbUsers"].collection("userRoles").where("userRoleId","==",e),s=[];a.get().then((function(e){e.forEach((function(e){s.push(e.data())})),t.userRole=s[0].userRole}))},getUser:function(e){if(""==e)self.$swal({title:"Warning",text:"The user ID is missing.",icon:"warning",confirmButtonColor:"#ef8157",confirmButtonText:"OK"});else if(""!=e){var t=this,a=i["dbUsers"].collection("users").where("username","==",e),s="";t.user=[],a.get().then((function(e){e.forEach((function(e){t.user.push(e.data()),s=e.id}));for(var a=0;a<t.user.length;a++)t.user[a].dateCreated=d.unix(t.user[a].dateCreated.seconds),t.user[a]["id"]=s;t.user=t.user[0],t.getUserRole(t.user.userRoleReference),t.avatarLetter=t.user.firstname.slice(0,1)+""+t.user.lastname.slice(0,1)}))}},getDepartments:function(){var e=this,t=i["dbUsers"].collection("departments").orderBy("departmentName","asc");e.departments=[],t.get().then((function(t){t.forEach((function(t){e.departments.push(t.data())}))}))},openEditProfileModal:function(e){this.edit={id:e.id,userId:e.userId,firstname:e.firstname,middlename:e.middlename,lastname:e.lastname,emailAddress:e.emailAddress,contactNumber:e.contactNumber,department:e.departmentReference},this.$bvModal.show("edit-profile-modal")},updateProfile:function(){var e=this;e.requestProcessing=!1,e.$v.edit.$touch(),e.$v.edit.$error||(e.requestProcessing=!0,i["dbUsers"].collection("users").doc(e.edit.id).update({firstname:e.edit.firstname,middlename:e.edit.middlename,lastname:e.edit.lastname,emailAddress:e.edit.emailAddress,contactNumber:e.edit.contactNumber,departmentReference:e.edit.department,dateModified:u}).then((function(){e.$v.edit.$reset(),e.$bvModal.hide("edit-profile-modal"),e.getUser(localStorage.getItem("aisname")),e.getDepartments(),e.requestProcessing=!1,e.$swal({title:"Success",text:"Profile updated successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){e.requestProcessing=!1,console.log(t),e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})))},editPassword:function(){var e=this;if(e.requestProcessing=!1,e.$v.oldPassword.$touch(),e.$v.newPassword.$touch(),e.$v.repeatPassword.$touch(),!e.$v.oldPassword.$error&&!e.$v.newPassword.$error&&!e.$v.repeatPassword.$error)if(e.newPassword!=e.repeatPassword)e.$swal({title:"Error",text:"Incorrect repeat password",icon:"error",confirmButtonColor:"#ef8157",confirmButtonText:"OK"});else{var t=i["dbUsers"].collection("users").where("username","==",localStorage.getItem("aisname")),a=[],s="";e.requestProcessing=!0,t.get().then((function(t){t.forEach((function(e){a.push(e.data()),s=e.id})),m.verify(e.oldPassword,a[0].password)?m.verify(e.oldPassword,a[0].password)&&i["dbUsers"].collection("users").doc(s).update({password:m.generate(e.newPassword),dateModified:u}).then((function(){e.oldPassword="",e.newPassword="",e.repeatPassword="",e.$v.oldPassword.$reset(),e.$v.newPassword.$reset(),e.$v.repeatPassword.$reset(),e.$bvModal.hide("change-password-modal"),e.requestProcessing=!1,e.$swal({title:"Success",text:"Password change successfully!",icon:"success",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})).catch((function(t){e.requestProcessing=!1,console.log(t),e.$swal({title:"Error",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#b80000",confirmButtonText:"OK"})})):(e.requestProcessing=!1,e.$swal({title:"Error",text:"Incorrect old password",icon:"error",confirmButtonColor:"#ef8157",confirmButtonText:"OK"}))}))}}}},b=p,f=a("2877"),v=Object(f["a"])(b,s,r,!1,null,null,null);t["default"]=v.exports},f8ae:function(e,t,a){},fa44:function(e,t,a){},fbf2:function(e,t,a){"use strict";a("d39d")}}]);
//# sourceMappingURL=chunk-49c0afb5.d0c6f43f.js.map